import{t as Or,e as mr}from"./tslib.c859f5fc.js";import{c as oa,g as Bb,r as kb,n as Hb}from"./index.f4ca4317.js";import{b as ka,s as Kb,a as Vb,d as Wb,i as $h,c as Gb,e as Yb,g as df,f as Ha,h as Jb,J as si,j as Ka,k as Va,l as Wa,m as ri,n as Kr,o as Rs,q as Qb,p as Xb,H as Si}from"./index.136cb250.js";var js={},Nn={};Object.defineProperty(Nn,"__esModule",{value:!0});function Zb(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}Nn.safeJsonParse=Zb;function e_(n){return typeof n=="string"?n:JSON.stringify(n,(t,r)=>typeof r>"u"?null:r)}Nn.safeJsonStringify=e_;var vn={exports:{}},Mh;function t_(){return Mh||(Mh=1,function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof oa<"u"&&oa.localStorage?vn.exports=oa.localStorage:typeof window<"u"&&window.localStorage?vn.exports=window.localStorage:vn.exports=new t}()),vn.exports}var aa={},yn={},jh;function r_(){if(jh)return yn;jh=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.IKeyValueStorage=void 0;class n{}return yn.IKeyValueStorage=n,yn}var bn={},qh;function i_(){if(qh)return bn;qh=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.parseEntry=void 0;const n=Nn;function t(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return bn.parseEntry=t,bn}var zh;function n_(){return zh||(zh=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Or.exports;t.__exportStar(r_(),n),t.__exportStar(i_(),n)}(aa)),aa}Object.defineProperty(js,"__esModule",{value:!0});js.KeyValueStorage=void 0;const Ki=Or.exports,Bh=Nn,s_=Ki.__importDefault(t_()),o_=n_();class pf{constructor(){this.localStorage=s_.default}getKeys(){return Ki.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Ki.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(o_.parseEntry)})}getItem(t){return Ki.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return Bh.safeJsonParse(r)})}setItem(t,r){return Ki.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,Bh.safeJsonStringify(r))})}removeItem(t){return Ki.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}js.KeyValueStorage=pf;var a_=js.default=pf,Yi={},_n={},fe={},ca={},mn={},kh;function c_(){if(kh)return mn;kh=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.delay=void 0;function n(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return mn.delay=n,mn}var bi={},ua={},_i={},Hh;function u_(){return Hh||(Hh=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.ONE_THOUSAND=_i.ONE_HUNDRED=void 0,_i.ONE_HUNDRED=100,_i.ONE_THOUSAND=1e3),_i}var ha={},Kh;function h_(){return Kh||(Kh=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(ha)),ha}var Vh;function gf(){return Vh||(Vh=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Or.exports;t.__exportStar(u_(),n),t.__exportStar(h_(),n)}(ua)),ua}var Wh;function l_(){if(Wh)return bi;Wh=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.fromMiliseconds=bi.toMiliseconds=void 0;const n=gf();function t(s){return s*n.ONE_THOUSAND}bi.toMiliseconds=t;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return bi.fromMiliseconds=r,bi}var Gh;function f_(){return Gh||(Gh=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Or.exports;t.__exportStar(c_(),n),t.__exportStar(l_(),n)}(ca)),ca}var Hi={},Yh;function d_(){if(Yh)return Hi;Yh=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const a=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:a})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return Hi.Watch=n,Hi.default=n,Hi}var la={},wn={},Jh;function p_(){if(Jh)return wn;Jh=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.IWatch=void 0;class n{}return wn.IWatch=n,wn}var Qh;function g_(){return Qh||(Qh=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Or.exports.__exportStar(p_(),n)}(la)),la}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Or.exports;t.__exportStar(f_(),n),t.__exportStar(d_(),n),t.__exportStar(g_(),n),t.__exportStar(gf(),n)})(fe);var fa={},En={};class xi{}const v_=Object.freeze(Object.defineProperty({__proto__:null,IEvents:xi},Symbol.toStringTag,{value:"Module"})),y_=Bb(v_);var Xh;function b_(){if(Xh)return En;Xh=1,Object.defineProperty(En,"__esModule",{value:!0}),En.IHeartBeat=void 0;const n=y_;class t extends n.IEvents{constructor(s){super()}}return En.IHeartBeat=t,En}var Zh;function vf(){return Zh||(Zh=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Or.exports.__exportStar(b_(),n)}(fa)),fa}var da={},mi={},el;function __(){if(el)return mi;el=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.HEARTBEAT_EVENTS=mi.HEARTBEAT_INTERVAL=void 0;const n=fe;return mi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,mi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},mi}var tl;function yf(){return tl||(tl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Or.exports.__exportStar(__(),n)}(da)),da}var rl;function m_(){if(rl)return _n;rl=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.HeartBeat=void 0;const n=Or.exports,t=mr.exports,r=fe,s=vf(),a=yf();class l extends s.IHeartBeat{constructor(f){super(f),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||a.HEARTBEAT_INTERVAL}static init(f){return n.__awaiter(this,void 0,void 0,function*(){const v=new l(f);return yield v.init(),v})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,v){this.events.on(f,v)}once(f,v){this.events.once(f,v)}off(f,v){this.events.off(f,v)}removeListener(f,v){this.events.removeListener(f,v)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return _n.HeartBeat=l,_n}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Or.exports;t.__exportStar(m_(),n),t.__exportStar(vf(),n),t.__exportStar(yf(),n)})(Yi);var He={},pa,il;function w_(){if(il)return pa;il=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}pa=t;function t(r,s,a){var l=a&&a.stringify||n,p=1;if(typeof r=="object"&&r!==null){var f=s.length+p;if(f===1)return r;var v=new Array(f);v[0]=l(r);for(var w=1;w<f;w++)v[w]=l(s[w]);return v.join(" ")}if(typeof r!="string")return r;var D=s.length;if(D===0)return r;for(var O="",L=1-p,F=-1,U=r&&r.length||0,z=0;z<U;){if(r.charCodeAt(z)===37&&z+1<U){switch(F=F>-1?F:0,r.charCodeAt(z+1)){case 100:case 102:if(L>=D||s[L]==null)break;F<z&&(O+=r.slice(F,z)),O+=Number(s[L]),F=z+2,z++;break;case 105:if(L>=D||s[L]==null)break;F<z&&(O+=r.slice(F,z)),O+=Math.floor(Number(s[L])),F=z+2,z++;break;case 79:case 111:case 106:if(L>=D||s[L]===void 0)break;F<z&&(O+=r.slice(F,z));var B=typeof s[L];if(B==="string"){O+="'"+s[L]+"'",F=z+2,z++;break}if(B==="function"){O+=s[L].name||"<anonymous>",F=z+2,z++;break}O+=l(s[L]),F=z+2,z++;break;case 115:if(L>=D)break;F<z&&(O+=r.slice(F,z)),O+=String(s[L]),F=z+2,z++;break;case 37:F<z&&(O+=r.slice(F,z)),O+="%",F=z+2,z++,L--;break}++L}++z}return F===-1?r:(F<U&&(O+=r.slice(F)),O)}return pa}var ga,nl;function E_(){if(nl)return ga;nl=1;const n=w_();ga=a;const t=x().console||{},r={mapHttpRequest:U,mapHttpResponse:U,wrapRequestSerializer:z,wrapResponseSerializer:z,wrapErrorSerializer:z,req:U,res:U,err:L};function s(_,c){return Array.isArray(_)?_.filter(function(H){return H!=="!stdSerializers.err"}):_===!0?Object.keys(c):!1}function a(_){_=_||{},_.browser=_.browser||{};const c=_.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const b=_.browser.write||t;_.browser.write&&(_.browser.asObject=!0);const H=_.serializers||{},K=s(_.browser.serialize,H);let ie=_.browser.serialize;Array.isArray(_.browser.serialize)&&_.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ie=!1);const oe=["error","fatal","warn","info","debug","trace"];typeof b=="function"&&(b.error=b.fatal=b.warn=b.info=b.debug=b.trace=b),_.enabled===!1&&(_.level="silent");const he=_.level||"info",N=Object.create(b);N.log||(N.log=B),Object.defineProperty(N,"levelVal",{get:ae}),Object.defineProperty(N,"level",{get:X,set:W});const j={transmit:c,serialize:K,asObject:_.browser.asObject,levels:oe,timestamp:F(_)};N.levels=a.levels,N.level=he,N.setMaxListeners=N.getMaxListeners=N.emit=N.addListener=N.on=N.prependListener=N.once=N.prependOnceListener=N.removeListener=N.removeAllListeners=N.listeners=N.listenerCount=N.eventNames=N.write=N.flush=B,N.serializers=H,N._serialize=K,N._stdErrSerialize=ie,N.child=Q,c&&(N._logEvent=O());function ae(){return this.level==="silent"?1/0:this.levels.values[this.level]}function X(){return this._level}function W(G){if(G!=="silent"&&!this.levels.values[G])throw Error("unknown level "+G);this._level=G,l(j,N,"error","log"),l(j,N,"fatal","error"),l(j,N,"warn","error"),l(j,N,"info","log"),l(j,N,"debug","log"),l(j,N,"trace","log")}function Q(G,Z){if(!G)throw new Error("missing bindings for child Pino");Z=Z||{},K&&G.serializers&&(Z.serializers=G.serializers);const we=Z.serializers;if(K&&we){var te=Object.assign({},H,we),ye=_.browser.serialize===!0?Object.keys(te):K;delete G.serializers,v([G],ye,te,this._stdErrSerialize)}function be(ve){this._childLevel=(ve._childLevel|0)+1,this.error=w(ve,G,"error"),this.fatal=w(ve,G,"fatal"),this.warn=w(ve,G,"warn"),this.info=w(ve,G,"info"),this.debug=w(ve,G,"debug"),this.trace=w(ve,G,"trace"),te&&(this.serializers=te,this._serialize=ye),c&&(this._logEvent=O([].concat(ve._logEvent.bindings,G)))}return be.prototype=this,new be(this)}return N}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:ee,epochTime:P,unixTime:T,isoTime:E});function l(_,c,b,H){const K=Object.getPrototypeOf(c);c[b]=c.levelVal>c.levels.values[b]?B:K[b]?K[b]:t[b]||t[H]||B,p(_,c,b)}function p(_,c,b){!_.transmit&&c[b]===B||(c[b]=function(H){return function(){const ie=_.timestamp(),oe=new Array(arguments.length),he=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var N=0;N<oe.length;N++)oe[N]=arguments[N];if(_.serialize&&!_.asObject&&v(oe,this._serialize,this.serializers,this._stdErrSerialize),_.asObject?H.call(he,f(this,b,oe,ie)):H.apply(he,oe),_.transmit){const j=_.transmit.level||c.level,ae=a.levels.values[j],X=a.levels.values[b];if(X<ae)return;D(this,{ts:ie,methodLevel:b,methodValue:X,transmitLevel:j,transmitValue:a.levels.values[_.transmit.level||c.level],send:_.transmit.send,val:c.levelVal},oe)}}}(c[b]))}function f(_,c,b,H){_._serialize&&v(b,_._serialize,_.serializers,_._stdErrSerialize);const K=b.slice();let ie=K[0];const oe={};H&&(oe.time=H),oe.level=a.levels.values[c];let he=(_._childLevel|0)+1;if(he<1&&(he=1),ie!==null&&typeof ie=="object"){for(;he--&&typeof K[0]=="object";)Object.assign(oe,K.shift());ie=K.length?n(K.shift(),K):void 0}else typeof ie=="string"&&(ie=n(K.shift(),K));return ie!==void 0&&(oe.msg=ie),oe}function v(_,c,b,H){for(const K in _)if(H&&_[K]instanceof Error)_[K]=a.stdSerializers.err(_[K]);else if(typeof _[K]=="object"&&!Array.isArray(_[K]))for(const ie in _[K])c&&c.indexOf(ie)>-1&&ie in b&&(_[K][ie]=b[ie](_[K][ie]))}function w(_,c,b){return function(){const H=new Array(1+arguments.length);H[0]=c;for(var K=1;K<H.length;K++)H[K]=arguments[K-1];return _[b].apply(this,H)}}function D(_,c,b){const H=c.send,K=c.ts,ie=c.methodLevel,oe=c.methodValue,he=c.val,N=_._logEvent.bindings;v(b,_._serialize||Object.keys(_.serializers),_.serializers,_._stdErrSerialize===void 0?!0:_._stdErrSerialize),_._logEvent.ts=K,_._logEvent.messages=b.filter(function(j){return N.indexOf(j)===-1}),_._logEvent.level.label=ie,_._logEvent.level.value=oe,H(ie,_._logEvent,he),_._logEvent=O(N)}function O(_){return{ts:0,messages:[],bindings:_||[],level:{label:"",value:0}}}function L(_){const c={type:_.constructor.name,msg:_.message,stack:_.stack};for(const b in _)c[b]===void 0&&(c[b]=_[b]);return c}function F(_){return typeof _.timestamp=="function"?_.timestamp:_.timestamp===!1?ee:P}function U(){return{}}function z(_){return _}function B(){}function ee(){return!1}function P(){return Date.now()}function T(){return Math.round(Date.now()/1e3)}function E(){return new Date(Date.now()).toISOString()}function x(){function _(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return _(self)||_(window)||_(this)||{}}}return ga}var wi={},sl;function bf(){return sl||(sl=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.PINO_CUSTOM_CONTEXT_KEY=wi.PINO_LOGGER_DEFAULTS=void 0,wi.PINO_LOGGER_DEFAULTS={level:"info"},wi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),wi}var Ht={},ol;function D_(){if(ol)return Ht;ol=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.generateChildLogger=Ht.formatChildLoggerContext=Ht.getLoggerContext=Ht.setBrowserLoggerContext=Ht.getBrowserLoggerContext=Ht.getDefaultLoggerOptions=void 0;const n=bf();function t(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||n.PINO_LOGGER_DEFAULTS.level})}Ht.getDefaultLoggerOptions=t;function r(f,v=n.PINO_CUSTOM_CONTEXT_KEY){return f[v]||""}Ht.getBrowserLoggerContext=r;function s(f,v,w=n.PINO_CUSTOM_CONTEXT_KEY){return f[w]=v,f}Ht.setBrowserLoggerContext=s;function a(f,v=n.PINO_CUSTOM_CONTEXT_KEY){let w="";return typeof f.bindings>"u"?w=r(f,v):w=f.bindings().context||"",w}Ht.getLoggerContext=a;function l(f,v,w=n.PINO_CUSTOM_CONTEXT_KEY){const D=a(f,w);return D.trim()?`${D}/${v}`:v}Ht.formatChildLoggerContext=l;function p(f,v,w=n.PINO_CUSTOM_CONTEXT_KEY){const D=l(f,v,w),O=f.child({context:D});return s(O,D,w)}return Ht.generateChildLogger=p,Ht}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=Or.exports,r=t.__importDefault(E_());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(bf(),n),t.__exportStar(D_(),n)})(He);class S_ extends xi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class x_ extends xi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class I_{constructor(t,r){this.logger=t,this.core=r}}class O_ extends xi{constructor(t,r){super(),this.relayer=t,this.logger=r}}class P_ extends xi{constructor(t){super()}}class C_{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}}class A_ extends xi{constructor(t,r){super(),this.relayer=t,this.logger=r}}class N_ extends xi{constructor(t,r){super(),this.core=t,this.logger=r}}class T_{constructor(t,r){this.projectId=t,this.logger=r}}class R_{constructor(t){this.opts=t,this.protocol="wc",this.version=2}}class F_{constructor(t){this.client=t}}var Ga={},Ji={},qs={},zs={};Object.defineProperty(zs,"__esModule",{value:!0});zs.BrowserRandomSource=void 0;const al=65536;class U_{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let s=0;s<r.length;s+=al)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,al)));return r}}zs.BrowserRandomSource=U_;function L_(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Bs={},cr={};Object.defineProperty(cr,"__esModule",{value:!0});function $_(n){for(var t=0;t<n.length;t++)n[t]=0;return n}cr.wipe=$_;Object.defineProperty(Bs,"__esModule",{value:!0});Bs.NodeRandomSource=void 0;const M_=cr;class j_{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof L_<"u"){const t=kb;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(t);for(let a=0;a<s.length;a++)s[a]=r[a];return(0,M_.wipe)(r),s}}Bs.NodeRandomSource=j_;Object.defineProperty(qs,"__esModule",{value:!0});qs.SystemRandomSource=void 0;const q_=zs,z_=Bs;class B_{constructor(){if(this.isAvailable=!1,this.name="",this._source=new q_.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new z_.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}qs.SystemRandomSource=B_;var Ie={},_f={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function t(f,v){var w=f>>>16&65535,D=f&65535,O=v>>>16&65535,L=v&65535;return D*L+(w*L+D*O<<16>>>0)|0}n.mul=Math.imul||t;function r(f,v){return f+v|0}n.add=r;function s(f,v){return f-v|0}n.sub=s;function a(f,v){return f<<v|f>>>32-v}n.rotl=a;function l(f,v){return f<<32-v|f>>>v}n.rotr=l;function p(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}n.isInteger=Number.isInteger||p,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(f){return n.isInteger(f)&&f>=-n.MAX_SAFE_INTEGER&&f<=n.MAX_SAFE_INTEGER}})(_f);Object.defineProperty(Ie,"__esModule",{value:!0});var mf=_f;function k_(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])<<16>>16}Ie.readInt16BE=k_;function H_(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])>>>0}Ie.readUint16BE=H_;function K_(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])<<16>>16}Ie.readInt16LE=K_;function V_(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])>>>0}Ie.readUint16LE=V_;function wf(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>8,t[r+1]=n>>>0,t}Ie.writeUint16BE=wf;Ie.writeInt16BE=wf;function Ef(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t}Ie.writeUint16LE=Ef;Ie.writeInt16LE=Ef;function Oa(n,t){return t===void 0&&(t=0),n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]}Ie.readInt32BE=Oa;function Pa(n,t){return t===void 0&&(t=0),(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}Ie.readUint32BE=Pa;function Ca(n,t){return t===void 0&&(t=0),n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]}Ie.readInt32LE=Ca;function Aa(n,t){return t===void 0&&(t=0),(n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t])>>>0}Ie.readUint32LE=Aa;function Fs(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>24,t[r+1]=n>>>16,t[r+2]=n>>>8,t[r+3]=n>>>0,t}Ie.writeUint32BE=Fs;Ie.writeInt32BE=Fs;function Us(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t[r+2]=n>>>16,t[r+3]=n>>>24,t}Ie.writeUint32LE=Us;Ie.writeInt32LE=Us;function W_(n,t){t===void 0&&(t=0);var r=Oa(n,t),s=Oa(n,t+4);return r*4294967296+s-(s>>31)*4294967296}Ie.readInt64BE=W_;function G_(n,t){t===void 0&&(t=0);var r=Pa(n,t),s=Pa(n,t+4);return r*4294967296+s}Ie.readUint64BE=G_;function Y_(n,t){t===void 0&&(t=0);var r=Ca(n,t),s=Ca(n,t+4);return s*4294967296+r-(r>>31)*4294967296}Ie.readInt64LE=Y_;function J_(n,t){t===void 0&&(t=0);var r=Aa(n,t),s=Aa(n,t+4);return s*4294967296+r}Ie.readUint64LE=J_;function Df(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Fs(n/4294967296>>>0,t,r),Fs(n>>>0,t,r+4),t}Ie.writeUint64BE=Df;Ie.writeInt64BE=Df;function Sf(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Us(n>>>0,t,r),Us(n/4294967296>>>0,t,r+4),t}Ie.writeUint64LE=Sf;Ie.writeInt64LE=Sf;function Q_(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,a=1,l=n/8+r-1;l>=r;l--)s+=t[l]*a,a*=256;return s}Ie.readUintBE=Q_;function X_(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,a=1,l=r;l<r+n/8;l++)s+=t[l]*a,a*=256;return s}Ie.readUintLE=X_;function Z_(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!mf.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var a=1,l=n/8+s-1;l>=s;l--)r[l]=t/a&255,a*=256;return r}Ie.writeUintBE=Z_;function em(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!mf.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var a=1,l=s;l<s+n/8;l++)r[l]=t/a&255,a*=256;return r}Ie.writeUintLE=em;function tm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t)}Ie.readFloat32BE=tm;function rm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t,!0)}Ie.readFloat32LE=rm;function im(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t)}Ie.readFloat64BE=im;function nm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t,!0)}Ie.readFloat64LE=nm;function sm(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n),t}Ie.writeFloat32BE=sm;function om(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n,!0),t}Ie.writeFloat32LE=om;function am(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n),t}Ie.writeFloat64BE=am;function cm(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n,!0),t}Ie.writeFloat64LE=cm;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const t=qs,r=Ie,s=cr;n.defaultRandomSource=new t.SystemRandomSource;function a(w,D=n.defaultRandomSource){return D.randomBytes(w)}n.randomBytes=a;function l(w=n.defaultRandomSource){const D=a(4,w),O=(0,r.readUint32LE)(D);return(0,s.wipe)(D),O}n.randomUint32=l;const p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(w,D=p,O=n.defaultRandomSource){if(D.length<2)throw new Error("randomString charset is too short");if(D.length>256)throw new Error("randomString charset is too long");let L="";const F=D.length,U=256-256%F;for(;w>0;){const z=a(Math.ceil(w*256/U),O);for(let B=0;B<z.length&&w>0;B++){const ee=z[B];ee<U&&(L+=D.charAt(ee%F),w--)}(0,s.wipe)(z)}return L}n.randomString=f;function v(w,D=p,O=n.defaultRandomSource){const L=Math.ceil(w/(Math.log(D.length)/Math.LN2));return f(L,D,O)}n.randomStringForEntropy=v})(Ji);var xf={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ie,r=cr;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},f.prototype.update=function(v,w){if(w===void 0&&(w=v.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var D=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&w>0;)this._buffer[this._bufferLength++]=v[D++],w--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(D=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,v,D,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=v[D++],w--;return this},f.prototype.finish=function(v){if(!this._finished){var w=this._bytesHashed,D=this._bufferLength,O=w/536870912|0,L=w<<3,F=w%128<112?128:256;this._buffer[D]=128;for(var U=D+1;U<F-8;U++)this._buffer[U]=0;t.writeUint32BE(O,this._buffer,F-8),t.writeUint32BE(L,this._buffer,F-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,F),this._finished=!0}for(var U=0;U<this.digestLength/8;U++)t.writeUint32BE(this._stateHi[U],v,U*8),t.writeUint32BE(this._stateLo[U],v,U*8+4);return this},f.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(v){return this._stateHi.set(v.stateHi),this._stateLo.set(v.stateLo),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(v){r.wipe(v.stateHi),r.wipe(v.stateLo),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},f}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(f,v,w,D,O,L,F){for(var U=w[0],z=w[1],B=w[2],ee=w[3],P=w[4],T=w[5],E=w[6],x=w[7],_=D[0],c=D[1],b=D[2],H=D[3],K=D[4],ie=D[5],oe=D[6],he=D[7],N,j,ae,X,W,Q,G,Z;F>=128;){for(var we=0;we<16;we++){var te=8*we+L;f[we]=t.readUint32BE(O,te),v[we]=t.readUint32BE(O,te+4)}for(var we=0;we<80;we++){var ye=U,be=z,ve=B,$=ee,M=P,C=T,h=E,S=x,re=_,ce=c,_e=b,$e=H,ze=K,Re=ie,st=oe,ot=he;if(N=x,j=he,W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=(P>>>14|K<<32-14)^(P>>>18|K<<32-18)^(K>>>41-32|P<<32-(41-32)),j=(K>>>14|P<<32-14)^(K>>>18|P<<32-18)^(P>>>41-32|K<<32-(41-32)),W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,N=P&T^~P&E,j=K&ie^~K&oe,W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,N=a[we*2],j=a[we*2+1],W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,N=f[we%16],j=v[we%16],W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,ae=G&65535|Z<<16,X=W&65535|Q<<16,N=ae,j=X,W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=(U>>>28|_<<32-28)^(_>>>34-32|U<<32-(34-32))^(_>>>39-32|U<<32-(39-32)),j=(_>>>28|U<<32-28)^(U>>>34-32|_<<32-(34-32))^(U>>>39-32|_<<32-(39-32)),W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,N=U&z^U&B^z&B,j=_&c^_&b^c&b,W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,S=G&65535|Z<<16,ot=W&65535|Q<<16,N=$,j=$e,W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=ae,j=X,W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,$=G&65535|Z<<16,$e=W&65535|Q<<16,z=ye,B=be,ee=ve,P=$,T=M,E=C,x=h,U=S,c=re,b=ce,H=_e,K=$e,ie=ze,oe=Re,he=st,_=ot,we%16===15)for(var te=0;te<16;te++)N=f[te],j=v[te],W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=f[(te+9)%16],j=v[(te+9)%16],W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,ae=f[(te+1)%16],X=v[(te+1)%16],N=(ae>>>1|X<<32-1)^(ae>>>8|X<<32-8)^ae>>>7,j=(X>>>1|ae<<32-1)^(X>>>8|ae<<32-8)^(X>>>7|ae<<32-7),W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,ae=f[(te+14)%16],X=v[(te+14)%16],N=(ae>>>19|X<<32-19)^(X>>>61-32|ae<<32-(61-32))^ae>>>6,j=(X>>>19|ae<<32-19)^(ae>>>61-32|X<<32-(61-32))^(X>>>6|ae<<32-6),W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,f[te]=G&65535|Z<<16,v[te]=W&65535|Q<<16}N=U,j=_,W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=w[0],j=D[0],W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,w[0]=U=G&65535|Z<<16,D[0]=_=W&65535|Q<<16,N=z,j=c,W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=w[1],j=D[1],W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,w[1]=z=G&65535|Z<<16,D[1]=c=W&65535|Q<<16,N=B,j=b,W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=w[2],j=D[2],W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,w[2]=B=G&65535|Z<<16,D[2]=b=W&65535|Q<<16,N=ee,j=H,W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=w[3],j=D[3],W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,w[3]=ee=G&65535|Z<<16,D[3]=H=W&65535|Q<<16,N=P,j=K,W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=w[4],j=D[4],W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,w[4]=P=G&65535|Z<<16,D[4]=K=W&65535|Q<<16,N=T,j=ie,W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=w[5],j=D[5],W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,w[5]=T=G&65535|Z<<16,D[5]=ie=W&65535|Q<<16,N=E,j=oe,W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=w[6],j=D[6],W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,w[6]=E=G&65535|Z<<16,D[6]=oe=W&65535|Q<<16,N=x,j=he,W=j&65535,Q=j>>>16,G=N&65535,Z=N>>>16,N=w[7],j=D[7],W+=j&65535,Q+=j>>>16,G+=N&65535,Z+=N>>>16,Q+=W>>>16,G+=Q>>>16,Z+=G>>>16,w[7]=x=G&65535|Z<<16,D[7]=he=W&65535|Q<<16,L+=128,F-=128}return L}function p(f){var v=new s;v.update(f);var w=v.digest();return v.clean(),w}n.hash=p})(xf);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=Ji,r=xf,s=cr;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a($){const M=new Float64Array(16);if($)for(let C=0;C<$.length;C++)M[C]=$[C];return M}const l=new Uint8Array(32);l[0]=9;const p=a(),f=a([1]),v=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),w=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),D=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),O=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),L=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function F($,M){for(let C=0;C<16;C++)$[C]=M[C]|0}function U($){let M=1;for(let C=0;C<16;C++){let h=$[C]+M+65535;M=Math.floor(h/65536),$[C]=h-M*65536}$[0]+=M-1+37*(M-1)}function z($,M,C){const h=~(C-1);for(let S=0;S<16;S++){const re=h&($[S]^M[S]);$[S]^=re,M[S]^=re}}function B($,M){const C=a(),h=a();for(let S=0;S<16;S++)h[S]=M[S];U(h),U(h),U(h);for(let S=0;S<2;S++){C[0]=h[0]-65517;for(let ce=1;ce<15;ce++)C[ce]=h[ce]-65535-(C[ce-1]>>16&1),C[ce-1]&=65535;C[15]=h[15]-32767-(C[14]>>16&1);const re=C[15]>>16&1;C[14]&=65535,z(h,C,1-re)}for(let S=0;S<16;S++)$[2*S]=h[S]&255,$[2*S+1]=h[S]>>8}function ee($,M){let C=0;for(let h=0;h<32;h++)C|=$[h]^M[h];return(1&C-1>>>8)-1}function P($,M){const C=new Uint8Array(32),h=new Uint8Array(32);return B(C,$),B(h,M),ee(C,h)}function T($){const M=new Uint8Array(32);return B(M,$),M[0]&1}function E($,M){for(let C=0;C<16;C++)$[C]=M[2*C]+(M[2*C+1]<<8);$[15]&=32767}function x($,M,C){for(let h=0;h<16;h++)$[h]=M[h]+C[h]}function _($,M,C){for(let h=0;h<16;h++)$[h]=M[h]-C[h]}function c($,M,C){let h,S,re=0,ce=0,_e=0,$e=0,ze=0,Re=0,st=0,ot=0,Ue=0,me=0,Pe=0,Ce=0,Le=0,Se=0,Ae=0,Ee=0,Ne=0,je=0,Be=0,Ke=0,Ve=0,We=0,Ge=0,Je=0,ur=0,wr=0,Vr=0,ci=0,Pi=0,Ci=0,Zi=0,bt=C[0],_t=C[1],mt=C[2],wt=C[3],gt=C[4],Et=C[5],Dt=C[6],St=C[7],lt=C[8],xt=C[9],ft=C[10],It=C[11],Ot=C[12],Pt=C[13],Ct=C[14],At=C[15];h=M[0],re+=h*bt,ce+=h*_t,_e+=h*mt,$e+=h*wt,ze+=h*gt,Re+=h*Et,st+=h*Dt,ot+=h*St,Ue+=h*lt,me+=h*xt,Pe+=h*ft,Ce+=h*It,Le+=h*Ot,Se+=h*Pt,Ae+=h*Ct,Ee+=h*At,h=M[1],ce+=h*bt,_e+=h*_t,$e+=h*mt,ze+=h*wt,Re+=h*gt,st+=h*Et,ot+=h*Dt,Ue+=h*St,me+=h*lt,Pe+=h*xt,Ce+=h*ft,Le+=h*It,Se+=h*Ot,Ae+=h*Pt,Ee+=h*Ct,Ne+=h*At,h=M[2],_e+=h*bt,$e+=h*_t,ze+=h*mt,Re+=h*wt,st+=h*gt,ot+=h*Et,Ue+=h*Dt,me+=h*St,Pe+=h*lt,Ce+=h*xt,Le+=h*ft,Se+=h*It,Ae+=h*Ot,Ee+=h*Pt,Ne+=h*Ct,je+=h*At,h=M[3],$e+=h*bt,ze+=h*_t,Re+=h*mt,st+=h*wt,ot+=h*gt,Ue+=h*Et,me+=h*Dt,Pe+=h*St,Ce+=h*lt,Le+=h*xt,Se+=h*ft,Ae+=h*It,Ee+=h*Ot,Ne+=h*Pt,je+=h*Ct,Be+=h*At,h=M[4],ze+=h*bt,Re+=h*_t,st+=h*mt,ot+=h*wt,Ue+=h*gt,me+=h*Et,Pe+=h*Dt,Ce+=h*St,Le+=h*lt,Se+=h*xt,Ae+=h*ft,Ee+=h*It,Ne+=h*Ot,je+=h*Pt,Be+=h*Ct,Ke+=h*At,h=M[5],Re+=h*bt,st+=h*_t,ot+=h*mt,Ue+=h*wt,me+=h*gt,Pe+=h*Et,Ce+=h*Dt,Le+=h*St,Se+=h*lt,Ae+=h*xt,Ee+=h*ft,Ne+=h*It,je+=h*Ot,Be+=h*Pt,Ke+=h*Ct,Ve+=h*At,h=M[6],st+=h*bt,ot+=h*_t,Ue+=h*mt,me+=h*wt,Pe+=h*gt,Ce+=h*Et,Le+=h*Dt,Se+=h*St,Ae+=h*lt,Ee+=h*xt,Ne+=h*ft,je+=h*It,Be+=h*Ot,Ke+=h*Pt,Ve+=h*Ct,We+=h*At,h=M[7],ot+=h*bt,Ue+=h*_t,me+=h*mt,Pe+=h*wt,Ce+=h*gt,Le+=h*Et,Se+=h*Dt,Ae+=h*St,Ee+=h*lt,Ne+=h*xt,je+=h*ft,Be+=h*It,Ke+=h*Ot,Ve+=h*Pt,We+=h*Ct,Ge+=h*At,h=M[8],Ue+=h*bt,me+=h*_t,Pe+=h*mt,Ce+=h*wt,Le+=h*gt,Se+=h*Et,Ae+=h*Dt,Ee+=h*St,Ne+=h*lt,je+=h*xt,Be+=h*ft,Ke+=h*It,Ve+=h*Ot,We+=h*Pt,Ge+=h*Ct,Je+=h*At,h=M[9],me+=h*bt,Pe+=h*_t,Ce+=h*mt,Le+=h*wt,Se+=h*gt,Ae+=h*Et,Ee+=h*Dt,Ne+=h*St,je+=h*lt,Be+=h*xt,Ke+=h*ft,Ve+=h*It,We+=h*Ot,Ge+=h*Pt,Je+=h*Ct,ur+=h*At,h=M[10],Pe+=h*bt,Ce+=h*_t,Le+=h*mt,Se+=h*wt,Ae+=h*gt,Ee+=h*Et,Ne+=h*Dt,je+=h*St,Be+=h*lt,Ke+=h*xt,Ve+=h*ft,We+=h*It,Ge+=h*Ot,Je+=h*Pt,ur+=h*Ct,wr+=h*At,h=M[11],Ce+=h*bt,Le+=h*_t,Se+=h*mt,Ae+=h*wt,Ee+=h*gt,Ne+=h*Et,je+=h*Dt,Be+=h*St,Ke+=h*lt,Ve+=h*xt,We+=h*ft,Ge+=h*It,Je+=h*Ot,ur+=h*Pt,wr+=h*Ct,Vr+=h*At,h=M[12],Le+=h*bt,Se+=h*_t,Ae+=h*mt,Ee+=h*wt,Ne+=h*gt,je+=h*Et,Be+=h*Dt,Ke+=h*St,Ve+=h*lt,We+=h*xt,Ge+=h*ft,Je+=h*It,ur+=h*Ot,wr+=h*Pt,Vr+=h*Ct,ci+=h*At,h=M[13],Se+=h*bt,Ae+=h*_t,Ee+=h*mt,Ne+=h*wt,je+=h*gt,Be+=h*Et,Ke+=h*Dt,Ve+=h*St,We+=h*lt,Ge+=h*xt,Je+=h*ft,ur+=h*It,wr+=h*Ot,Vr+=h*Pt,ci+=h*Ct,Pi+=h*At,h=M[14],Ae+=h*bt,Ee+=h*_t,Ne+=h*mt,je+=h*wt,Be+=h*gt,Ke+=h*Et,Ve+=h*Dt,We+=h*St,Ge+=h*lt,Je+=h*xt,ur+=h*ft,wr+=h*It,Vr+=h*Ot,ci+=h*Pt,Pi+=h*Ct,Ci+=h*At,h=M[15],Ee+=h*bt,Ne+=h*_t,je+=h*mt,Be+=h*wt,Ke+=h*gt,Ve+=h*Et,We+=h*Dt,Ge+=h*St,Je+=h*lt,ur+=h*xt,wr+=h*ft,Vr+=h*It,ci+=h*Ot,Pi+=h*Pt,Ci+=h*Ct,Zi+=h*At,re+=38*Ne,ce+=38*je,_e+=38*Be,$e+=38*Ke,ze+=38*Ve,Re+=38*We,st+=38*Ge,ot+=38*Je,Ue+=38*ur,me+=38*wr,Pe+=38*Vr,Ce+=38*ci,Le+=38*Pi,Se+=38*Ci,Ae+=38*Zi,S=1,h=re+S+65535,S=Math.floor(h/65536),re=h-S*65536,h=ce+S+65535,S=Math.floor(h/65536),ce=h-S*65536,h=_e+S+65535,S=Math.floor(h/65536),_e=h-S*65536,h=$e+S+65535,S=Math.floor(h/65536),$e=h-S*65536,h=ze+S+65535,S=Math.floor(h/65536),ze=h-S*65536,h=Re+S+65535,S=Math.floor(h/65536),Re=h-S*65536,h=st+S+65535,S=Math.floor(h/65536),st=h-S*65536,h=ot+S+65535,S=Math.floor(h/65536),ot=h-S*65536,h=Ue+S+65535,S=Math.floor(h/65536),Ue=h-S*65536,h=me+S+65535,S=Math.floor(h/65536),me=h-S*65536,h=Pe+S+65535,S=Math.floor(h/65536),Pe=h-S*65536,h=Ce+S+65535,S=Math.floor(h/65536),Ce=h-S*65536,h=Le+S+65535,S=Math.floor(h/65536),Le=h-S*65536,h=Se+S+65535,S=Math.floor(h/65536),Se=h-S*65536,h=Ae+S+65535,S=Math.floor(h/65536),Ae=h-S*65536,h=Ee+S+65535,S=Math.floor(h/65536),Ee=h-S*65536,re+=S-1+37*(S-1),S=1,h=re+S+65535,S=Math.floor(h/65536),re=h-S*65536,h=ce+S+65535,S=Math.floor(h/65536),ce=h-S*65536,h=_e+S+65535,S=Math.floor(h/65536),_e=h-S*65536,h=$e+S+65535,S=Math.floor(h/65536),$e=h-S*65536,h=ze+S+65535,S=Math.floor(h/65536),ze=h-S*65536,h=Re+S+65535,S=Math.floor(h/65536),Re=h-S*65536,h=st+S+65535,S=Math.floor(h/65536),st=h-S*65536,h=ot+S+65535,S=Math.floor(h/65536),ot=h-S*65536,h=Ue+S+65535,S=Math.floor(h/65536),Ue=h-S*65536,h=me+S+65535,S=Math.floor(h/65536),me=h-S*65536,h=Pe+S+65535,S=Math.floor(h/65536),Pe=h-S*65536,h=Ce+S+65535,S=Math.floor(h/65536),Ce=h-S*65536,h=Le+S+65535,S=Math.floor(h/65536),Le=h-S*65536,h=Se+S+65535,S=Math.floor(h/65536),Se=h-S*65536,h=Ae+S+65535,S=Math.floor(h/65536),Ae=h-S*65536,h=Ee+S+65535,S=Math.floor(h/65536),Ee=h-S*65536,re+=S-1+37*(S-1),$[0]=re,$[1]=ce,$[2]=_e,$[3]=$e,$[4]=ze,$[5]=Re,$[6]=st,$[7]=ot,$[8]=Ue,$[9]=me,$[10]=Pe,$[11]=Ce,$[12]=Le,$[13]=Se,$[14]=Ae,$[15]=Ee}function b($,M){c($,M,M)}function H($,M){const C=a();let h;for(h=0;h<16;h++)C[h]=M[h];for(h=253;h>=0;h--)b(C,C),h!==2&&h!==4&&c(C,C,M);for(h=0;h<16;h++)$[h]=C[h]}function K($,M){const C=a();let h;for(h=0;h<16;h++)C[h]=M[h];for(h=250;h>=0;h--)b(C,C),h!==1&&c(C,C,M);for(h=0;h<16;h++)$[h]=C[h]}function ie($,M){const C=a(),h=a(),S=a(),re=a(),ce=a(),_e=a(),$e=a(),ze=a(),Re=a();_(C,$[1],$[0]),_(Re,M[1],M[0]),c(C,C,Re),x(h,$[0],$[1]),x(Re,M[0],M[1]),c(h,h,Re),c(S,$[3],M[3]),c(S,S,w),c(re,$[2],M[2]),x(re,re,re),_(ce,h,C),_(_e,re,S),x($e,re,S),x(ze,h,C),c($[0],ce,_e),c($[1],ze,$e),c($[2],$e,_e),c($[3],ce,ze)}function oe($,M,C){for(let h=0;h<4;h++)z($[h],M[h],C)}function he($,M){const C=a(),h=a(),S=a();H(S,M[2]),c(C,M[0],S),c(h,M[1],S),B($,h),$[31]^=T(C)<<7}function N($,M,C){F($[0],p),F($[1],f),F($[2],f),F($[3],p);for(let h=255;h>=0;--h){const S=C[h/8|0]>>(h&7)&1;oe($,M,S),ie(M,$),ie($,$),oe($,M,S)}}function j($,M){const C=[a(),a(),a(),a()];F(C[0],D),F(C[1],O),F(C[2],f),c(C[3],D,O),N($,C,M)}function ae($){if($.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const M=(0,r.hash)($);M[0]&=248,M[31]&=127,M[31]|=64;const C=new Uint8Array(32),h=[a(),a(),a(),a()];j(h,M),he(C,h);const S=new Uint8Array(64);return S.set($),S.set(C,32),{publicKey:C,secretKey:S}}n.generateKeyPairFromSeed=ae;function X($){const M=(0,t.randomBytes)(32,$),C=ae(M);return(0,s.wipe)(M),C}n.generateKeyPair=X;function W($){if($.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array($.subarray(32))}n.extractPublicKeyFromSecretKey=W;const Q=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function G($,M){let C,h,S,re;for(h=63;h>=32;--h){for(C=0,S=h-32,re=h-12;S<re;++S)M[S]+=C-16*M[h]*Q[S-(h-32)],C=Math.floor((M[S]+128)/256),M[S]-=C*256;M[S]+=C,M[h]=0}for(C=0,S=0;S<32;S++)M[S]+=C-(M[31]>>4)*Q[S],C=M[S]>>8,M[S]&=255;for(S=0;S<32;S++)M[S]-=C*Q[S];for(h=0;h<32;h++)M[h+1]+=M[h]>>8,$[h]=M[h]&255}function Z($){const M=new Float64Array(64);for(let C=0;C<64;C++)M[C]=$[C];for(let C=0;C<64;C++)$[C]=0;G($,M)}function we($,M){const C=new Float64Array(64),h=[a(),a(),a(),a()],S=(0,r.hash)($.subarray(0,32));S[0]&=248,S[31]&=127,S[31]|=64;const re=new Uint8Array(64);re.set(S.subarray(32),32);const ce=new r.SHA512;ce.update(re.subarray(32)),ce.update(M);const _e=ce.digest();ce.clean(),Z(_e),j(h,_e),he(re,h),ce.reset(),ce.update(re.subarray(0,32)),ce.update($.subarray(32)),ce.update(M);const $e=ce.digest();Z($e);for(let ze=0;ze<32;ze++)C[ze]=_e[ze];for(let ze=0;ze<32;ze++)for(let Re=0;Re<32;Re++)C[ze+Re]+=$e[ze]*S[Re];return G(re.subarray(32),C),re}n.sign=we;function te($,M){const C=a(),h=a(),S=a(),re=a(),ce=a(),_e=a(),$e=a();return F($[2],f),E($[1],M),b(S,$[1]),c(re,S,v),_(S,S,$[2]),x(re,$[2],re),b(ce,re),b(_e,ce),c($e,_e,ce),c(C,$e,S),c(C,C,re),K(C,C),c(C,C,S),c(C,C,re),c(C,C,re),c($[0],C,re),b(h,$[0]),c(h,h,re),P(h,S)&&c($[0],$[0],L),b(h,$[0]),c(h,h,re),P(h,S)?-1:(T($[0])===M[31]>>7&&_($[0],p,$[0]),c($[3],$[0],$[1]),0)}function ye($,M,C){const h=new Uint8Array(32),S=[a(),a(),a(),a()],re=[a(),a(),a(),a()];if(C.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(te(re,$))return!1;const ce=new r.SHA512;ce.update(C.subarray(0,32)),ce.update($),ce.update(M);const _e=ce.digest();return Z(_e),N(S,re,_e),j(re,C.subarray(32)),ie(S,re),he(h,S),!ee(C,h)}n.verify=ye;function be($){let M=[a(),a(),a(),a()];if(te(M,$))throw new Error("Ed25519: invalid public key");let C=a(),h=a(),S=M[1];x(C,f,S),_(h,f,S),H(h,h),c(C,C,h);let re=new Uint8Array(32);return B(re,C),re}n.convertPublicKeyToX25519=be;function ve($){const M=(0,r.hash)($.subarray(0,32));M[0]&=248,M[31]&=127,M[31]|=64;const C=new Uint8Array(M.subarray(0,32));return(0,s.wipe)(M),C}n.convertSecretKeyToX25519=ve})(Ga);const um="EdDSA",hm="JWT",If=".",Of="base64url",lm="utf8",fm="utf8",dm=":",pm="did",gm="key",cl="base58btc",vm="z",ym="K36",bm=32;function Ya(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Pf(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ya(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Na(n,t){t||(t=n.reduce((a,l)=>a+l.length,0));const r=Pf(t);let s=0;for(const a of n)r.set(a,s),s+=a.length;return Ya(r)}function _m(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var l=n.charAt(a),p=l.charCodeAt(0);if(r[p]!==255)throw new TypeError(l+" is ambiguous");r[p]=a}var f=n.length,v=n.charAt(0),w=Math.log(f)/Math.log(256),D=Math.log(256)/Math.log(f);function O(U){if(U instanceof Uint8Array||(ArrayBuffer.isView(U)?U=new Uint8Array(U.buffer,U.byteOffset,U.byteLength):Array.isArray(U)&&(U=Uint8Array.from(U))),!(U instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(U.length===0)return"";for(var z=0,B=0,ee=0,P=U.length;ee!==P&&U[ee]===0;)ee++,z++;for(var T=(P-ee)*D+1>>>0,E=new Uint8Array(T);ee!==P;){for(var x=U[ee],_=0,c=T-1;(x!==0||_<B)&&c!==-1;c--,_++)x+=256*E[c]>>>0,E[c]=x%f>>>0,x=x/f>>>0;if(x!==0)throw new Error("Non-zero carry");B=_,ee++}for(var b=T-B;b!==T&&E[b]===0;)b++;for(var H=v.repeat(z);b<T;++b)H+=n.charAt(E[b]);return H}function L(U){if(typeof U!="string")throw new TypeError("Expected String");if(U.length===0)return new Uint8Array;var z=0;if(U[z]!==" "){for(var B=0,ee=0;U[z]===v;)B++,z++;for(var P=(U.length-z)*w+1>>>0,T=new Uint8Array(P);U[z];){var E=r[U.charCodeAt(z)];if(E===255)return;for(var x=0,_=P-1;(E!==0||x<ee)&&_!==-1;_--,x++)E+=f*T[_]>>>0,T[_]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");ee=x,z++}if(U[z]!==" "){for(var c=P-ee;c!==P&&T[c]===0;)c++;for(var b=new Uint8Array(B+(P-c)),H=B;c!==P;)b[H++]=T[c++];return b}}}function F(U){var z=L(U);if(z)return z;throw new Error(`Non-${t} character`)}return{encode:O,decodeUnsafe:L,decode:F}}var mm=_m,wm=mm;const Cf=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},Em=n=>new TextEncoder().encode(n),Dm=n=>new TextDecoder().decode(n);class Sm{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class xm{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Af(this,t)}}class Im{constructor(t){this.decoders=t}or(t){return Af(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Af=(n,t)=>new Im({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class Om{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new Sm(t,r,s),this.decoder=new xm(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const ks=({name:n,prefix:t,encode:r,decode:s})=>new Om(n,t,r,s),Tn=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=wm(r,t);return ks({prefix:n,name:t,encode:s,decode:l=>Cf(a(l))})},Pm=(n,t,r,s)=>{const a={};for(let D=0;D<t.length;++D)a[t[D]]=D;let l=n.length;for(;n[l-1]==="=";)--l;const p=new Uint8Array(l*r/8|0);let f=0,v=0,w=0;for(let D=0;D<l;++D){const O=a[n[D]];if(O===void 0)throw new SyntaxError(`Non-${s} character`);v=v<<r|O,f+=r,f>=8&&(f-=8,p[w++]=255&v>>f)}if(f>=r||255&v<<8-f)throw new SyntaxError("Unexpected end of data");return p},Cm=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let l="",p=0,f=0;for(let v=0;v<n.length;++v)for(f=f<<8|n[v],p+=8;p>r;)p-=r,l+=t[a&f>>p];if(p&&(l+=t[a&f<<r-p]),s)for(;l.length*r&7;)l+="=";return l},Ut=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>ks({prefix:t,name:n,encode(a){return Cm(a,s,r)},decode(a){return Pm(a,s,r,n)}}),Am=ks({prefix:"\0",name:"identity",encode:n=>Dm(n),decode:n=>Em(n)}),Nm=Object.freeze(Object.defineProperty({__proto__:null,identity:Am},Symbol.toStringTag,{value:"Module"})),Tm=Ut({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Rm=Object.freeze(Object.defineProperty({__proto__:null,base2:Tm},Symbol.toStringTag,{value:"Module"})),Fm=Ut({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Um=Object.freeze(Object.defineProperty({__proto__:null,base8:Fm},Symbol.toStringTag,{value:"Module"})),Lm=Tn({prefix:"9",name:"base10",alphabet:"0123456789"}),$m=Object.freeze(Object.defineProperty({__proto__:null,base10:Lm},Symbol.toStringTag,{value:"Module"})),Mm=Ut({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),jm=Ut({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),qm=Object.freeze(Object.defineProperty({__proto__:null,base16:Mm,base16upper:jm},Symbol.toStringTag,{value:"Module"})),zm=Ut({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Bm=Ut({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),km=Ut({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Hm=Ut({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Km=Ut({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Vm=Ut({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Wm=Ut({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Gm=Ut({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ym=Ut({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Jm=Object.freeze(Object.defineProperty({__proto__:null,base32:zm,base32upper:Bm,base32pad:km,base32padupper:Hm,base32hex:Km,base32hexupper:Vm,base32hexpad:Wm,base32hexpadupper:Gm,base32z:Ym},Symbol.toStringTag,{value:"Module"})),Qm=Tn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Xm=Tn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Zm=Object.freeze(Object.defineProperty({__proto__:null,base36:Qm,base36upper:Xm},Symbol.toStringTag,{value:"Module"})),ew=Tn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),tw=Tn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),rw=Object.freeze(Object.defineProperty({__proto__:null,base58btc:ew,base58flickr:tw},Symbol.toStringTag,{value:"Module"})),iw=Ut({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),nw=Ut({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sw=Ut({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ow=Ut({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),aw=Object.freeze(Object.defineProperty({__proto__:null,base64:iw,base64pad:nw,base64url:sw,base64urlpad:ow},Symbol.toStringTag,{value:"Module"})),Nf=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),cw=Nf.reduce((n,t,r)=>(n[r]=t,n),[]),uw=Nf.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function hw(n){return n.reduce((t,r)=>(t+=cw[r],t),"")}function lw(n){const t=[];for(const r of n){const s=uw[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const fw=ks({prefix:"\u{1F680}",name:"base256emoji",encode:hw,decode:lw}),dw=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:fw},Symbol.toStringTag,{value:"Module"}));var pw=Tf,ul=128,gw=127,vw=~gw,yw=Math.pow(2,31);function Tf(n,t,r){t=t||[],r=r||0;for(var s=r;n>=yw;)t[r++]=n&255|ul,n/=128;for(;n&vw;)t[r++]=n&255|ul,n>>>=7;return t[r]=n|0,Tf.bytes=r-s+1,t}var bw=Ta,_w=128,hl=127;function Ta(n,s){var r=0,s=s||0,a=0,l=s,p,f=n.length;do{if(l>=f)throw Ta.bytes=0,new RangeError("Could not decode varint");p=n[l++],r+=a<28?(p&hl)<<a:(p&hl)*Math.pow(2,a),a+=7}while(p>=_w);return Ta.bytes=l-s,r}var mw=Math.pow(2,7),ww=Math.pow(2,14),Ew=Math.pow(2,21),Dw=Math.pow(2,28),Sw=Math.pow(2,35),xw=Math.pow(2,42),Iw=Math.pow(2,49),Ow=Math.pow(2,56),Pw=Math.pow(2,63),Cw=function(n){return n<mw?1:n<ww?2:n<Ew?3:n<Dw?4:n<Sw?5:n<xw?6:n<Iw?7:n<Ow?8:n<Pw?9:10},Aw={encode:pw,decode:bw,encodingLength:Cw},Rf=Aw;const ll=(n,t,r=0)=>(Rf.encode(n,t,r),t),fl=n=>Rf.encodingLength(n),Ra=(n,t)=>{const r=t.byteLength,s=fl(n),a=s+fl(r),l=new Uint8Array(a+r);return ll(n,l,0),ll(r,l,s),l.set(t,a),new Nw(n,r,t,l)};class Nw{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const Ff=({name:n,code:t,encode:r})=>new Tw(n,t,r);class Tw{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Ra(this.code,r):r.then(s=>Ra(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Uf=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),Rw=Ff({name:"sha2-256",code:18,encode:Uf("SHA-256")}),Fw=Ff({name:"sha2-512",code:19,encode:Uf("SHA-512")}),Uw=Object.freeze(Object.defineProperty({__proto__:null,sha256:Rw,sha512:Fw},Symbol.toStringTag,{value:"Module"})),Lf=0,Lw="identity",$f=Cf,$w=n=>Ra(Lf,$f(n)),Mw={code:Lf,name:Lw,encode:$f,digest:$w},jw=Object.freeze(Object.defineProperty({__proto__:null,identity:Mw},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const dl={...Nm,...Rm,...Um,...$m,...qm,...Jm,...Zm,...rw,...aw,...dw};({...Uw,...jw});function Mf(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const pl=Mf("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),va=Mf("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=Pf(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),jf={utf8:pl,"utf-8":pl,hex:dl.base16,latin1:va,ascii:va,binary:va,...dl};function Wt(n,t="utf8"){const r=jf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}function er(n,t="utf8"){const r=jf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ya(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function Ls(n){return Wt(er(ka(n),lm),Of)}function qf(n){const t=er(ym,cl),r=vm+Wt(Na([t,n]),cl);return[pm,gm,r].join(dm)}function qw(n){return Wt(n,Of)}function zw(n){return er([Ls(n.header),Ls(n.payload)].join(If),fm)}function Bw(n){return[Ls(n.header),Ls(n.payload),qw(n.signature)].join(If)}function gl(n=Ji.randomBytes(bm)){return Ga.generateKeyPairFromSeed(n)}async function kw(n,t,r,s,a=fe.fromMiliseconds(Date.now())){const l={alg:um,typ:hm},p=qf(s.publicKey),f=a+r,v={iss:p,sub:n,aud:t,iat:a,exp:f},w=zw({header:l,payload:v}),D=Ga.sign(s.secretKey,w);return Bw({header:l,payload:v,signature:D})}var Ja={},Hs={};Object.defineProperty(Hs,"__esModule",{value:!0});var jt=Ie,Fa=cr,Hw=20;function Kw(n,t,r){for(var s=1634760805,a=857760878,l=2036477234,p=1797285236,f=r[3]<<24|r[2]<<16|r[1]<<8|r[0],v=r[7]<<24|r[6]<<16|r[5]<<8|r[4],w=r[11]<<24|r[10]<<16|r[9]<<8|r[8],D=r[15]<<24|r[14]<<16|r[13]<<8|r[12],O=r[19]<<24|r[18]<<16|r[17]<<8|r[16],L=r[23]<<24|r[22]<<16|r[21]<<8|r[20],F=r[27]<<24|r[26]<<16|r[25]<<8|r[24],U=r[31]<<24|r[30]<<16|r[29]<<8|r[28],z=t[3]<<24|t[2]<<16|t[1]<<8|t[0],B=t[7]<<24|t[6]<<16|t[5]<<8|t[4],ee=t[11]<<24|t[10]<<16|t[9]<<8|t[8],P=t[15]<<24|t[14]<<16|t[13]<<8|t[12],T=s,E=a,x=l,_=p,c=f,b=v,H=w,K=D,ie=O,oe=L,he=F,N=U,j=z,ae=B,X=ee,W=P,Q=0;Q<Hw;Q+=2)T=T+c|0,j^=T,j=j>>>32-16|j<<16,ie=ie+j|0,c^=ie,c=c>>>32-12|c<<12,E=E+b|0,ae^=E,ae=ae>>>32-16|ae<<16,oe=oe+ae|0,b^=oe,b=b>>>32-12|b<<12,x=x+H|0,X^=x,X=X>>>32-16|X<<16,he=he+X|0,H^=he,H=H>>>32-12|H<<12,_=_+K|0,W^=_,W=W>>>32-16|W<<16,N=N+W|0,K^=N,K=K>>>32-12|K<<12,x=x+H|0,X^=x,X=X>>>32-8|X<<8,he=he+X|0,H^=he,H=H>>>32-7|H<<7,_=_+K|0,W^=_,W=W>>>32-8|W<<8,N=N+W|0,K^=N,K=K>>>32-7|K<<7,E=E+b|0,ae^=E,ae=ae>>>32-8|ae<<8,oe=oe+ae|0,b^=oe,b=b>>>32-7|b<<7,T=T+c|0,j^=T,j=j>>>32-8|j<<8,ie=ie+j|0,c^=ie,c=c>>>32-7|c<<7,T=T+b|0,W^=T,W=W>>>32-16|W<<16,he=he+W|0,b^=he,b=b>>>32-12|b<<12,E=E+H|0,j^=E,j=j>>>32-16|j<<16,N=N+j|0,H^=N,H=H>>>32-12|H<<12,x=x+K|0,ae^=x,ae=ae>>>32-16|ae<<16,ie=ie+ae|0,K^=ie,K=K>>>32-12|K<<12,_=_+c|0,X^=_,X=X>>>32-16|X<<16,oe=oe+X|0,c^=oe,c=c>>>32-12|c<<12,x=x+K|0,ae^=x,ae=ae>>>32-8|ae<<8,ie=ie+ae|0,K^=ie,K=K>>>32-7|K<<7,_=_+c|0,X^=_,X=X>>>32-8|X<<8,oe=oe+X|0,c^=oe,c=c>>>32-7|c<<7,E=E+H|0,j^=E,j=j>>>32-8|j<<8,N=N+j|0,H^=N,H=H>>>32-7|H<<7,T=T+b|0,W^=T,W=W>>>32-8|W<<8,he=he+W|0,b^=he,b=b>>>32-7|b<<7;jt.writeUint32LE(T+s|0,n,0),jt.writeUint32LE(E+a|0,n,4),jt.writeUint32LE(x+l|0,n,8),jt.writeUint32LE(_+p|0,n,12),jt.writeUint32LE(c+f|0,n,16),jt.writeUint32LE(b+v|0,n,20),jt.writeUint32LE(H+w|0,n,24),jt.writeUint32LE(K+D|0,n,28),jt.writeUint32LE(ie+O|0,n,32),jt.writeUint32LE(oe+L|0,n,36),jt.writeUint32LE(he+F|0,n,40),jt.writeUint32LE(N+U|0,n,44),jt.writeUint32LE(j+z|0,n,48),jt.writeUint32LE(ae+B|0,n,52),jt.writeUint32LE(X+ee|0,n,56),jt.writeUint32LE(W+P|0,n,60)}function zf(n,t,r,s,a){if(a===void 0&&(a=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var l,p;if(a===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");l=new Uint8Array(16),p=l.length-t.length,l.set(t,p)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");l=t,p=a}for(var f=new Uint8Array(64),v=0;v<r.length;v+=64){Kw(f,l,n);for(var w=v;w<v+64&&w<r.length;w++)s[w]=r[w]^f[w-v];Ww(l,0,p)}return Fa.wipe(f),a===0&&Fa.wipe(l),s}Hs.streamXOR=zf;function Vw(n,t,r,s){return s===void 0&&(s=0),Fa.wipe(r),zf(n,t,r,r,s)}Hs.stream=Vw;function Ww(n,t,r){for(var s=1;r--;)s=s+(n[t]&255)|0,n[t]=s&255,s>>>=8,t++;if(s>0)throw new Error("ChaCha: counter overflow")}var Bf={},oi={};Object.defineProperty(oi,"__esModule",{value:!0});function Gw(n,t,r){return~(n-1)&t|n-1&r}oi.select=Gw;function Yw(n,t){return(n|0)-(t|0)-1>>>31&1}oi.lessOrEqual=Yw;function kf(n,t){if(n.length!==t.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^t[s];return 1&r-1>>>8}oi.compare=kf;function Jw(n,t){return n.length===0||t.length===0?!1:kf(n,t)!==0}oi.equal=Jw;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=oi,r=cr;n.DIGEST_LENGTH=16;var s=function(){function p(f){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var v=f[0]|f[1]<<8;this._r[0]=v&8191;var w=f[2]|f[3]<<8;this._r[1]=(v>>>13|w<<3)&8191;var D=f[4]|f[5]<<8;this._r[2]=(w>>>10|D<<6)&7939;var O=f[6]|f[7]<<8;this._r[3]=(D>>>7|O<<9)&8191;var L=f[8]|f[9]<<8;this._r[4]=(O>>>4|L<<12)&255,this._r[5]=L>>>1&8190;var F=f[10]|f[11]<<8;this._r[6]=(L>>>14|F<<2)&8191;var U=f[12]|f[13]<<8;this._r[7]=(F>>>11|U<<5)&8065;var z=f[14]|f[15]<<8;this._r[8]=(U>>>8|z<<8)&8191,this._r[9]=z>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return p.prototype._blocks=function(f,v,w){for(var D=this._fin?0:2048,O=this._h[0],L=this._h[1],F=this._h[2],U=this._h[3],z=this._h[4],B=this._h[5],ee=this._h[6],P=this._h[7],T=this._h[8],E=this._h[9],x=this._r[0],_=this._r[1],c=this._r[2],b=this._r[3],H=this._r[4],K=this._r[5],ie=this._r[6],oe=this._r[7],he=this._r[8],N=this._r[9];w>=16;){var j=f[v+0]|f[v+1]<<8;O+=j&8191;var ae=f[v+2]|f[v+3]<<8;L+=(j>>>13|ae<<3)&8191;var X=f[v+4]|f[v+5]<<8;F+=(ae>>>10|X<<6)&8191;var W=f[v+6]|f[v+7]<<8;U+=(X>>>7|W<<9)&8191;var Q=f[v+8]|f[v+9]<<8;z+=(W>>>4|Q<<12)&8191,B+=Q>>>1&8191;var G=f[v+10]|f[v+11]<<8;ee+=(Q>>>14|G<<2)&8191;var Z=f[v+12]|f[v+13]<<8;P+=(G>>>11|Z<<5)&8191;var we=f[v+14]|f[v+15]<<8;T+=(Z>>>8|we<<8)&8191,E+=we>>>5|D;var te=0,ye=te;ye+=O*x,ye+=L*(5*N),ye+=F*(5*he),ye+=U*(5*oe),ye+=z*(5*ie),te=ye>>>13,ye&=8191,ye+=B*(5*K),ye+=ee*(5*H),ye+=P*(5*b),ye+=T*(5*c),ye+=E*(5*_),te+=ye>>>13,ye&=8191;var be=te;be+=O*_,be+=L*x,be+=F*(5*N),be+=U*(5*he),be+=z*(5*oe),te=be>>>13,be&=8191,be+=B*(5*ie),be+=ee*(5*K),be+=P*(5*H),be+=T*(5*b),be+=E*(5*c),te+=be>>>13,be&=8191;var ve=te;ve+=O*c,ve+=L*_,ve+=F*x,ve+=U*(5*N),ve+=z*(5*he),te=ve>>>13,ve&=8191,ve+=B*(5*oe),ve+=ee*(5*ie),ve+=P*(5*K),ve+=T*(5*H),ve+=E*(5*b),te+=ve>>>13,ve&=8191;var $=te;$+=O*b,$+=L*c,$+=F*_,$+=U*x,$+=z*(5*N),te=$>>>13,$&=8191,$+=B*(5*he),$+=ee*(5*oe),$+=P*(5*ie),$+=T*(5*K),$+=E*(5*H),te+=$>>>13,$&=8191;var M=te;M+=O*H,M+=L*b,M+=F*c,M+=U*_,M+=z*x,te=M>>>13,M&=8191,M+=B*(5*N),M+=ee*(5*he),M+=P*(5*oe),M+=T*(5*ie),M+=E*(5*K),te+=M>>>13,M&=8191;var C=te;C+=O*K,C+=L*H,C+=F*b,C+=U*c,C+=z*_,te=C>>>13,C&=8191,C+=B*x,C+=ee*(5*N),C+=P*(5*he),C+=T*(5*oe),C+=E*(5*ie),te+=C>>>13,C&=8191;var h=te;h+=O*ie,h+=L*K,h+=F*H,h+=U*b,h+=z*c,te=h>>>13,h&=8191,h+=B*_,h+=ee*x,h+=P*(5*N),h+=T*(5*he),h+=E*(5*oe),te+=h>>>13,h&=8191;var S=te;S+=O*oe,S+=L*ie,S+=F*K,S+=U*H,S+=z*b,te=S>>>13,S&=8191,S+=B*c,S+=ee*_,S+=P*x,S+=T*(5*N),S+=E*(5*he),te+=S>>>13,S&=8191;var re=te;re+=O*he,re+=L*oe,re+=F*ie,re+=U*K,re+=z*H,te=re>>>13,re&=8191,re+=B*b,re+=ee*c,re+=P*_,re+=T*x,re+=E*(5*N),te+=re>>>13,re&=8191;var ce=te;ce+=O*N,ce+=L*he,ce+=F*oe,ce+=U*ie,ce+=z*K,te=ce>>>13,ce&=8191,ce+=B*H,ce+=ee*b,ce+=P*c,ce+=T*_,ce+=E*x,te+=ce>>>13,ce&=8191,te=(te<<2)+te|0,te=te+ye|0,ye=te&8191,te=te>>>13,be+=te,O=ye,L=be,F=ve,U=$,z=M,B=C,ee=h,P=S,T=re,E=ce,v+=16,w-=16}this._h[0]=O,this._h[1]=L,this._h[2]=F,this._h[3]=U,this._h[4]=z,this._h[5]=B,this._h[6]=ee,this._h[7]=P,this._h[8]=T,this._h[9]=E},p.prototype.finish=function(f,v){v===void 0&&(v=0);var w=new Uint16Array(10),D,O,L,F;if(this._leftover){for(F=this._leftover,this._buffer[F++]=1;F<16;F++)this._buffer[F]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(D=this._h[1]>>>13,this._h[1]&=8191,F=2;F<10;F++)this._h[F]+=D,D=this._h[F]>>>13,this._h[F]&=8191;for(this._h[0]+=D*5,D=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=D,D=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=D,w[0]=this._h[0]+5,D=w[0]>>>13,w[0]&=8191,F=1;F<10;F++)w[F]=this._h[F]+D,D=w[F]>>>13,w[F]&=8191;for(w[9]-=1<<13,O=(D^1)-1,F=0;F<10;F++)w[F]&=O;for(O=~O,F=0;F<10;F++)this._h[F]=this._h[F]&O|w[F];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,L=this._h[0]+this._pad[0],this._h[0]=L&65535,F=1;F<8;F++)L=(this._h[F]+this._pad[F]|0)+(L>>>16)|0,this._h[F]=L&65535;return f[v+0]=this._h[0]>>>0,f[v+1]=this._h[0]>>>8,f[v+2]=this._h[1]>>>0,f[v+3]=this._h[1]>>>8,f[v+4]=this._h[2]>>>0,f[v+5]=this._h[2]>>>8,f[v+6]=this._h[3]>>>0,f[v+7]=this._h[3]>>>8,f[v+8]=this._h[4]>>>0,f[v+9]=this._h[4]>>>8,f[v+10]=this._h[5]>>>0,f[v+11]=this._h[5]>>>8,f[v+12]=this._h[6]>>>0,f[v+13]=this._h[6]>>>8,f[v+14]=this._h[7]>>>0,f[v+15]=this._h[7]>>>8,this._finished=!0,this},p.prototype.update=function(f){var v=0,w=f.length,D;if(this._leftover){D=16-this._leftover,D>w&&(D=w);for(var O=0;O<D;O++)this._buffer[this._leftover+O]=f[v+O];if(w-=D,v+=D,this._leftover+=D,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(w>=16&&(D=w-w%16,this._blocks(f,v,D),v+=D,w-=D),w){for(var O=0;O<w;O++)this._buffer[this._leftover+O]=f[v+O];this._leftover+=w}return this},p.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},p.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},p}();n.Poly1305=s;function a(p,f){var v=new s(p);v.update(f);var w=v.digest();return v.clean(),w}n.oneTimeAuth=a;function l(p,f){return p.length!==n.DIGEST_LENGTH||f.length!==n.DIGEST_LENGTH?!1:t.equal(p,f)}n.equal=l})(Bf);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Hs,r=Bf,s=cr,a=Ie,l=oi;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var p=new Uint8Array(16),f=function(){function v(w){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,w.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(w)}return v.prototype.seal=function(w,D,O,L){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var F=new Uint8Array(16);F.set(w,F.length-w.length);var U=new Uint8Array(32);t.stream(this._key,F,U,4);var z=D.length+this.tagLength,B;if(L){if(L.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");B=L}else B=new Uint8Array(z);return t.streamXOR(this._key,F,D,B,4),this._authenticate(B.subarray(B.length-this.tagLength,B.length),U,B.subarray(0,B.length-this.tagLength),O),s.wipe(F),B},v.prototype.open=function(w,D,O,L){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(D.length<this.tagLength)return null;var F=new Uint8Array(16);F.set(w,F.length-w.length);var U=new Uint8Array(32);t.stream(this._key,F,U,4);var z=new Uint8Array(this.tagLength);if(this._authenticate(z,U,D.subarray(0,D.length-this.tagLength),O),!l.equal(z,D.subarray(D.length-this.tagLength,D.length)))return null;var B=D.length-this.tagLength,ee;if(L){if(L.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");ee=L}else ee=new Uint8Array(B);return t.streamXOR(this._key,F,D.subarray(0,D.length-this.tagLength),ee,4),s.wipe(F),ee},v.prototype.clean=function(){return s.wipe(this._key),this},v.prototype._authenticate=function(w,D,O,L){var F=new r.Poly1305(D);L&&(F.update(L),L.length%16>0&&F.update(p.subarray(L.length%16))),F.update(O),O.length%16>0&&F.update(p.subarray(O.length%16));var U=new Uint8Array(8);L&&a.writeUint64LE(L.length,U),F.update(U),a.writeUint64LE(O.length,U),F.update(U);for(var z=F.digest(),B=0;B<z.length;B++)w[B]=z[B];F.clean(),s.wipe(z),s.wipe(U)},v}();n.ChaCha20Poly1305=f})(Ja);var Hf={},Rn={},Qa={};Object.defineProperty(Qa,"__esModule",{value:!0});function Qw(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}Qa.isSerializableHash=Qw;Object.defineProperty(Rn,"__esModule",{value:!0});var Nr=Qa,Xw=oi,Zw=cr,Kf=function(){function n(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var a=0;a<s.length;a++)s[a]^=54;this._inner.update(s);for(var a=0;a<s.length;a++)s[a]^=106;this._outer.update(s),Nr.isSerializableHash(this._inner)&&Nr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Zw.wipe(s)}return n.prototype.reset=function(){if(!Nr.isSerializableHash(this._inner)||!Nr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){Nr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Nr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(t){return this._inner.update(t),this},n.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},n.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},n.prototype.saveState=function(){if(!Nr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(t){if(!Nr.isSerializableHash(this._inner)||!Nr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(t){if(!Nr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},n}();Rn.HMAC=Kf;function eE(n,t,r){var s=new Kf(n,t);s.update(r);var a=s.digest();return s.clean(),a}Rn.hmac=eE;Rn.equal=Xw.equal;Object.defineProperty(Hf,"__esModule",{value:!0});var vl=Rn,yl=cr,tE=function(){function n(t,r,s,a){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=a;var l=vl.hmac(this._hash,s,r);this._hmac=new vl.HMAC(t,l),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(t){for(var r=new Uint8Array(t),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),yl.wipe(this._buffer),yl.wipe(this._counter),this._bufpos=0},n}(),rE=Hf.HKDF=tE,Ks={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ie,r=cr;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},f.prototype.update=function(v,w){if(w===void 0&&(w=v.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var D=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&w>0;)this._buffer[this._bufferLength++]=v[D++],w--;this._bufferLength===this.blockSize&&(l(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(D=l(this._temp,this._state,v,D,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=v[D++],w--;return this},f.prototype.finish=function(v){if(!this._finished){var w=this._bytesHashed,D=this._bufferLength,O=w/536870912|0,L=w<<3,F=w%64<56?64:128;this._buffer[D]=128;for(var U=D+1;U<F-8;U++)this._buffer[U]=0;t.writeUint32BE(O,this._buffer,F-8),t.writeUint32BE(L,this._buffer,F-4),l(this._temp,this._state,this._buffer,0,F),this._finished=!0}for(var U=0;U<this.digestLength/4;U++)t.writeUint32BE(this._state[U],v,U*4);return this},f.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(v){return this._state.set(v.state),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(v){r.wipe(v.state),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},f}();n.SHA256=s;var a=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function l(f,v,w,D,O){for(;O>=64;){for(var L=v[0],F=v[1],U=v[2],z=v[3],B=v[4],ee=v[5],P=v[6],T=v[7],E=0;E<16;E++){var x=D+E*4;f[E]=t.readUint32BE(w,x)}for(var E=16;E<64;E++){var _=f[E-2],c=(_>>>17|_<<32-17)^(_>>>19|_<<32-19)^_>>>10;_=f[E-15];var b=(_>>>7|_<<32-7)^(_>>>18|_<<32-18)^_>>>3;f[E]=(c+f[E-7]|0)+(b+f[E-16]|0)}for(var E=0;E<64;E++){var c=(((B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))+(B&ee^~B&P)|0)+(T+(a[E]+f[E]|0)|0)|0,b=((L>>>2|L<<32-2)^(L>>>13|L<<32-13)^(L>>>22|L<<32-22))+(L&F^L&U^F&U)|0;T=P,P=ee,ee=B,B=z+c|0,z=U,U=F,F=L,L=c+b|0}v[0]+=L,v[1]+=F,v[2]+=U,v[3]+=z,v[4]+=B,v[5]+=ee,v[6]+=P,v[7]+=T,D+=64,O-=64}return D}function p(f){var v=new s;v.update(f);var w=v.digest();return v.clean(),w}n.hash=p})(Ks);var Xa={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const t=Ji,r=cr;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(E){const x=new Float64Array(16);if(E)for(let _=0;_<E.length;_++)x[_]=E[_];return x}const a=new Uint8Array(32);a[0]=9;const l=s([56129,1]);function p(E){let x=1;for(let _=0;_<16;_++){let c=E[_]+x+65535;x=Math.floor(c/65536),E[_]=c-x*65536}E[0]+=x-1+37*(x-1)}function f(E,x,_){const c=~(_-1);for(let b=0;b<16;b++){const H=c&(E[b]^x[b]);E[b]^=H,x[b]^=H}}function v(E,x){const _=s(),c=s();for(let b=0;b<16;b++)c[b]=x[b];p(c),p(c),p(c);for(let b=0;b<2;b++){_[0]=c[0]-65517;for(let K=1;K<15;K++)_[K]=c[K]-65535-(_[K-1]>>16&1),_[K-1]&=65535;_[15]=c[15]-32767-(_[14]>>16&1);const H=_[15]>>16&1;_[14]&=65535,f(c,_,1-H)}for(let b=0;b<16;b++)E[2*b]=c[b]&255,E[2*b+1]=c[b]>>8}function w(E,x){for(let _=0;_<16;_++)E[_]=x[2*_]+(x[2*_+1]<<8);E[15]&=32767}function D(E,x,_){for(let c=0;c<16;c++)E[c]=x[c]+_[c]}function O(E,x,_){for(let c=0;c<16;c++)E[c]=x[c]-_[c]}function L(E,x,_){let c,b,H=0,K=0,ie=0,oe=0,he=0,N=0,j=0,ae=0,X=0,W=0,Q=0,G=0,Z=0,we=0,te=0,ye=0,be=0,ve=0,$=0,M=0,C=0,h=0,S=0,re=0,ce=0,_e=0,$e=0,ze=0,Re=0,st=0,ot=0,Ue=_[0],me=_[1],Pe=_[2],Ce=_[3],Le=_[4],Se=_[5],Ae=_[6],Ee=_[7],Ne=_[8],je=_[9],Be=_[10],Ke=_[11],Ve=_[12],We=_[13],Ge=_[14],Je=_[15];c=x[0],H+=c*Ue,K+=c*me,ie+=c*Pe,oe+=c*Ce,he+=c*Le,N+=c*Se,j+=c*Ae,ae+=c*Ee,X+=c*Ne,W+=c*je,Q+=c*Be,G+=c*Ke,Z+=c*Ve,we+=c*We,te+=c*Ge,ye+=c*Je,c=x[1],K+=c*Ue,ie+=c*me,oe+=c*Pe,he+=c*Ce,N+=c*Le,j+=c*Se,ae+=c*Ae,X+=c*Ee,W+=c*Ne,Q+=c*je,G+=c*Be,Z+=c*Ke,we+=c*Ve,te+=c*We,ye+=c*Ge,be+=c*Je,c=x[2],ie+=c*Ue,oe+=c*me,he+=c*Pe,N+=c*Ce,j+=c*Le,ae+=c*Se,X+=c*Ae,W+=c*Ee,Q+=c*Ne,G+=c*je,Z+=c*Be,we+=c*Ke,te+=c*Ve,ye+=c*We,be+=c*Ge,ve+=c*Je,c=x[3],oe+=c*Ue,he+=c*me,N+=c*Pe,j+=c*Ce,ae+=c*Le,X+=c*Se,W+=c*Ae,Q+=c*Ee,G+=c*Ne,Z+=c*je,we+=c*Be,te+=c*Ke,ye+=c*Ve,be+=c*We,ve+=c*Ge,$+=c*Je,c=x[4],he+=c*Ue,N+=c*me,j+=c*Pe,ae+=c*Ce,X+=c*Le,W+=c*Se,Q+=c*Ae,G+=c*Ee,Z+=c*Ne,we+=c*je,te+=c*Be,ye+=c*Ke,be+=c*Ve,ve+=c*We,$+=c*Ge,M+=c*Je,c=x[5],N+=c*Ue,j+=c*me,ae+=c*Pe,X+=c*Ce,W+=c*Le,Q+=c*Se,G+=c*Ae,Z+=c*Ee,we+=c*Ne,te+=c*je,ye+=c*Be,be+=c*Ke,ve+=c*Ve,$+=c*We,M+=c*Ge,C+=c*Je,c=x[6],j+=c*Ue,ae+=c*me,X+=c*Pe,W+=c*Ce,Q+=c*Le,G+=c*Se,Z+=c*Ae,we+=c*Ee,te+=c*Ne,ye+=c*je,be+=c*Be,ve+=c*Ke,$+=c*Ve,M+=c*We,C+=c*Ge,h+=c*Je,c=x[7],ae+=c*Ue,X+=c*me,W+=c*Pe,Q+=c*Ce,G+=c*Le,Z+=c*Se,we+=c*Ae,te+=c*Ee,ye+=c*Ne,be+=c*je,ve+=c*Be,$+=c*Ke,M+=c*Ve,C+=c*We,h+=c*Ge,S+=c*Je,c=x[8],X+=c*Ue,W+=c*me,Q+=c*Pe,G+=c*Ce,Z+=c*Le,we+=c*Se,te+=c*Ae,ye+=c*Ee,be+=c*Ne,ve+=c*je,$+=c*Be,M+=c*Ke,C+=c*Ve,h+=c*We,S+=c*Ge,re+=c*Je,c=x[9],W+=c*Ue,Q+=c*me,G+=c*Pe,Z+=c*Ce,we+=c*Le,te+=c*Se,ye+=c*Ae,be+=c*Ee,ve+=c*Ne,$+=c*je,M+=c*Be,C+=c*Ke,h+=c*Ve,S+=c*We,re+=c*Ge,ce+=c*Je,c=x[10],Q+=c*Ue,G+=c*me,Z+=c*Pe,we+=c*Ce,te+=c*Le,ye+=c*Se,be+=c*Ae,ve+=c*Ee,$+=c*Ne,M+=c*je,C+=c*Be,h+=c*Ke,S+=c*Ve,re+=c*We,ce+=c*Ge,_e+=c*Je,c=x[11],G+=c*Ue,Z+=c*me,we+=c*Pe,te+=c*Ce,ye+=c*Le,be+=c*Se,ve+=c*Ae,$+=c*Ee,M+=c*Ne,C+=c*je,h+=c*Be,S+=c*Ke,re+=c*Ve,ce+=c*We,_e+=c*Ge,$e+=c*Je,c=x[12],Z+=c*Ue,we+=c*me,te+=c*Pe,ye+=c*Ce,be+=c*Le,ve+=c*Se,$+=c*Ae,M+=c*Ee,C+=c*Ne,h+=c*je,S+=c*Be,re+=c*Ke,ce+=c*Ve,_e+=c*We,$e+=c*Ge,ze+=c*Je,c=x[13],we+=c*Ue,te+=c*me,ye+=c*Pe,be+=c*Ce,ve+=c*Le,$+=c*Se,M+=c*Ae,C+=c*Ee,h+=c*Ne,S+=c*je,re+=c*Be,ce+=c*Ke,_e+=c*Ve,$e+=c*We,ze+=c*Ge,Re+=c*Je,c=x[14],te+=c*Ue,ye+=c*me,be+=c*Pe,ve+=c*Ce,$+=c*Le,M+=c*Se,C+=c*Ae,h+=c*Ee,S+=c*Ne,re+=c*je,ce+=c*Be,_e+=c*Ke,$e+=c*Ve,ze+=c*We,Re+=c*Ge,st+=c*Je,c=x[15],ye+=c*Ue,be+=c*me,ve+=c*Pe,$+=c*Ce,M+=c*Le,C+=c*Se,h+=c*Ae,S+=c*Ee,re+=c*Ne,ce+=c*je,_e+=c*Be,$e+=c*Ke,ze+=c*Ve,Re+=c*We,st+=c*Ge,ot+=c*Je,H+=38*be,K+=38*ve,ie+=38*$,oe+=38*M,he+=38*C,N+=38*h,j+=38*S,ae+=38*re,X+=38*ce,W+=38*_e,Q+=38*$e,G+=38*ze,Z+=38*Re,we+=38*st,te+=38*ot,b=1,c=H+b+65535,b=Math.floor(c/65536),H=c-b*65536,c=K+b+65535,b=Math.floor(c/65536),K=c-b*65536,c=ie+b+65535,b=Math.floor(c/65536),ie=c-b*65536,c=oe+b+65535,b=Math.floor(c/65536),oe=c-b*65536,c=he+b+65535,b=Math.floor(c/65536),he=c-b*65536,c=N+b+65535,b=Math.floor(c/65536),N=c-b*65536,c=j+b+65535,b=Math.floor(c/65536),j=c-b*65536,c=ae+b+65535,b=Math.floor(c/65536),ae=c-b*65536,c=X+b+65535,b=Math.floor(c/65536),X=c-b*65536,c=W+b+65535,b=Math.floor(c/65536),W=c-b*65536,c=Q+b+65535,b=Math.floor(c/65536),Q=c-b*65536,c=G+b+65535,b=Math.floor(c/65536),G=c-b*65536,c=Z+b+65535,b=Math.floor(c/65536),Z=c-b*65536,c=we+b+65535,b=Math.floor(c/65536),we=c-b*65536,c=te+b+65535,b=Math.floor(c/65536),te=c-b*65536,c=ye+b+65535,b=Math.floor(c/65536),ye=c-b*65536,H+=b-1+37*(b-1),b=1,c=H+b+65535,b=Math.floor(c/65536),H=c-b*65536,c=K+b+65535,b=Math.floor(c/65536),K=c-b*65536,c=ie+b+65535,b=Math.floor(c/65536),ie=c-b*65536,c=oe+b+65535,b=Math.floor(c/65536),oe=c-b*65536,c=he+b+65535,b=Math.floor(c/65536),he=c-b*65536,c=N+b+65535,b=Math.floor(c/65536),N=c-b*65536,c=j+b+65535,b=Math.floor(c/65536),j=c-b*65536,c=ae+b+65535,b=Math.floor(c/65536),ae=c-b*65536,c=X+b+65535,b=Math.floor(c/65536),X=c-b*65536,c=W+b+65535,b=Math.floor(c/65536),W=c-b*65536,c=Q+b+65535,b=Math.floor(c/65536),Q=c-b*65536,c=G+b+65535,b=Math.floor(c/65536),G=c-b*65536,c=Z+b+65535,b=Math.floor(c/65536),Z=c-b*65536,c=we+b+65535,b=Math.floor(c/65536),we=c-b*65536,c=te+b+65535,b=Math.floor(c/65536),te=c-b*65536,c=ye+b+65535,b=Math.floor(c/65536),ye=c-b*65536,H+=b-1+37*(b-1),E[0]=H,E[1]=K,E[2]=ie,E[3]=oe,E[4]=he,E[5]=N,E[6]=j,E[7]=ae,E[8]=X,E[9]=W,E[10]=Q,E[11]=G,E[12]=Z,E[13]=we,E[14]=te,E[15]=ye}function F(E,x){L(E,x,x)}function U(E,x){const _=s();for(let c=0;c<16;c++)_[c]=x[c];for(let c=253;c>=0;c--)F(_,_),c!==2&&c!==4&&L(_,_,x);for(let c=0;c<16;c++)E[c]=_[c]}function z(E,x){const _=new Uint8Array(32),c=new Float64Array(80),b=s(),H=s(),K=s(),ie=s(),oe=s(),he=s();for(let X=0;X<31;X++)_[X]=E[X];_[31]=E[31]&127|64,_[0]&=248,w(c,x);for(let X=0;X<16;X++)H[X]=c[X];b[0]=ie[0]=1;for(let X=254;X>=0;--X){const W=_[X>>>3]>>>(X&7)&1;f(b,H,W),f(K,ie,W),D(oe,b,K),O(b,b,K),D(K,H,ie),O(H,H,ie),F(ie,oe),F(he,b),L(b,K,b),L(K,H,oe),D(oe,b,K),O(b,b,K),F(H,b),O(K,ie,he),L(b,K,l),D(b,b,ie),L(K,K,b),L(b,ie,he),L(ie,H,c),F(H,oe),f(b,H,W),f(K,ie,W)}for(let X=0;X<16;X++)c[X+16]=b[X],c[X+32]=K[X],c[X+48]=H[X],c[X+64]=ie[X];const N=c.subarray(32),j=c.subarray(16);U(N,N),L(j,j,N);const ae=new Uint8Array(32);return v(ae,j),ae}n.scalarMult=z;function B(E){return z(E,a)}n.scalarMultBase=B;function ee(E){if(E.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const x=new Uint8Array(E);return{publicKey:B(x),secretKey:x}}n.generateKeyPairFromSeed=ee;function P(E){const x=(0,t.randomBytes)(32,E),_=ee(x);return(0,r.wipe)(x),_}n.generateKeyPair=P;function T(E,x,_=!1){if(E.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(x.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=z(E,x);if(_){let b=0;for(let H=0;H<c.length;H++)b|=c[H];if(b===0)throw new Error("X25519: invalid shared key")}return c}n.sharedKey=T})(Xa);var bl=globalThis&&globalThis.__spreadArray||function(n,t,r){if(r||arguments.length===2)for(var s=0,a=t.length,l;s<a;s++)(l||!(s in t))&&(l||(l=Array.prototype.slice.call(t,0,s)),l[s]=t[s]);return n.concat(l||Array.prototype.slice.call(t))},iE=function(){function n(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return n}(),nE=function(){function n(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return n}(),sE=function(){function n(t,r,s,a){this.name=t,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return n}(),oE=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),aE=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),cE=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,uE=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,_l=3,hE=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",cE]],ml=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function lE(n){return n?wl(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new aE:typeof navigator<"u"?wl(navigator.userAgent):pE()}function fE(n){return n!==""&&hE.reduce(function(t,r){var s=r[0],a=r[1];if(t)return t;var l=a.exec(n);return!!l&&[s,l]},!1)}function wl(n){var t=fE(n);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new oE;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<_l&&(a=bl(bl([],a,!0),gE(_l-a.length),!0)):a=[];var l=a.join("."),p=dE(n),f=uE.exec(n);return f&&f[1]?new sE(r,l,p,f[1]):new iE(r,l,p)}function dE(n){for(var t=0,r=ml.length;t<r;t++){var s=ml[t],a=s[0],l=s[1],p=l.exec(n);if(p)return a}return null}function pE(){var n=typeof process<"u"&&process.version;return n?new nE(process.version.slice(1)):null}function gE(n){for(var t=[],r=0;r<n;r++)t.push("0");return t}var tt={};Object.defineProperty(tt,"__esModule",{value:!0});tt.getLocalStorage=tt.getLocalStorageOrThrow=tt.getCrypto=tt.getCryptoOrThrow=Wf=tt.getLocation=tt.getLocationOrThrow=Za=tt.getNavigator=tt.getNavigatorOrThrow=Vf=tt.getDocument=tt.getDocumentOrThrow=tt.getFromWindowOrThrow=tt.getFromWindow=void 0;function Ii(n){let t;return typeof window<"u"&&typeof window[n]<"u"&&(t=window[n]),t}tt.getFromWindow=Ii;function Qi(n){const t=Ii(n);if(!t)throw new Error(`${n} is not defined in Window`);return t}tt.getFromWindowOrThrow=Qi;function vE(){return Qi("document")}tt.getDocumentOrThrow=vE;function yE(){return Ii("document")}var Vf=tt.getDocument=yE;function bE(){return Qi("navigator")}tt.getNavigatorOrThrow=bE;function _E(){return Ii("navigator")}var Za=tt.getNavigator=_E;function mE(){return Qi("location")}tt.getLocationOrThrow=mE;function wE(){return Ii("location")}var Wf=tt.getLocation=wE;function EE(){return Qi("crypto")}tt.getCryptoOrThrow=EE;function DE(){return Ii("crypto")}tt.getCrypto=DE;function SE(){return Qi("localStorage")}tt.getLocalStorageOrThrow=SE;function xE(){return Ii("localStorage")}tt.getLocalStorage=xE;var ec={};Object.defineProperty(ec,"__esModule",{value:!0});var Gf=ec.getWindowMetadata=void 0;const El=tt;function IE(){let n,t;try{n=El.getDocumentOrThrow(),t=El.getLocationOrThrow()}catch{return null}function r(){const O=n.getElementsByTagName("link"),L=[];for(let F=0;F<O.length;F++){const U=O[F],z=U.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const B=U.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let ee=t.protocol+"//"+t.host;if(B.indexOf("/")===0)ee+=B;else{const P=t.pathname.split("/");P.pop();const T=P.join("/");ee+=T+"/"+B}L.push(ee)}else if(B.indexOf("//")===0){const ee=t.protocol+B;L.push(ee)}else L.push(B)}}return L}function s(...O){const L=n.getElementsByTagName("meta");for(let F=0;F<L.length;F++){const U=L[F],z=["itemprop","property","name"].map(B=>U.getAttribute(B)).filter(B=>B?O.includes(B):!1);if(z.length&&z){const B=U.getAttribute("content");if(B)return B}}return""}function a(){let O=s("name","og:site_name","og:title","twitter:title");return O||(O=n.title),O}function l(){return s("description","og:description","twitter:description","keywords")}const p=a(),f=l(),v=t.origin,w=r();return{description:f,url:v,icons:w,name:p}}Gf=ec.getWindowMetadata=IE;var Cn={},OE=function(n,t){for(var r={},s=Object.keys(n),a=Array.isArray(t),l=0;l<s.length;l++){var p=s[l],f=n[p];(a?t.indexOf(p)!==-1:t(p,f,n))&&(r[p]=f)}return r};(function(n){const t=Vb,r=Wb,s=Kb,a=OE,l=P=>P==null,p=Symbol("encodeFragmentIdentifier");function f(P){switch(P.arrayFormat){case"index":return T=>(E,x)=>{const _=E.length;return x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?E:x===null?[...E,[D(T,P),"[",_,"]"].join("")]:[...E,[D(T,P),"[",D(_,P),"]=",D(x,P)].join("")]};case"bracket":return T=>(E,x)=>x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?E:x===null?[...E,[D(T,P),"[]"].join("")]:[...E,[D(T,P),"[]=",D(x,P)].join("")];case"colon-list-separator":return T=>(E,x)=>x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?E:x===null?[...E,[D(T,P),":list="].join("")]:[...E,[D(T,P),":list=",D(x,P)].join("")];case"comma":case"separator":case"bracket-separator":{const T=P.arrayFormat==="bracket-separator"?"[]=":"=";return E=>(x,_)=>_===void 0||P.skipNull&&_===null||P.skipEmptyString&&_===""?x:(_=_===null?"":_,x.length===0?[[D(E,P),T,D(_,P)].join("")]:[[x,D(_,P)].join(P.arrayFormatSeparator)])}default:return T=>(E,x)=>x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?E:x===null?[...E,D(T,P)]:[...E,[D(T,P),"=",D(x,P)].join("")]}}function v(P){let T;switch(P.arrayFormat){case"index":return(E,x,_)=>{if(T=/\[(\d*)\]$/.exec(E),E=E.replace(/\[\d*\]$/,""),!T){_[E]=x;return}_[E]===void 0&&(_[E]={}),_[E][T[1]]=x};case"bracket":return(E,x,_)=>{if(T=/(\[\])$/.exec(E),E=E.replace(/\[\]$/,""),!T){_[E]=x;return}if(_[E]===void 0){_[E]=[x];return}_[E]=[].concat(_[E],x)};case"colon-list-separator":return(E,x,_)=>{if(T=/(:list)$/.exec(E),E=E.replace(/:list$/,""),!T){_[E]=x;return}if(_[E]===void 0){_[E]=[x];return}_[E]=[].concat(_[E],x)};case"comma":case"separator":return(E,x,_)=>{const c=typeof x=="string"&&x.includes(P.arrayFormatSeparator),b=typeof x=="string"&&!c&&O(x,P).includes(P.arrayFormatSeparator);x=b?O(x,P):x;const H=c||b?x.split(P.arrayFormatSeparator).map(K=>O(K,P)):x===null?x:O(x,P);_[E]=H};case"bracket-separator":return(E,x,_)=>{const c=/(\[\])$/.test(E);if(E=E.replace(/\[\]$/,""),!c){_[E]=x&&O(x,P);return}const b=x===null?[]:x.split(P.arrayFormatSeparator).map(H=>O(H,P));if(_[E]===void 0){_[E]=b;return}_[E]=[].concat(_[E],b)};default:return(E,x,_)=>{if(_[E]===void 0){_[E]=x;return}_[E]=[].concat(_[E],x)}}}function w(P){if(typeof P!="string"||P.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function D(P,T){return T.encode?T.strict?t(P):encodeURIComponent(P):P}function O(P,T){return T.decode?r(P):P}function L(P){return Array.isArray(P)?P.sort():typeof P=="object"?L(Object.keys(P)).sort((T,E)=>Number(T)-Number(E)).map(T=>P[T]):P}function F(P){const T=P.indexOf("#");return T!==-1&&(P=P.slice(0,T)),P}function U(P){let T="";const E=P.indexOf("#");return E!==-1&&(T=P.slice(E)),T}function z(P){P=F(P);const T=P.indexOf("?");return T===-1?"":P.slice(T+1)}function B(P,T){return T.parseNumbers&&!Number.isNaN(Number(P))&&typeof P=="string"&&P.trim()!==""?P=Number(P):T.parseBooleans&&P!==null&&(P.toLowerCase()==="true"||P.toLowerCase()==="false")&&(P=P.toLowerCase()==="true"),P}function ee(P,T){T=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},T),w(T.arrayFormatSeparator);const E=v(T),x=Object.create(null);if(typeof P!="string"||(P=P.trim().replace(/^[?#&]/,""),!P))return x;for(const _ of P.split("&")){if(_==="")continue;let[c,b]=s(T.decode?_.replace(/\+/g," "):_,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(T.arrayFormat)?b:O(b,T),E(O(c,T),b,x)}for(const _ of Object.keys(x)){const c=x[_];if(typeof c=="object"&&c!==null)for(const b of Object.keys(c))c[b]=B(c[b],T);else x[_]=B(c,T)}return T.sort===!1?x:(T.sort===!0?Object.keys(x).sort():Object.keys(x).sort(T.sort)).reduce((_,c)=>{const b=x[c];return Boolean(b)&&typeof b=="object"&&!Array.isArray(b)?_[c]=L(b):_[c]=b,_},Object.create(null))}n.extract=z,n.parse=ee,n.stringify=(P,T)=>{if(!P)return"";T=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},T),w(T.arrayFormatSeparator);const E=b=>T.skipNull&&l(P[b])||T.skipEmptyString&&P[b]==="",x=f(T),_={};for(const b of Object.keys(P))E(b)||(_[b]=P[b]);const c=Object.keys(_);return T.sort!==!1&&c.sort(T.sort),c.map(b=>{const H=P[b];return H===void 0?"":H===null?D(b,T):Array.isArray(H)?H.length===0&&T.arrayFormat==="bracket-separator"?D(b,T)+"[]":H.reduce(x(b),[]).join("&"):D(b,T)+"="+D(H,T)}).filter(b=>b.length>0).join("&")},n.parseUrl=(P,T)=>{T=Object.assign({decode:!0},T);const[E,x]=s(P,"#");return Object.assign({url:E.split("?")[0]||"",query:ee(z(P),T)},T&&T.parseFragmentIdentifier&&x?{fragmentIdentifier:O(x,T)}:{})},n.stringifyUrl=(P,T)=>{T=Object.assign({encode:!0,strict:!0,[p]:!0},T);const E=F(P.url).split("?")[0]||"",x=n.extract(P.url),_=n.parse(x,{sort:!1}),c=Object.assign(_,P.query);let b=n.stringify(c,T);b&&(b=`?${b}`);let H=U(P.url);return P.fragmentIdentifier&&(H=`#${T[p]?D(P.fragmentIdentifier,T):P.fragmentIdentifier}`),`${E}${b}${H}`},n.pick=(P,T,E)=>{E=Object.assign({parseFragmentIdentifier:!0,[p]:!1},E);const{url:x,query:_,fragmentIdentifier:c}=n.parseUrl(P,E);return n.stringifyUrl({url:x,query:a(_,T),fragmentIdentifier:c},E)},n.exclude=(P,T,E)=>{const x=Array.isArray(T)?_=>!T.includes(_):(_,c)=>!T(_,c);return n.pick(P,x,E)}})(Cn);const PE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Yf(n,t){return n.includes(":")?[n]:t.chains||[]}const Jf="base10",Vt="base16",Ua="base64pad",tc="utf8",Qf=0,Oi=1,CE=0,Dl=1,La=12,rc=32;function AE(){const n=Xa.generateKeyPair();return{privateKey:Wt(n.secretKey,Vt),publicKey:Wt(n.publicKey,Vt)}}function $a(){const n=Ji.randomBytes(rc);return Wt(n,Vt)}function NE(n,t){const r=Xa.sharedKey(er(n,Vt),er(t,Vt)),s=new rE(Ks.SHA256,r).expand(rc);return Wt(s,Vt)}function TE(n){const t=Ks.hash(er(n,Vt));return Wt(t,Vt)}function Wi(n){const t=Ks.hash(er(n,tc));return Wt(t,Vt)}function RE(n){return er(`${n}`,Jf)}function Fn(n){return Number(Wt(n,Jf))}function FE(n){const t=RE(typeof n.type<"u"?n.type:Qf);if(Fn(t)===Oi&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?er(n.senderPublicKey,Vt):void 0,s=typeof n.iv<"u"?er(n.iv,Vt):Ji.randomBytes(La),a=new Ja.ChaCha20Poly1305(er(n.symKey,Vt)).seal(s,er(n.message,tc));return LE({type:t,sealed:a,iv:s,senderPublicKey:r})}function UE(n){const t=new Ja.ChaCha20Poly1305(er(n.symKey,Vt)),{sealed:r,iv:s}=$s(n.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return Wt(a,tc)}function LE(n){if(Fn(n.type)===Oi){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Wt(Na([n.type,n.senderPublicKey,n.iv,n.sealed]),Ua)}return Wt(Na([n.type,n.iv,n.sealed]),Ua)}function $s(n){const t=er(n,Ua),r=t.slice(CE,Dl),s=Dl;if(Fn(r)===Oi){const f=s+rc,v=f+La,w=t.slice(s,f),D=t.slice(f,v),O=t.slice(v);return{type:r,sealed:O,iv:D,senderPublicKey:w}}const a=s+La,l=t.slice(s,a),p=t.slice(a);return{type:r,sealed:p,iv:l}}function $E(n,t){const r=$s(n);return Xf({type:Fn(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Wt(r.senderPublicKey,Vt):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Xf(n){const t=(n==null?void 0:n.type)||Qf;if(t===Oi){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function Sl(n){return n.type===Oi&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var ME=Object.defineProperty,xl=Object.getOwnPropertySymbols,jE=Object.prototype.hasOwnProperty,qE=Object.prototype.propertyIsEnumerable,Il=(n,t,r)=>t in n?ME(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ol=(n,t)=>{for(var r in t||(t={}))jE.call(t,r)&&Il(n,r,t[r]);if(xl)for(var r of xl(t))qE.call(t,r)&&Il(n,r,t[r]);return n};const zE="ReactNative",ar={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},BE="js";function ic(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Vs(){return!Vf()&&!!Za()&&navigator.product===zE}function Un(){return!ic()&&!!Za()}function Ln(){return Vs()?ar.reactNative:ic()?ar.node:Un()?ar.browser:ar.unknown}function kE(n,t){let r=Cn.parse(n);return r=Ol(Ol({},r),t),n=Cn.stringify(r),n}function HE(){return Gf()||{name:"",description:"",url:"",icons:[""]}}function KE(){if(Ln()===ar.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const n=lE();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function VE(){var n;const t=Ln();return t===ar.browser?[t,((n=Wf())==null?void 0:n.host)||"unknown"].join(":"):t}function WE(n,t,r){const s=KE(),a=VE();return[[n,t].join("-"),[BE,r].join("-"),s,a].join("/")}function GE({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:l,useOnCloseEvent:p}){const f=r.split("?"),v=WE(n,t,s),w={auth:a,ua:v,projectId:l,useOnCloseEvent:p||void 0},D=kE(f[1]||"",w);return f[0]+"?"+D}function Ei(n,t){return n.filter(r=>t.includes(r)).length===n.length}function Zf(n){return Object.fromEntries(n.entries())}function ed(n){return new Map(Object.entries(n))}function Vi(n=fe.FIVE_MINUTES,t){const r=fe.toMiliseconds(n||fe.FIVE_MINUTES);let s,a,l;return{resolve:p=>{l&&s&&(clearTimeout(l),s(p))},reject:p=>{l&&a&&(clearTimeout(l),a(p))},done:()=>new Promise((p,f)=>{l=setTimeout(()=>{f(new Error(t))},r),s=p,a=f})}}function An(n,t,r){return new Promise(async(s,a)=>{const l=setTimeout(()=>a(new Error(r)),t);try{const p=await n;s(p)}catch(p){a(p)}clearTimeout(l)})}function td(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function YE(n){return td("topic",n)}function JE(n){return td("id",n)}function rd(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Ir(n,t){return fe.fromMiliseconds((t||Date.now())+fe.toMiliseconds(n))}function ii(n){return Date.now()>=fe.toMiliseconds(n)}function dt(n,t){return`${n}${t?`:${t}`:""}`}function ya(n=[],t=[]){return[...new Set([...n,...t])]}async function QE({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const l=`${a}/wc?requestId=${n}&sessionTopic=${t}`,p=Ln();p===ar.browser?l.startsWith("https://")?window.open(l,"_blank","noreferrer noopener"):window.open(l,"_self","noreferrer noopener"):p===ar.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(l)}catch(s){console.error(s)}}const XE="irn";function Ma(n){return(n==null?void 0:n.relay)||{protocol:XE}}function As(n){const t=PE[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var ZE=Object.defineProperty,Pl=Object.getOwnPropertySymbols,e3=Object.prototype.hasOwnProperty,t3=Object.prototype.propertyIsEnumerable,Cl=(n,t,r)=>t in n?ZE(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,r3=(n,t)=>{for(var r in t||(t={}))e3.call(t,r)&&Cl(n,r,t[r]);if(Pl)for(var r of Pl(t))t3.call(t,r)&&Cl(n,r,t[r]);return n};function i3(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const l=a.replace(s,""),p=n[a];r[l]=p}}),r}function n3(n){const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),a=n.substring(t+1,r).split("@"),l=typeof r<"u"?n.substring(r):"",p=Cn.parse(l);return{protocol:s,topic:s3(a[0]),version:parseInt(a[1],10),symKey:p.symKey,relay:i3(p)}}function s3(n){return n.startsWith("//")?n.substring(2):n}function o3(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const l=r+t+a;n[a]&&(s[l]=n[a])}),s}function a3(n){return`${n.protocol}:${n.topic}@${n.version}?`+Cn.stringify(r3({symKey:n.symKey},o3(n.relay)))}function Xi(n){const t=[];return n.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function c3(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Xi(r.accounts))}),t}function u3(n,t){const r=[];return Object.values(n).forEach(s=>{Xi(s.accounts).includes(t)&&r.push(...s.methods)}),r}function h3(n,t){const r=[];return Object.values(n).forEach(s=>{Xi(s.accounts).includes(t)&&r.push(...s.events)}),r}function l3(n,t){const r=Ns(n,t);if(r)throw new Error(r.message);const s={};for(const[a,l]of Object.entries(n))s[a]={methods:l.methods,events:l.events,chains:l.accounts.map(p=>`${p.split(":")[0]}:${p.split(":")[1]}`)};return s}function nc(n){return n.includes(":")}function Pn(n){return nc(n)?n.split(":")[0]:n}const f3={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},d3={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function se(n,t){const{message:r,code:s}=d3[n];return{message:t?`${r} ${t}`:r,code:s}}function pt(n,t){const{message:r,code:s}=f3[n];return{message:t?`${r} ${t}`:r,code:s}}function Di(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function Gi(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function Kt(n){return typeof n>"u"}function Tt(n,t){return t&&Kt(n)?!0:typeof n=="string"&&!!n.trim().length}function sc(n,t){return t&&Kt(n)?!0:typeof n=="number"&&!isNaN(n)}function p3(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),a=Object.keys(r);let l=!0;return Ei(a,s)?(s.forEach(p=>{const{accounts:f,methods:v,events:w}=n.namespaces[p],D=Xi(f),O=r[p];(!Ei(Yf(p,O),D)||!Ei(O.methods,v)||!Ei(O.events,w))&&(l=!1)}),l):!1}function Ms(n){return Tt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function g3(n){if(Tt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Ms(r)}}return!1}function v3(n){if(Tt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function y3(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function b3(n){return n==null?void 0:n.topic}function _3(n,t){let r=null;return Tt(n==null?void 0:n.publicKey,!1)||(r=se("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Al(n){let t=!0;return Di(n)?n.length&&(t=n.every(r=>Tt(r,!1))):t=!1,t}function m3(n,t,r){let s=null;return Di(t)&&t.length?t.forEach(a=>{s||Ms(a)||(s=pt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Ms(n)||(s=pt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function w3(n,t,r){let s=null;return Object.entries(n).forEach(([a,l])=>{if(s)return;const p=m3(a,Yf(a,l),`${t} ${r}`);p&&(s=p)}),s}function E3(n,t){let r=null;return Di(n)?n.forEach(s=>{r||g3(s)||(r=pt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=pt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function D3(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=E3(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function S3(n,t){let r=null;return Al(n==null?void 0:n.methods)?Al(n==null?void 0:n.events)||(r=pt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=pt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function id(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=S3(s,`${t}, namespace`);a&&(r=a)}),r}function x3(n,t,r){let s=null;if(n&&Gi(n)){const a=id(n,t);a&&(s=a);const l=w3(n,t,r);l&&(s=l)}else s=se("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Ns(n,t){let r=null;if(n&&Gi(n)){const s=id(n,t);s&&(r=s);const a=D3(n,t);a&&(r=a)}else r=se("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function nd(n){return Tt(n.protocol,!0)}function I3(n,t){let r=!1;return t&&!n?r=!0:n&&Di(n)&&n.length&&n.forEach(s=>{r=nd(s)}),r}function O3(n){return typeof n=="number"}function Zt(n){return typeof n<"u"&&typeof n!==null}function P3(n){return!(!n||typeof n!="object"||!n.code||!sc(n.code,!1)||!n.message||!Tt(n.message,!1))}function C3(n){return!(Kt(n)||!Tt(n.method,!1))}function A3(n){return!(Kt(n)||Kt(n.result)&&Kt(n.error)||!sc(n.id,!1)||!Tt(n.jsonrpc,!1))}function N3(n){return!(Kt(n)||!Tt(n.name,!1))}function Nl(n,t){return!(!Ms(t)||!c3(n).includes(t))}function T3(n,t,r){return Tt(r,!1)?u3(n,t).includes(r):!1}function R3(n,t,r){return Tt(r,!1)?h3(n,t).includes(r):!1}function Tl(n,t,r){let s=null;const a=F3(n),l=U3(t),p=Object.keys(a),f=Object.keys(l),v=Rl(Object.keys(n)),w=Rl(Object.keys(t)),D=v.filter(O=>!w.includes(O));return D.length&&(s=se("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${D.toString()}
      Received: ${Object.keys(t).toString()}`)),Ei(p,f)||(s=se("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${p.toString()}
      Approved: ${f.toString()}`)),Object.keys(t).forEach(O=>{if(!O.includes(":")||s)return;const L=Xi(t[O].accounts);L.includes(O)||(s=se("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${O}
        Required: ${O}
        Approved: ${L.toString()}`))}),p.forEach(O=>{s||(Ei(a[O].methods,l[O].methods)?Ei(a[O].events,l[O].events)||(s=se("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${O}`)):s=se("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${O}`))}),s}function F3(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{t[a]={methods:n[r].methods,events:n[r].events}})}),t}function Rl(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function U3(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Xi(n[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:n[r].accounts.filter(l=>l.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function L3(n,t){return sc(n,!1)&&n<=t.max&&n>=t.min}function Fl(){const n=Ln();return new Promise(t=>{switch(n){case ar.browser:t($3());break;case ar.reactNative:t(M3());break;case ar.node:t(j3());break;default:t(!0)}})}function $3(){return Un()&&(navigator==null?void 0:navigator.onLine)}async function M3(){if(Vs()&&typeof global<"u"&&global!=null&&global.NetInfo){const n=await(global==null?void 0:global.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function j3(){return!0}function q3(n){switch(Ln()){case ar.browser:z3(n);break;case ar.reactNative:B3(n);break}}function z3(n){Un()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function B3(n){Vs()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>n(t==null?void 0:t.isConnected)))}const ba={};class Is{static get(t){return ba[t]}static set(t,r){ba[t]=r}static delete(t){delete ba[t]}}const k3=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),H3=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Ul=n=>n.split("?")[0],Ll=10,K3=k3();class V3{constructor(t){if(this.url=t,this.events=new mr.exports.EventEmitter,this.registering=!1,!$h(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ka(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!$h(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const a=Gb.isReactNative()?void 0:{rejectUnauthorized:!Yb(t)},l=new K3(t,[],a);H3()?l.onerror=p=>{const f=p;s(this.emitError(f.error))}:l.on("error",p=>{s(this.emitError(p))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?df(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),l=Ha(t,a);this.events.emit("payload",l)}parseError(t,r=this.url){return Jb(t,Ul(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Ll&&this.events.setMaxListeners(Ll)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Ul(this.url)}`));return this.events.emit("register_error",r),r}}function W3(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var l=n.charAt(a),p=l.charCodeAt(0);if(r[p]!==255)throw new TypeError(l+" is ambiguous");r[p]=a}var f=n.length,v=n.charAt(0),w=Math.log(f)/Math.log(256),D=Math.log(256)/Math.log(f);function O(U){if(U instanceof Uint8Array||(ArrayBuffer.isView(U)?U=new Uint8Array(U.buffer,U.byteOffset,U.byteLength):Array.isArray(U)&&(U=Uint8Array.from(U))),!(U instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(U.length===0)return"";for(var z=0,B=0,ee=0,P=U.length;ee!==P&&U[ee]===0;)ee++,z++;for(var T=(P-ee)*D+1>>>0,E=new Uint8Array(T);ee!==P;){for(var x=U[ee],_=0,c=T-1;(x!==0||_<B)&&c!==-1;c--,_++)x+=256*E[c]>>>0,E[c]=x%f>>>0,x=x/f>>>0;if(x!==0)throw new Error("Non-zero carry");B=_,ee++}for(var b=T-B;b!==T&&E[b]===0;)b++;for(var H=v.repeat(z);b<T;++b)H+=n.charAt(E[b]);return H}function L(U){if(typeof U!="string")throw new TypeError("Expected String");if(U.length===0)return new Uint8Array;var z=0;if(U[z]!==" "){for(var B=0,ee=0;U[z]===v;)B++,z++;for(var P=(U.length-z)*w+1>>>0,T=new Uint8Array(P);U[z];){var E=r[U.charCodeAt(z)];if(E===255)return;for(var x=0,_=P-1;(E!==0||x<ee)&&_!==-1;_--,x++)E+=f*T[_]>>>0,T[_]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");ee=x,z++}if(U[z]!==" "){for(var c=P-ee;c!==P&&T[c]===0;)c++;for(var b=new Uint8Array(B+(P-c)),H=B;c!==P;)b[H++]=T[c++];return b}}}function F(U){var z=L(U);if(z)return z;throw new Error(`Non-${t} character`)}return{encode:O,decodeUnsafe:L,decode:F}}var G3=W3,Y3=G3;const sd=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},J3=n=>new TextEncoder().encode(n),Q3=n=>new TextDecoder().decode(n);class X3{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Z3{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return od(this,t)}}class e6{constructor(t){this.decoders=t}or(t){return od(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const od=(n,t)=>new e6({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class t6{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new X3(t,r,s),this.decoder=new Z3(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ws=({name:n,prefix:t,encode:r,decode:s})=>new t6(n,t,r,s),$n=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=Y3(r,t);return Ws({prefix:n,name:t,encode:s,decode:l=>sd(a(l))})},r6=(n,t,r,s)=>{const a={};for(let D=0;D<t.length;++D)a[t[D]]=D;let l=n.length;for(;n[l-1]==="=";)--l;const p=new Uint8Array(l*r/8|0);let f=0,v=0,w=0;for(let D=0;D<l;++D){const O=a[n[D]];if(O===void 0)throw new SyntaxError(`Non-${s} character`);v=v<<r|O,f+=r,f>=8&&(f-=8,p[w++]=255&v>>f)}if(f>=r||255&v<<8-f)throw new SyntaxError("Unexpected end of data");return p},i6=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let l="",p=0,f=0;for(let v=0;v<n.length;++v)for(f=f<<8|n[v],p+=8;p>r;)p-=r,l+=t[a&f>>p];if(p&&(l+=t[a&f<<r-p]),s)for(;l.length*r&7;)l+="=";return l},Lt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Ws({prefix:t,name:n,encode(a){return i6(a,s,r)},decode(a){return r6(a,s,r,n)}}),n6=Ws({prefix:"\0",name:"identity",encode:n=>Q3(n),decode:n=>J3(n)});var s6=Object.freeze({__proto__:null,identity:n6});const o6=Lt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var a6=Object.freeze({__proto__:null,base2:o6});const c6=Lt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var u6=Object.freeze({__proto__:null,base8:c6});const h6=$n({prefix:"9",name:"base10",alphabet:"0123456789"});var l6=Object.freeze({__proto__:null,base10:h6});const f6=Lt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),d6=Lt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var p6=Object.freeze({__proto__:null,base16:f6,base16upper:d6});const g6=Lt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),v6=Lt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),y6=Lt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),b6=Lt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_6=Lt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),m6=Lt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),w6=Lt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),E6=Lt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),D6=Lt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var S6=Object.freeze({__proto__:null,base32:g6,base32upper:v6,base32pad:y6,base32padupper:b6,base32hex:_6,base32hexupper:m6,base32hexpad:w6,base32hexpadupper:E6,base32z:D6});const x6=$n({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),I6=$n({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var O6=Object.freeze({__proto__:null,base36:x6,base36upper:I6});const P6=$n({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),C6=$n({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var A6=Object.freeze({__proto__:null,base58btc:P6,base58flickr:C6});const N6=Lt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),T6=Lt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),R6=Lt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),F6=Lt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var U6=Object.freeze({__proto__:null,base64:N6,base64pad:T6,base64url:R6,base64urlpad:F6});const ad=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),L6=ad.reduce((n,t,r)=>(n[r]=t,n),[]),$6=ad.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function M6(n){return n.reduce((t,r)=>(t+=L6[r],t),"")}function j6(n){const t=[];for(const r of n){const s=$6[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const q6=Ws({prefix:"\u{1F680}",name:"base256emoji",encode:M6,decode:j6});var z6=Object.freeze({__proto__:null,base256emoji:q6}),B6=cd,$l=128,k6=127,H6=~k6,K6=Math.pow(2,31);function cd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=K6;)t[r++]=n&255|$l,n/=128;for(;n&H6;)t[r++]=n&255|$l,n>>>=7;return t[r]=n|0,cd.bytes=r-s+1,t}var V6=ja,W6=128,Ml=127;function ja(n,s){var r=0,s=s||0,a=0,l=s,p,f=n.length;do{if(l>=f)throw ja.bytes=0,new RangeError("Could not decode varint");p=n[l++],r+=a<28?(p&Ml)<<a:(p&Ml)*Math.pow(2,a),a+=7}while(p>=W6);return ja.bytes=l-s,r}var G6=Math.pow(2,7),Y6=Math.pow(2,14),J6=Math.pow(2,21),Q6=Math.pow(2,28),X6=Math.pow(2,35),Z6=Math.pow(2,42),e2=Math.pow(2,49),t2=Math.pow(2,56),r2=Math.pow(2,63),i2=function(n){return n<G6?1:n<Y6?2:n<J6?3:n<Q6?4:n<X6?5:n<Z6?6:n<e2?7:n<t2?8:n<r2?9:10},n2={encode:B6,decode:V6,encodingLength:i2},ud=n2;const jl=(n,t,r=0)=>(ud.encode(n,t,r),t),ql=n=>ud.encodingLength(n),qa=(n,t)=>{const r=t.byteLength,s=ql(n),a=s+ql(r),l=new Uint8Array(a+r);return jl(n,l,0),jl(r,l,s),l.set(t,a),new s2(n,r,t,l)};class s2{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const hd=({name:n,code:t,encode:r})=>new o2(n,t,r);class o2{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?qa(this.code,r):r.then(s=>qa(this.code,s))}else throw Error("Unknown type, must be binary type")}}const ld=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),a2=hd({name:"sha2-256",code:18,encode:ld("SHA-256")}),c2=hd({name:"sha2-512",code:19,encode:ld("SHA-512")});var u2=Object.freeze({__proto__:null,sha256:a2,sha512:c2});const fd=0,h2="identity",dd=sd,l2=n=>qa(fd,dd(n)),f2={code:fd,name:h2,encode:dd,digest:l2};var d2=Object.freeze({__proto__:null,identity:f2});new TextEncoder,new TextDecoder;const zl={...s6,...a6,...u6,...l6,...p6,...S6,...O6,...A6,...U6,...z6};({...u2,...d2});function pd(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function p2(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?pd(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function gd(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Bl=gd("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),_a=gd("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=p2(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),g2={utf8:Bl,"utf-8":Bl,hex:zl.base16,latin1:_a,ascii:_a,binary:_a,...zl};function v2(n,t="utf8"){const r=g2[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?pd(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const vd="wc",y2=2,oc="core",ni=`${vd}@2:${oc}:`,b2={name:oc,logger:"error"},_2={database:":memory:"},m2="crypto",kl="client_ed25519_seed",w2=fe.ONE_DAY,E2="keychain",D2="0.3",S2="messages",x2="0.3",I2=fe.SIX_HOURS,O2="publisher",yd="irn",P2="error",bd="wss://relay.walletconnect.com",Hl="wss://relay.walletconnect.org",C2="relayer",qt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},A2="_subscription",kr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},N2=fe.ONE_SECOND,T2="2.10.0",R2=1e4,F2="0.3",U2="WALLETCONNECT_CLIENT_ID",Rr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},L2="subscription",$2="0.3",M2=fe.FIVE_SECONDS*1e3,j2="pairing",q2="0.3",Dn={wc_pairingDelete:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:fe.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:fe.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:fe.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:0},res:{ttl:fe.ONE_DAY,prompt:!1,tag:0}}},Tr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},z2="history",B2="0.3",k2="expirer",br={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},H2="0.3",ma="verify-api",Ts="https://verify.walletconnect.com",Kl="https://verify.walletconnect.org";class K2{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=E2,this.version=D2,this.initialized=!1,this.storagePrefix=ni,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:l}=se("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(l)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=He.generateChildLogger(r,this.name)}get context(){return He.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Zf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?ed(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class V2{constructor(t,r,s){this.core=t,this.logger=r,this.name=m2,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),l=gl(a);return qf(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=AE();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const l=await this.getClientSeed(),p=gl(l),f=$a();return await kw(f,a,w2,p)},this.generateSharedKey=(a,l,p)=>{this.isInitialized();const f=this.getPrivateKey(a),v=NE(f,l);return this.setSymKey(v,p)},this.setSymKey=async(a,l)=>{this.isInitialized();const p=l||TE(a);return await this.keychain.set(p,a),p},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,l,p)=>{this.isInitialized();const f=Xf(p),v=ka(l);if(Sl(f)){const L=f.senderPublicKey,F=f.receiverPublicKey;a=await this.generateSharedKey(L,F)}const w=this.getSymKey(a),{type:D,senderPublicKey:O}=f;return FE({type:D,symKey:w,message:v,senderPublicKey:O})},this.decode=async(a,l,p)=>{this.isInitialized();const f=$E(l,p);if(Sl(f)){const v=f.receiverPublicKey,w=f.senderPublicKey;a=await this.generateSharedKey(v,w)}try{const v=this.getSymKey(a),w=UE({symKey:v,encoded:l});return df(w)}catch(v){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(v)}},this.getPayloadType=a=>{const l=$s(a);return Fn(l.type)},this.getPayloadSenderPublicKey=a=>{const l=$s(a);return l.senderPublicKey?Wt(l.senderPublicKey,Vt):void 0},this.core=t,this.logger=He.generateChildLogger(r,this.name),this.keychain=s||new K2(this.core,this.logger)}get context(){return He.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(kl)}catch{t=$a(),await this.keychain.set(kl,t)}return v2(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class W2 extends I_{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=S2,this.version=x2,this.initialized=!1,this.storagePrefix=ni,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const l=Wi(a);let p=this.messages.get(s);return typeof p>"u"&&(p={}),typeof p[l]<"u"||(p[l]=a,this.messages.set(s,p),await this.persist()),l},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const l=this.get(s),p=Wi(a);return typeof l[p]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=He.generateChildLogger(t,this.name),this.core=r}get context(){return He.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Zf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?ed(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class G2 extends O_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new mr.exports.EventEmitter,this.name=O2,this.queue=new Map,this.publishTimeout=fe.toMiliseconds(fe.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,l)=>{var p;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}});try{const f=(l==null?void 0:l.ttl)||I2,v=Ma(l),w=(l==null?void 0:l.prompt)||!1,D=(l==null?void 0:l.tag)||0,O=(l==null?void 0:l.id)||Qb().toString(),L={topic:s,message:a,opts:{ttl:f,relay:v,prompt:w,tag:D,id:O}},F=setTimeout(()=>this.queue.set(O,L),this.publishTimeout);try{await await An(this.rpcPublish(s,a,f,v,w,D,O),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(O),this.relayer.events.emit(qt.publish,L)}catch(U){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(p=l==null?void 0:l.internal)!=null&&p.throwOnFailedPublish)throw this.removeRequestFromQueue(O),U;return}finally{clearTimeout(F)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=He.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return He.getLoggerContext(this.logger)}rpcPublish(t,r,s,a,l,p,f){var v,w,D,O;const L={method:As(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:l,tag:p},id:f};return Kt((v=L.params)==null?void 0:v.prompt)&&((w=L.params)==null||delete w.prompt),Kt((D=L.params)==null?void 0:D.tag)&&((O=L.params)==null||delete O.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:L}),this.relayer.request(L)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Yi.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(qt.connection_stalled);return}this.checkQueue()}),this.relayer.on(qt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class Y2{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(l=>l!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var J2=Object.defineProperty,Q2=Object.defineProperties,X2=Object.getOwnPropertyDescriptors,Vl=Object.getOwnPropertySymbols,Z2=Object.prototype.hasOwnProperty,eD=Object.prototype.propertyIsEnumerable,Wl=(n,t,r)=>t in n?J2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Sn=(n,t)=>{for(var r in t||(t={}))Z2.call(t,r)&&Wl(n,r,t[r]);if(Vl)for(var r of Vl(t))eD.call(t,r)&&Wl(n,r,t[r]);return n},wa=(n,t)=>Q2(n,X2(t));class tD extends A_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new Y2,this.events=new mr.exports.EventEmitter,this.name=L2,this.version=$2,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=ni,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const l=Ma(a),p={topic:s,relay:l};this.pending.set(s,p);const f=await this.rpcSubscribe(s,l);return this.onSubscribe(f,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),f}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,l)=>{const p=new fe.Watch;p.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),a(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=M2&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=He.generateChildLogger(r,this.name),this.clientId=""}get context(){return He.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=Ma(s);await this.rpcUnsubscribe(t,r,a);const l=pt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:As(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await An(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(qt.connection_stalled)}return Wi(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:As(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await An(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(qt.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:As(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,wa(Sn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Sn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Sn({},r)),this.topicMap.set(r.topic,t),this.events.emit(Rr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(Rr.deleted,wa(Sn({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Rr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Rr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);Di(r)&&this.onBatchSubscribe(r.map((s,a)=>wa(Sn({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Yi.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(qt.connect,async()=>{await this.onConnect()}),this.relayer.on(qt.disconnect,()=>{this.onDisconnect()}),this.events.on(Rr.created,async t=>{const r=Rr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Rr.deleted,async t=>{const r=Rr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var rD=Object.defineProperty,Gl=Object.getOwnPropertySymbols,iD=Object.prototype.hasOwnProperty,nD=Object.prototype.propertyIsEnumerable,Yl=(n,t,r)=>t in n?rD(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,sD=(n,t)=>{for(var r in t||(t={}))iD.call(t,r)&&Yl(n,r,t[r]);if(Gl)for(var r of Gl(t))nD.call(t,r)&&Yl(n,r,t[r]);return n};class oD extends P_{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new mr.exports.EventEmitter,this.name=C2,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(qt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(qt.error,r)},this.registerProviderListeners=()=>{this.provider.on(kr.payload,this.onPayloadHandler),this.provider.on(kr.connect,this.onConnectHandler),this.provider.on(kr.disconnect,this.onDisconnectHandler),this.provider.on(kr.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?He.generateChildLogger(t.logger,this.name):He.pino(He.getDefaultLoggerOptions({level:t.logger||P2})),this.messages=new W2(this.logger,t.core),this.subscriber=new tD(this,this.logger),this.publisher=new G2(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||bd,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Hl}...`),await this.restartTransport(Hl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},R2)}get context(){return He.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";return a||(await Promise.all([new Promise(l=>{this.subscriber.once(Rr.created,p=>{p.topic===t&&l()})}),new Promise(async l=>{a=await this.subscriber.subscribe(t,r),l()})]),a)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await An(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Rr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await An(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(kr.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Fl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new si(new V3(GE({sdkVersion:T2,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Ka(t)){if(!t.method.endsWith(A2))return;const r=t.params,{topic:s,message:a,publishedAt:l}=r.data,p={topic:s,message:a,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(sD({type:"event",event:r.id},p)),this.events.emit(r.id,p),await this.acknowledgePayload(t),await this.onMessageEvent(p)}else Va(t)&&this.events.emit(qt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(qt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Wa(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(kr.payload,this.onPayloadHandler),this.provider.off(kr.connect,this.onConnectHandler),this.provider.off(kr.disconnect,this.onDisconnectHandler),this.provider.off(kr.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(qt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Fl();q3(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(qt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},fe.toMiliseconds(N2)))}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var aD=Object.defineProperty,Jl=Object.getOwnPropertySymbols,cD=Object.prototype.hasOwnProperty,uD=Object.prototype.propertyIsEnumerable,Ql=(n,t,r)=>t in n?aD(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Xl=(n,t)=>{for(var r in t||(t={}))cD.call(t,r)&&Ql(n,r,t[r]);if(Jl)for(var r of Jl(t))uD.call(t,r)&&Ql(n,r,t[r]);return n};class Gs extends C_{constructor(t,r,s,a=ni,l=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=F2,this.cached=[],this.initialized=!1,this.storagePrefix=ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!Kt(p)?this.map.set(this.getKey(p),p):y3(p)?this.map.set(p.id,p):b3(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,f)=>{this.isInitialized(),this.map.has(p)?await this.update(p,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:f}),this.map.set(p,f),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(f=>Object.keys(p).every(v=>Hb(f[v],p[v]))):this.values),this.update=async(p,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:f});const v=Xl(Xl({},this.getData(p)),f);this.map.set(p,v),await this.persist()},this.delete=async(p,f)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:f}),this.map.delete(p),await this.persist())},this.logger=He.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=l}get context(){return He.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class hD{constructor(t,r){this.core=t,this.logger=r,this.name=j2,this.version=q2,this.events=new mr.exports,this.initialized=!1,this.storagePrefix=ni,this.ignoredPayloadTypes=[Oi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=$a(),a=await this.core.crypto.setSymKey(s),l=Ir(fe.FIVE_MINUTES),p={protocol:yd},f={topic:a,expiry:l,relay:p,active:!1},v=a3({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:p});return await this.pairings.set(a,f),await this.core.relayer.subscribe(a),this.core.expirer.set(a,l),{topic:a,uri:v}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:l,relay:p}=n3(s.uri);if(this.pairings.keys.includes(a))throw new Error(`Pairing already exists: ${a}`);if(this.core.crypto.hasKeys(a))throw new Error(`Keychain already exists: ${a}`);const f=Ir(fe.FIVE_MINUTES),v={topic:a,relay:p,expiry:f,active:!1};return await this.pairings.set(a,v),await this.core.crypto.setSymKey(l,a),await this.core.relayer.subscribe(a,{relay:p}),this.core.expirer.set(a,f),s.activatePairing&&await this.activate({topic:a}),v},this.activate=async({topic:s})=>{this.isInitialized();const a=Ir(fe.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const l=await this.sendRequest(a,"wc_pairingPing",{}),{done:p,resolve:f,reject:v}=Vi();this.events.once(dt("pairing_ping",l),({error:w})=>{w?v(w):f()}),await p()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",pt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,l)=>{const p=Rs(a,l),f=await this.core.crypto.encode(s,p),v=Dn[a].req;return this.core.history.set(s,p),this.core.relayer.publish(s,f,v),p.id},this.sendResult=async(s,a,l)=>{const p=Wa(s,l),f=await this.core.crypto.encode(a,p),v=await this.core.history.get(a,s),w=Dn[v.request.method].res;await this.core.relayer.publish(a,f,w),await this.core.history.resolve(p)},this.sendError=async(s,a,l)=>{const p=Ha(s,l),f=await this.core.crypto.encode(a,p),v=await this.core.history.get(a,s),w=Dn[v.request.method]?Dn[v.request.method].res:Dn.unregistered_method.res;await this.core.relayer.publish(a,f,w),await this.core.history.resolve(p)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,pt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>ii(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:l}=s;switch(l.method){case"wc_pairingPing":return this.onPairingPingRequest(a,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,l);default:return this.onUnknownRpcMethodRequest(a,l)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:l}=s,p=(await this.core.history.get(a,l.id)).request.method;switch(p){case"wc_pairingPing":return this.onPairingPingResponse(a,l);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(s,a)=>{const{id:l}=a;try{this.isValidPing({topic:s}),await this.sendResult(l,s,!0),this.events.emit("pairing_ping",{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onPairingPingResponse=(s,a)=>{const{id:l}=a;setTimeout(()=>{ri(a)?this.events.emit(dt("pairing_ping",l),{}):Kr(a)&&this.events.emit(dt("pairing_ping",l),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:l}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:l,method:p}=a;try{if(this.registeredMethods.includes(p))return;const f=pt("WC_METHOD_UNSUPPORTED",p);await this.sendError(l,s,f),this.logger.error(f)}catch(f){await this.sendError(l,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(pt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!Zt(s)){const{message:a}=se("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(a)}if(!v3(s.uri)){const{message:a}=se("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(a)}},this.isValidPing=async s=>{if(!Zt(s)){const{message:l}=se("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!Zt(s)){const{message:l}=se("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Tt(s,!1)){const{message:a}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(ii(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=se("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=He.generateChildLogger(r,this.name),this.pairings=new Gs(this.core,this.logger,this.name,this.storagePrefix)}get context(){return He.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(qt.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{Ka(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Va(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(l){this.logger.error(l)}})}registerExpirerEvents(){this.core.expirer.on(br.expired,async t=>{const{topic:r}=rd(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class lD extends x_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new mr.exports.EventEmitter,this.name=z2,this.version=B2,this.cached=[],this.initialized=!1,this.storagePrefix=ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:l}),this.records.has(a.id))return;const p={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:l,expiry:Ir(fe.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(Tr.created,p)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Kr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Tr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(l=>{if(l.topic===s){if(typeof a<"u"&&l.id!==a)return;this.records.delete(l.id),this.events.emit(Tr.deleted,l)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=He.generateChildLogger(r,this.name)}get context(){return He.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Rs(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Tr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Tr.created,t=>{const r=Tr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Tr.updated,t=>{const r=Tr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Tr.deleted,t=>{const r=Tr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Yi.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{fe.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class fD extends N_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new mr.exports.EventEmitter,this.name=k2,this.version=H2,this.cached=[],this.initialized=!1,this.storagePrefix=ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const l=this.formatTarget(s),p={target:l,expiry:a};this.expirations.set(l,p),this.checkExpiry(l,p),this.events.emit(br.created,{target:l,expiration:p})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),l=this.getExpiration(a);this.expirations.delete(a),this.events.emit(br.deleted,{target:a,expiration:l})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=He.generateChildLogger(r,this.name)}get context(){return He.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return YE(t);if(typeof t=="number")return JE(t);const{message:r}=se("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(br.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;fe.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(br.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Yi.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(br.created,t=>{const r=br.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(br.expired,t=>{const r=br.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(br.deleted,t=>{const r=br.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class dD extends T_{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=ma,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Vs()||!Un())return;const a=(s==null?void 0:s.verifyUrl)||Ts;this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(l){this.logger.warn(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.warn(l)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Kl;try{await this.createIframe()}catch(l){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(l),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=(s==null?void 0:s.verifyUrl)||Ts;let l="";try{l=await this.fetchAttestation(s.attestationId,a)}catch(p){this.logger.warn(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.warn(p),l=await this.fetchAttestation(s.attestationId,Kl)}return l},this.fetchAttestation=async(s,a)=>{var l;this.logger.info(`resolving attestation: ${s} from url: ${a}`);const p=this.startAbortTimer(fe.ONE_SECOND*2),f=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(p),f.status===200?(l=await f.json())==null?void 0:l.origin:""},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=l=>{l.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(l=>{if(document.getElementById(ma))return l();window.addEventListener("message",a);const p=document.createElement("iframe");p.id=ma,p.src=`${this.verifyUrl}/${this.projectId}`,p.style.display="none",document.body.append(p),this.iframe=p,s=l}),new Promise((l,p)=>setTimeout(()=>{window.removeEventListener("message",a),p("verify iframe load timeout")},fe.toMiliseconds(fe.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=He.generateChildLogger(r,this.name),this.verifyUrl=Ts,this.abortController=new AbortController,this.isDevEnv=ic()&&{}.IS_VITEST}get context(){return He.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),fe.toMiliseconds(t))}}var pD=Object.defineProperty,Zl=Object.getOwnPropertySymbols,gD=Object.prototype.hasOwnProperty,vD=Object.prototype.propertyIsEnumerable,ef=(n,t,r)=>t in n?pD(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,tf=(n,t)=>{for(var r in t||(t={}))gD.call(t,r)&&ef(n,r,t[r]);if(Zl)for(var r of Zl(t))vD.call(t,r)&&ef(n,r,t[r]);return n};class ac extends S_{constructor(t){super(t),this.protocol=vd,this.version=y2,this.name=oc,this.events=new mr.exports.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||bd;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:He.pino(He.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||b2.logger}));this.logger=He.generateChildLogger(r,this.name),this.heartbeat=new Yi.HeartBeat,this.crypto=new V2(this,this.logger,t==null?void 0:t.keychain),this.history=new lD(this,this.logger),this.expirer=new fD(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new a_(tf(tf({},_2),t==null?void 0:t.storageOptions)),this.relayer=new oD({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new hD(this,this.logger),this.verify=new dD(this.projectId||"",this.logger)}static async init(t){const r=new ac(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(U2,s),r}get context(){return He.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const yD=ac,_d="wc",md=2,wd="client",cc=`${_d}@${md}:${wd}:`,Ea={name:wd,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},rf="WALLETCONNECT_DEEPLINK_CHOICE",bD="proposal",Ed="Proposal expired",_D="session",Os=fe.SEVEN_DAYS,mD="engine",xn={wc_sessionPropose:{req:{ttl:fe.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:fe.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:fe.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:fe.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:1104},res:{ttl:fe.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:1106},res:{ttl:fe.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:fe.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:fe.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:fe.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:fe.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:1112},res:{ttl:fe.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:fe.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:fe.THIRTY_SECONDS,prompt:!1,tag:1115}}},Da={min:fe.FIVE_MINUTES,max:fe.SEVEN_DAYS},Hr={idle:"IDLE",active:"ACTIVE"},wD="request",ED=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var DD=Object.defineProperty,SD=Object.defineProperties,xD=Object.getOwnPropertyDescriptors,nf=Object.getOwnPropertySymbols,ID=Object.prototype.hasOwnProperty,OD=Object.prototype.propertyIsEnumerable,sf=(n,t,r)=>t in n?DD(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Xt=(n,t)=>{for(var r in t||(t={}))ID.call(t,r)&&sf(n,r,t[r]);if(nf)for(var r of nf(t))OD.call(t,r)&&sf(n,r,t[r]);return n},In=(n,t)=>SD(n,xD(t));class PD extends F_{constructor(t){super(t),this.name=mD,this.events=new mr.exports,this.initialized=!1,this.ignoredPayloadTypes=[Oi],this.requestQueue={state:Hr.idle,queue:[]},this.sessionRequestQueue={state:Hr.idle,queue:[]},this.requestQueueDelay=fe.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(xn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},fe.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=In(Xt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:l,optionalNamespaces:p,sessionProperties:f,relays:v}=s;let w=a,D,O=!1;if(w&&(O=this.client.core.pairing.pairings.get(w).active),!w||!O){const{topic:T,uri:E}=await this.client.core.pairing.create();w=T,D=E}const L=await this.client.core.crypto.generateKeyPair(),F=Xt({requiredNamespaces:l,optionalNamespaces:p,relays:v!=null?v:[{protocol:yd}],proposer:{publicKey:L,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:U,resolve:z,done:B}=Vi(fe.FIVE_MINUTES,Ed);if(this.events.once(dt("session_connect"),async({error:T,session:E})=>{if(T)U(T);else if(E){E.self.publicKey=L;const x=In(Xt({},E),{requiredNamespaces:E.requiredNamespaces,optionalNamespaces:E.optionalNamespaces});await this.client.session.set(E.topic,x),await this.setExpiry(E.topic,E.expiry),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:E.peer.metadata}),z(x)}}),!w){const{message:T}=se("NO_MATCHING_KEY",`connect() pairing topic: ${w}`);throw new Error(T)}const ee=await this.sendRequest({topic:w,method:"wc_sessionPropose",params:F}),P=Ir(fe.FIVE_MINUTES);return await this.setProposal(ee,Xt({id:ee,expiry:P},F)),{uri:D,approval:B}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:l,sessionProperties:p}=r,f=this.client.proposal.get(s);let{pairingTopic:v,proposer:w,requiredNamespaces:D,optionalNamespaces:O}=f;v=v||"",Gi(D)||(D=l3(l,"approve()"));const L=await this.client.core.crypto.generateKeyPair(),F=w.publicKey,U=await this.client.core.crypto.generateSharedKey(L,F);v&&s&&(await this.client.core.pairing.updateMetadata({topic:v,metadata:w.metadata}),await this.sendResult({id:s,topic:v,result:{relay:{protocol:a!=null?a:"irn"},responderPublicKey:L}}),await this.client.proposal.delete(s,pt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:v}));const z=Xt({relay:{protocol:a!=null?a:"irn"},namespaces:l,requiredNamespaces:D,optionalNamespaces:O,pairingTopic:v,controller:{publicKey:L,metadata:this.client.metadata},expiry:Ir(Os)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(U),await this.sendRequest({topic:U,method:"wc_sessionSettle",params:z,throwOnFailedPublish:!0});const B=In(Xt({},z),{topic:U,pairingTopic:v,acknowledged:!1,self:z.controller,peer:{publicKey:w.publicKey,metadata:w.metadata},controller:L});return await this.client.session.set(U,B),await this.setExpiry(U,Ir(Os)),{topic:U,acknowledged:()=>new Promise(ee=>setTimeout(()=>ee(this.client.session.get(U)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:l}=this.client.proposal.get(s);l&&(await this.sendError(s,l,a),await this.client.proposal.delete(s,pt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,l=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:p,resolve:f,reject:v}=Vi();return this.events.once(dt("session_update",l),({error:w})=>{w?v(w):f()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:p}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:l,resolve:p,reject:f}=Vi();return this.events.once(dt("session_extend",a),({error:v})=>{v?f(v):p()}),await this.setExpiry(s,Ir(Os)),{acknowledged:l}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:l,expiry:p}=r,f=Xb(),{done:v,resolve:w,reject:D}=Vi(p);return this.events.once(dt("session_request",f),({error:O,result:L})=>{O?D(O):w(L)}),await Promise.all([new Promise(async O=>{await this.sendRequest({clientRpcId:f,topic:l,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:p,throwOnFailedPublish:!0}).catch(L=>D(L)),this.client.events.emit("session_request_sent",{topic:l,request:a,chainId:s,id:f}),O()}),new Promise(async O=>{const L=await this.client.core.storage.getItem(rf);QE({id:f,topic:l,wcDeepLink:L}),O()}),v()]).then(O=>O[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:l}=a;ri(a)?await this.sendResult({id:l,topic:s,result:a.result,throwOnFailedPublish:!0}):Kr(a)&&await this.sendError(l,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:l,resolve:p,reject:f}=Vi();this.events.once(dt("session_ping",a),({error:v})=>{v?f(v):p()}),await l()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:l}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:l}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:pt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>p3(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(l=>{var p,f;return((p=l.peerMetadata)==null?void 0:p.url)&&((f=l.peerMetadata)==null?void 0:f.url)===r.peer.metadata.url&&l.topic&&l.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,pt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(rf).catch(l=>this.client.logger.warn(l))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,pt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(l=>l.id!==r),a&&(this.sessionRequestQueue.state=Hr.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=xn.wc_sessionRequest.req.ttl,{id:a,topic:l,params:p}=r;await this.client.pendingRequest.set(a,{id:a,topic:l,params:p}),s&&this.client.core.expirer.set(a,Ir(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:l,expiry:p,relayRpcId:f,clientRpcId:v,throwOnFailedPublish:w}=r,D=Rs(a,l,v);if(Un()&&ED.includes(a)){const F=Wi(JSON.stringify(D));this.client.core.verify.register({attestationId:F})}const O=await this.client.core.crypto.encode(s,D),L=xn[a].req;return p&&(L.ttl=p),f&&(L.id=f),this.client.core.history.set(s,D),w?(L.internal=In(Xt({},L.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,O,L)):this.client.core.relayer.publish(s,O,L).catch(F=>this.client.logger.error(F)),D.id},this.sendResult=async r=>{const{id:s,topic:a,result:l,throwOnFailedPublish:p}=r,f=Wa(s,l),v=await this.client.core.crypto.encode(a,f),w=await this.client.core.history.get(a,s),D=xn[w.request.method].res;p?(D.internal=In(Xt({},D.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,v,D)):this.client.core.relayer.publish(a,v,D).catch(O=>this.client.logger.error(O)),await this.client.core.history.resolve(f)},this.sendError=async(r,s,a)=>{const l=Ha(r,a),p=await this.client.core.crypto.encode(s,l),f=await this.client.core.history.get(s,r),v=xn[f.request.method].res;this.client.core.relayer.publish(s,p,v),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{ii(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{ii(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Hr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Hr.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=Hr.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,l=a.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,l=(await this.client.core.history.get(s,a.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=se("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:l}=s;try{this.isValidConnect(Xt({},s.params));const p=Ir(fe.FIVE_MINUTES),f=Xt({id:l,pairingTopic:r,expiry:p},a);await this.setProposal(l,f);const v=Wi(JSON.stringify(s)),w=await this.getVerifyContext(v,f.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:f,verifyContext:w})}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(ri(s)){const{result:l}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const p=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const f=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const v=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});const w=await this.client.core.crypto.generateSharedKey(f,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:w});const D=await this.client.core.relayer.subscribe(w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:D}),await this.client.core.pairing.activate({topic:r})}else Kr(s)&&(await this.client.proposal.delete(a,pt("USER_DISCONNECTED")),this.events.emit(dt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidSessionSettleRequest(l);const{relay:p,controller:f,expiry:v,namespaces:w,requiredNamespaces:D,optionalNamespaces:O,sessionProperties:L,pairingTopic:F}=s.params,U=Xt({topic:r,relay:p,expiry:v,namespaces:w,acknowledged:!0,pairingTopic:F,requiredNamespaces:D,optionalNamespaces:O,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},L&&{sessionProperties:L});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(dt("session_connect"),{session:U}),this.cleanupDuplicatePairings(U)}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;ri(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(dt("session_approve",a),{})):Kr(s)&&(await this.client.session.delete(r,pt("USER_DISCONNECTED")),this.events.emit(dt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:l}=s;try{const p=`${r}_session_update`,f=Is.get(p);if(f&&this.isRequestOutOfSync(f,l)){this.client.logger.info(`Discarding out of sync request - ${l}`);return}this.isValidUpdate(Xt({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:l,topic:r,result:!0}),this.client.events.emit("session_update",{id:l,topic:r,params:a}),Is.set(p,l)}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;ri(s)?this.events.emit(dt("session_update",a),{}):Kr(s)&&this.events.emit(dt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Ir(Os)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;ri(s)?this.events.emit(dt("session_extend",a),{}):Kr(s)&&this.events.emit(dt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{ri(s)?this.events.emit(dt("session_ping",a),{}):Kr(s)&&this.events.emit(dt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(qt.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidRequest(Xt({topic:r},l)),await this.setPendingSessionRequest({id:a,topic:r,params:l}),this.addSessionRequestToSessionRequestQueue({id:a,topic:r,params:l}),await this.processSessionRequestQueue()}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;ri(s)?this.events.emit(dt("session_request",a),{result:s.result}):Kr(s)&&this.events.emit(dt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:l}=s;try{const p=`${r}_session_event_${l.event.name}`,f=Is.get(p);if(f&&this.isRequestOutOfSync(f,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(Xt({topic:r},l)),this.client.events.emit("session_event",{id:a,topic:r,params:l}),Is.set(p,a)}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Hr.idle,this.processSessionRequestQueue()},fe.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=async()=>{if(this.sessionRequestQueue.state===Hr.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{const{id:s,topic:a,params:l}=r,p=Wi(JSON.stringify(Rs("wc_sessionRequest",l,s))),f=this.client.session.get(a),v=await this.getVerifyContext(p,f.peer.metadata);this.sessionRequestQueue.state=Hr.active,this.client.events.emit("session_request",{id:s,topic:a,params:l,verifyContext:v})}catch(s){this.client.logger.error(s)}},this.isValidConnect=async r=>{if(!Zt(r)){const{message:v}=se("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(v)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:l,sessionProperties:p,relays:f}=r;if(Kt(s)||await this.isValidPairingTopic(s),!I3(f,!0)){const{message:v}=se("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(v)}!Kt(a)&&Gi(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!Kt(l)&&Gi(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),Kt(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=x3(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!Zt(r))throw new Error(se("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:l,sessionProperties:p}=r;await this.isValidProposalId(s);const f=this.client.proposal.get(s),v=Ns(a,"approve()");if(v)throw new Error(v.message);const w=Tl(f.requiredNamespaces,a,"approve()");if(w)throw new Error(w.message);if(!Tt(l,!0)){const{message:D}=se("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(D)}Kt(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async r=>{if(!Zt(r)){const{message:l}=se("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!P3(a)){const{message:l}=se("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!Zt(r)){const{message:w}=se("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(w)}const{relay:s,controller:a,namespaces:l,expiry:p}=r;if(!nd(s)){const{message:w}=se("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(w)}const f=_3(a,"onSessionSettleRequest()");if(f)throw new Error(f.message);const v=Ns(l,"onSessionSettleRequest()");if(v)throw new Error(v.message);if(ii(p)){const{message:w}=se("EXPIRED","onSessionSettleRequest()");throw new Error(w)}},this.isValidUpdate=async r=>{if(!Zt(r)){const{message:v}=se("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(v)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const l=this.client.session.get(s),p=Ns(a,"update()");if(p)throw new Error(p.message);const f=Tl(l.requiredNamespaces,a,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async r=>{if(!Zt(r)){const{message:a}=se("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!Zt(r)){const{message:v}=se("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(v)}const{topic:s,request:a,chainId:l,expiry:p}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Nl(f,l)){const{message:v}=se("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(v)}if(!C3(a)){const{message:v}=se("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(v)}if(!T3(f,l,a.method)){const{message:v}=se("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(v)}if(p&&!L3(p,Da)){const{message:v}=se("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${Da.min} and ${Da.max}`);throw new Error(v)}},this.isValidRespond=async r=>{if(!Zt(r)){const{message:l}=se("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!A3(a)){const{message:l}=se("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!Zt(r)){const{message:a}=se("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!Zt(r)){const{message:f}=se("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(f)}const{topic:s,event:a,chainId:l}=r;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!Nl(p,l)){const{message:f}=se("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(f)}if(!N3(a)){const{message:f}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}if(!R3(p,l,a.name)){const{message:f}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}},this.isValidDisconnect=async r=>{if(!Zt(r)){const{message:a}=se("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||Ts,validation:"UNKNOWN",origin:s.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});l&&(a.verified.origin=l,a.verified.validation=l===new URL(s.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.error(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!Tt(a,!1)){const{message:l}=se("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(l)}})}}async isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(qt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{Ka(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Va(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(l){this.client.logger.error(l)}})}registerExpirerEvents(){this.client.core.expirer.on(br.expired,async t=>{const{topic:r,id:s}=rd(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,se("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(t){if(!Tt(t,!1)){const{message:r}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(ii(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=se("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Tt(t,!1)){const{message:r}=se("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=se("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(ii(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=se("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Tt(t,!1)){const{message:r}=se("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=se("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!O3(t)){const{message:r}=se("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=se("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(ii(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=se("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class CD extends Gs{constructor(t,r){super(t,r,bD,cc),this.core=t,this.logger=r}}class AD extends Gs{constructor(t,r){super(t,r,_D,cc),this.core=t,this.logger=r}}class ND extends Gs{constructor(t,r){super(t,r,wD,cc,s=>s.id),this.core=t,this.logger=r}}class uc extends R_{constructor(t){super(t),this.protocol=_d,this.version=md,this.name=Ea.name,this.events=new mr.exports.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Ea.name,this.metadata=(t==null?void 0:t.metadata)||HE();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:He.pino(He.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Ea.logger}));this.core=(t==null?void 0:t.core)||new yD(t),this.logger=He.generateChildLogger(r,this.name),this.session=new AD(this.core,this.logger),this.proposal=new CD(this.core,this.logger),this.pendingRequest=new ND(this.core,this.logger),this.engine=new PD(this)}static async init(t){const r=new uc(t);return await r.initialize(),r}get context(){return He.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}const of="error",TD="wss://relay.walletconnect.com",RD="wc",FD="universal_provider",af=`${RD}@2:${FD}:`,UD="https://rpc.walletconnect.com/v1",ai={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var On=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},za={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",f="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",w=500,D="__lodash_placeholder__",O=1,L=2,F=4,U=1,z=2,B=1,ee=2,P=4,T=8,E=16,x=32,_=64,c=128,b=256,H=512,K=30,ie="...",oe=800,he=16,N=1,j=2,ae=3,X=1/0,W=9007199254740991,Q=17976931348623157e292,G=0/0,Z=4294967295,we=Z-1,te=Z>>>1,ye=[["ary",c],["bind",B],["bindKey",ee],["curry",T],["curryRight",E],["flip",H],["partial",x],["partialRight",_],["rearg",b]],be="[object Arguments]",ve="[object Array]",$="[object AsyncFunction]",M="[object Boolean]",C="[object Date]",h="[object DOMException]",S="[object Error]",re="[object Function]",ce="[object GeneratorFunction]",_e="[object Map]",$e="[object Number]",ze="[object Null]",Re="[object Object]",st="[object Promise]",ot="[object Proxy]",Ue="[object RegExp]",me="[object Set]",Pe="[object String]",Ce="[object Symbol]",Le="[object Undefined]",Se="[object WeakMap]",Ae="[object WeakSet]",Ee="[object ArrayBuffer]",Ne="[object DataView]",je="[object Float32Array]",Be="[object Float64Array]",Ke="[object Int8Array]",Ve="[object Int16Array]",We="[object Int32Array]",Ge="[object Uint8Array]",Je="[object Uint8ClampedArray]",ur="[object Uint16Array]",wr="[object Uint32Array]",Vr=/\b__p \+= '';/g,ci=/\b(__p \+=) '' \+/g,Pi=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ci=/&(?:amp|lt|gt|quot|#39);/g,Zi=/[&<>"']/g,bt=RegExp(Ci.source),_t=RegExp(Zi.source),mt=/<%-([\s\S]+?)%>/g,wt=/<%([\s\S]+?)%>/g,gt=/<%=([\s\S]+?)%>/g,Et=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dt=/^\w*$/,St=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lt=/[\\^$.*+?()[\]{}|]/g,xt=RegExp(lt.source),ft=/^\s+/,It=/\s/,Ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Pt=/\{\n\/\* \[wrapped with (.+)\] \*/,Ct=/,? & /,At=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,xd=/[()=,{}\[\]\/\s]/,Id=/\\(\\)?/g,Od=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,lc=/\w*$/,Pd=/^[-+]0x[0-9a-f]+$/i,Cd=/^0b[01]+$/i,Ad=/^\[object .+?Constructor\]$/,Nd=/^0o[0-7]+$/i,Td=/^(?:0|[1-9]\d*)$/,Rd=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Mn=/($^)/,Fd=/['\n\r\u2028\u2029\\]/g,jn="\\ud800-\\udfff",Ud="\\u0300-\\u036f",Ld="\\ufe20-\\ufe2f",$d="\\u20d0-\\u20ff",fc=Ud+Ld+$d,dc="\\u2700-\\u27bf",pc="a-z\\xdf-\\xf6\\xf8-\\xff",Md="\\xac\\xb1\\xd7\\xf7",jd="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",qd="\\u2000-\\u206f",zd=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",gc="A-Z\\xc0-\\xd6\\xd8-\\xde",vc="\\ufe0e\\ufe0f",yc=Md+jd+qd+zd,Ys="['\u2019]",Bd="["+jn+"]",bc="["+yc+"]",qn="["+fc+"]",_c="\\d+",kd="["+dc+"]",mc="["+pc+"]",wc="[^"+jn+yc+_c+dc+pc+gc+"]",Js="\\ud83c[\\udffb-\\udfff]",Hd="(?:"+qn+"|"+Js+")",Ec="[^"+jn+"]",Qs="(?:\\ud83c[\\udde6-\\uddff]){2}",Xs="[\\ud800-\\udbff][\\udc00-\\udfff]",Ai="["+gc+"]",Dc="\\u200d",Sc="(?:"+mc+"|"+wc+")",Kd="(?:"+Ai+"|"+wc+")",xc="(?:"+Ys+"(?:d|ll|m|re|s|t|ve))?",Ic="(?:"+Ys+"(?:D|LL|M|RE|S|T|VE))?",Oc=Hd+"?",Pc="["+vc+"]?",Vd="(?:"+Dc+"(?:"+[Ec,Qs,Xs].join("|")+")"+Pc+Oc+")*",Wd="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Gd="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Cc=Pc+Oc+Vd,Yd="(?:"+[kd,Qs,Xs].join("|")+")"+Cc,Jd="(?:"+[Ec+qn+"?",qn,Qs,Xs,Bd].join("|")+")",Qd=RegExp(Ys,"g"),Xd=RegExp(qn,"g"),Zs=RegExp(Js+"(?="+Js+")|"+Jd+Cc,"g"),Zd=RegExp([Ai+"?"+mc+"+"+xc+"(?="+[bc,Ai,"$"].join("|")+")",Kd+"+"+Ic+"(?="+[bc,Ai+Sc,"$"].join("|")+")",Ai+"?"+Sc+"+"+xc,Ai+"+"+Ic,Gd,Wd,_c,Yd].join("|"),"g"),ep=RegExp("["+Dc+jn+fc+vc+"]"),tp=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,rp=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ip=-1,rt={};rt[je]=rt[Be]=rt[Ke]=rt[Ve]=rt[We]=rt[Ge]=rt[Je]=rt[ur]=rt[wr]=!0,rt[be]=rt[ve]=rt[Ee]=rt[M]=rt[Ne]=rt[C]=rt[S]=rt[re]=rt[_e]=rt[$e]=rt[Re]=rt[Ue]=rt[me]=rt[Pe]=rt[Se]=!1;var et={};et[be]=et[ve]=et[Ee]=et[Ne]=et[M]=et[C]=et[je]=et[Be]=et[Ke]=et[Ve]=et[We]=et[_e]=et[$e]=et[Re]=et[Ue]=et[me]=et[Pe]=et[Ce]=et[Ge]=et[Je]=et[ur]=et[wr]=!0,et[S]=et[re]=et[Se]=!1;var np={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},sp={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},op={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ap={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},cp=parseFloat,up=parseInt,Ac=typeof On=="object"&&On&&On.Object===Object&&On,hp=typeof self=="object"&&self&&self.Object===Object&&self,Rt=Ac||hp||Function("return this")(),eo=t&&!t.nodeType&&t,ui=eo&&!0&&n&&!n.nodeType&&n,Nc=ui&&ui.exports===eo,to=Nc&&Ac.process,hr=function(){try{var A=ui&&ui.require&&ui.require("util").types;return A||to&&to.binding&&to.binding("util")}catch{}}(),Tc=hr&&hr.isArrayBuffer,Rc=hr&&hr.isDate,Fc=hr&&hr.isMap,Uc=hr&&hr.isRegExp,Lc=hr&&hr.isSet,$c=hr&&hr.isTypedArray;function tr(A,k,q){switch(q.length){case 0:return A.call(k);case 1:return A.call(k,q[0]);case 2:return A.call(k,q[0],q[1]);case 3:return A.call(k,q[0],q[1],q[2])}return A.apply(k,q)}function lp(A,k,q,ue){for(var De=-1,Ye=A==null?0:A.length;++De<Ye;){var vt=A[De];k(ue,vt,q(vt),A)}return ue}function lr(A,k){for(var q=-1,ue=A==null?0:A.length;++q<ue&&k(A[q],q,A)!==!1;);return A}function fp(A,k){for(var q=A==null?0:A.length;q--&&k(A[q],q,A)!==!1;);return A}function Mc(A,k){for(var q=-1,ue=A==null?0:A.length;++q<ue;)if(!k(A[q],q,A))return!1;return!0}function Wr(A,k){for(var q=-1,ue=A==null?0:A.length,De=0,Ye=[];++q<ue;){var vt=A[q];k(vt,q,A)&&(Ye[De++]=vt)}return Ye}function zn(A,k){var q=A==null?0:A.length;return!!q&&Ni(A,k,0)>-1}function ro(A,k,q){for(var ue=-1,De=A==null?0:A.length;++ue<De;)if(q(k,A[ue]))return!0;return!1}function it(A,k){for(var q=-1,ue=A==null?0:A.length,De=Array(ue);++q<ue;)De[q]=k(A[q],q,A);return De}function Gr(A,k){for(var q=-1,ue=k.length,De=A.length;++q<ue;)A[De+q]=k[q];return A}function io(A,k,q,ue){var De=-1,Ye=A==null?0:A.length;for(ue&&Ye&&(q=A[++De]);++De<Ye;)q=k(q,A[De],De,A);return q}function dp(A,k,q,ue){var De=A==null?0:A.length;for(ue&&De&&(q=A[--De]);De--;)q=k(q,A[De],De,A);return q}function no(A,k){for(var q=-1,ue=A==null?0:A.length;++q<ue;)if(k(A[q],q,A))return!0;return!1}var pp=so("length");function gp(A){return A.split("")}function vp(A){return A.match(At)||[]}function jc(A,k,q){var ue;return q(A,function(De,Ye,vt){if(k(De,Ye,vt))return ue=Ye,!1}),ue}function Bn(A,k,q,ue){for(var De=A.length,Ye=q+(ue?1:-1);ue?Ye--:++Ye<De;)if(k(A[Ye],Ye,A))return Ye;return-1}function Ni(A,k,q){return k===k?Pp(A,k,q):Bn(A,qc,q)}function yp(A,k,q,ue){for(var De=q-1,Ye=A.length;++De<Ye;)if(ue(A[De],k))return De;return-1}function qc(A){return A!==A}function zc(A,k){var q=A==null?0:A.length;return q?ao(A,k)/q:G}function so(A){return function(k){return k==null?r:k[A]}}function oo(A){return function(k){return A==null?r:A[k]}}function Bc(A,k,q,ue,De){return De(A,function(Ye,vt,Ze){q=ue?(ue=!1,Ye):k(q,Ye,vt,Ze)}),q}function bp(A,k){var q=A.length;for(A.sort(k);q--;)A[q]=A[q].value;return A}function ao(A,k){for(var q,ue=-1,De=A.length;++ue<De;){var Ye=k(A[ue]);Ye!==r&&(q=q===r?Ye:q+Ye)}return q}function co(A,k){for(var q=-1,ue=Array(A);++q<A;)ue[q]=k(q);return ue}function _p(A,k){return it(k,function(q){return[q,A[q]]})}function kc(A){return A&&A.slice(0,Wc(A)+1).replace(ft,"")}function rr(A){return function(k){return A(k)}}function uo(A,k){return it(k,function(q){return A[q]})}function en(A,k){return A.has(k)}function Hc(A,k){for(var q=-1,ue=A.length;++q<ue&&Ni(k,A[q],0)>-1;);return q}function Kc(A,k){for(var q=A.length;q--&&Ni(k,A[q],0)>-1;);return q}function mp(A,k){for(var q=A.length,ue=0;q--;)A[q]===k&&++ue;return ue}var wp=oo(np),Ep=oo(sp);function Dp(A){return"\\"+ap[A]}function Sp(A,k){return A==null?r:A[k]}function Ti(A){return ep.test(A)}function xp(A){return tp.test(A)}function Ip(A){for(var k,q=[];!(k=A.next()).done;)q.push(k.value);return q}function ho(A){var k=-1,q=Array(A.size);return A.forEach(function(ue,De){q[++k]=[De,ue]}),q}function Vc(A,k){return function(q){return A(k(q))}}function Yr(A,k){for(var q=-1,ue=A.length,De=0,Ye=[];++q<ue;){var vt=A[q];(vt===k||vt===D)&&(A[q]=D,Ye[De++]=q)}return Ye}function kn(A){var k=-1,q=Array(A.size);return A.forEach(function(ue){q[++k]=ue}),q}function Op(A){var k=-1,q=Array(A.size);return A.forEach(function(ue){q[++k]=[ue,ue]}),q}function Pp(A,k,q){for(var ue=q-1,De=A.length;++ue<De;)if(A[ue]===k)return ue;return-1}function Cp(A,k,q){for(var ue=q+1;ue--;)if(A[ue]===k)return ue;return ue}function Ri(A){return Ti(A)?Np(A):pp(A)}function Er(A){return Ti(A)?Tp(A):gp(A)}function Wc(A){for(var k=A.length;k--&&It.test(A.charAt(k)););return k}var Ap=oo(op);function Np(A){for(var k=Zs.lastIndex=0;Zs.test(A);)++k;return k}function Tp(A){return A.match(Zs)||[]}function Rp(A){return A.match(Zd)||[]}var Fp=function A(k){k=k==null?Rt:Fi.defaults(Rt.Object(),k,Fi.pick(Rt,rp));var q=k.Array,ue=k.Date,De=k.Error,Ye=k.Function,vt=k.Math,Ze=k.Object,lo=k.RegExp,Up=k.String,fr=k.TypeError,Hn=q.prototype,Lp=Ye.prototype,Ui=Ze.prototype,Kn=k["__core-js_shared__"],Vn=Lp.toString,Xe=Ui.hasOwnProperty,$p=0,Gc=function(){var e=/[^.]+$/.exec(Kn&&Kn.keys&&Kn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Wn=Ui.toString,Mp=Vn.call(Ze),jp=Rt._,qp=lo("^"+Vn.call(Xe).replace(lt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gn=Nc?k.Buffer:r,Jr=k.Symbol,Yn=k.Uint8Array,Yc=Gn?Gn.allocUnsafe:r,Jn=Vc(Ze.getPrototypeOf,Ze),Jc=Ze.create,Qc=Ui.propertyIsEnumerable,Qn=Hn.splice,Xc=Jr?Jr.isConcatSpreadable:r,tn=Jr?Jr.iterator:r,hi=Jr?Jr.toStringTag:r,Xn=function(){try{var e=gi(Ze,"defineProperty");return e({},"",{}),e}catch{}}(),zp=k.clearTimeout!==Rt.clearTimeout&&k.clearTimeout,Bp=ue&&ue.now!==Rt.Date.now&&ue.now,kp=k.setTimeout!==Rt.setTimeout&&k.setTimeout,Zn=vt.ceil,es=vt.floor,fo=Ze.getOwnPropertySymbols,Hp=Gn?Gn.isBuffer:r,Zc=k.isFinite,Kp=Hn.join,Vp=Vc(Ze.keys,Ze),yt=vt.max,$t=vt.min,Wp=ue.now,Gp=k.parseInt,eu=vt.random,Yp=Hn.reverse,po=gi(k,"DataView"),rn=gi(k,"Map"),go=gi(k,"Promise"),Li=gi(k,"Set"),nn=gi(k,"WeakMap"),sn=gi(Ze,"create"),ts=nn&&new nn,$i={},Jp=vi(po),Qp=vi(rn),Xp=vi(go),Zp=vi(Li),eg=vi(nn),rs=Jr?Jr.prototype:r,on=rs?rs.valueOf:r,tu=rs?rs.toString:r;function g(e){if(at(e)&&!xe(e)&&!(e instanceof qe)){if(e instanceof dr)return e;if(Xe.call(e,"__wrapped__"))return rh(e)}return new dr(e)}var Mi=function(){function e(){}return function(i){if(!nt(i))return{};if(Jc)return Jc(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function is(){}function dr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}g.templateSettings={escape:mt,evaluate:wt,interpolate:gt,variable:"",imports:{_:g}},g.prototype=is.prototype,g.prototype.constructor=g,dr.prototype=Mi(is.prototype),dr.prototype.constructor=dr;function qe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Z,this.__views__=[]}function tg(){var e=new qe(this.__wrapped__);return e.__actions__=Gt(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Gt(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Gt(this.__views__),e}function rg(){if(this.__filtered__){var e=new qe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function ig(){var e=this.__wrapped__.value(),i=this.__dir__,o=xe(e),u=i<0,d=o?e.length:0,y=g0(0,d,this.__views__),m=y.start,I=y.end,R=I-m,V=u?I:m-1,Y=this.__iteratees__,J=Y.length,ne=0,le=$t(R,this.__takeCount__);if(!o||!u&&d==R&&le==R)return xu(e,this.__actions__);var pe=[];e:for(;R--&&ne<le;){V+=i;for(var Te=-1,ge=e[V];++Te<J;){var Me=Y[Te],ke=Me.iteratee,sr=Me.type,kt=ke(ge);if(sr==j)ge=kt;else if(!kt){if(sr==N)continue e;break e}}pe[ne++]=ge}return pe}qe.prototype=Mi(is.prototype),qe.prototype.constructor=qe;function li(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function ng(){this.__data__=sn?sn(null):{},this.size=0}function sg(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function og(e){var i=this.__data__;if(sn){var o=i[e];return o===v?r:o}return Xe.call(i,e)?i[e]:r}function ag(e){var i=this.__data__;return sn?i[e]!==r:Xe.call(i,e)}function cg(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=sn&&i===r?v:i,this}li.prototype.clear=ng,li.prototype.delete=sg,li.prototype.get=og,li.prototype.has=ag,li.prototype.set=cg;function Fr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function ug(){this.__data__=[],this.size=0}function hg(e){var i=this.__data__,o=ns(i,e);if(o<0)return!1;var u=i.length-1;return o==u?i.pop():Qn.call(i,o,1),--this.size,!0}function lg(e){var i=this.__data__,o=ns(i,e);return o<0?r:i[o][1]}function fg(e){return ns(this.__data__,e)>-1}function dg(e,i){var o=this.__data__,u=ns(o,e);return u<0?(++this.size,o.push([e,i])):o[u][1]=i,this}Fr.prototype.clear=ug,Fr.prototype.delete=hg,Fr.prototype.get=lg,Fr.prototype.has=fg,Fr.prototype.set=dg;function Ur(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function pg(){this.size=0,this.__data__={hash:new li,map:new(rn||Fr),string:new li}}function gg(e){var i=vs(this,e).delete(e);return this.size-=i?1:0,i}function vg(e){return vs(this,e).get(e)}function yg(e){return vs(this,e).has(e)}function bg(e,i){var o=vs(this,e),u=o.size;return o.set(e,i),this.size+=o.size==u?0:1,this}Ur.prototype.clear=pg,Ur.prototype.delete=gg,Ur.prototype.get=vg,Ur.prototype.has=yg,Ur.prototype.set=bg;function fi(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new Ur;++i<o;)this.add(e[i])}function _g(e){return this.__data__.set(e,v),this}function mg(e){return this.__data__.has(e)}fi.prototype.add=fi.prototype.push=_g,fi.prototype.has=mg;function Dr(e){var i=this.__data__=new Fr(e);this.size=i.size}function wg(){this.__data__=new Fr,this.size=0}function Eg(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function Dg(e){return this.__data__.get(e)}function Sg(e){return this.__data__.has(e)}function xg(e,i){var o=this.__data__;if(o instanceof Fr){var u=o.__data__;if(!rn||u.length<a-1)return u.push([e,i]),this.size=++o.size,this;o=this.__data__=new Ur(u)}return o.set(e,i),this.size=o.size,this}Dr.prototype.clear=wg,Dr.prototype.delete=Eg,Dr.prototype.get=Dg,Dr.prototype.has=Sg,Dr.prototype.set=xg;function ru(e,i){var o=xe(e),u=!o&&yi(e),d=!o&&!u&&ti(e),y=!o&&!u&&!d&&Bi(e),m=o||u||d||y,I=m?co(e.length,Up):[],R=I.length;for(var V in e)(i||Xe.call(e,V))&&!(m&&(V=="length"||d&&(V=="offset"||V=="parent")||y&&(V=="buffer"||V=="byteLength"||V=="byteOffset")||jr(V,R)))&&I.push(V);return I}function iu(e){var i=e.length;return i?e[Io(0,i-1)]:r}function Ig(e,i){return ys(Gt(e),di(i,0,e.length))}function Og(e){return ys(Gt(e))}function vo(e,i,o){(o!==r&&!Sr(e[i],o)||o===r&&!(i in e))&&Lr(e,i,o)}function an(e,i,o){var u=e[i];(!(Xe.call(e,i)&&Sr(u,o))||o===r&&!(i in e))&&Lr(e,i,o)}function ns(e,i){for(var o=e.length;o--;)if(Sr(e[o][0],i))return o;return-1}function Pg(e,i,o,u){return Qr(e,function(d,y,m){i(u,d,o(d),m)}),u}function nu(e,i){return e&&Cr(i,Nt(i),e)}function Cg(e,i){return e&&Cr(i,Jt(i),e)}function Lr(e,i,o){i=="__proto__"&&Xn?Xn(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function yo(e,i){for(var o=-1,u=i.length,d=q(u),y=e==null;++o<u;)d[o]=y?r:Qo(e,i[o]);return d}function di(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function pr(e,i,o,u,d,y){var m,I=i&O,R=i&L,V=i&F;if(o&&(m=d?o(e,u,d,y):o(e)),m!==r)return m;if(!nt(e))return e;var Y=xe(e);if(Y){if(m=y0(e),!I)return Gt(e,m)}else{var J=Mt(e),ne=J==re||J==ce;if(ti(e))return Pu(e,I);if(J==Re||J==be||ne&&!d){if(m=R||ne?{}:Wu(e),!I)return R?o0(e,Cg(m,e)):s0(e,nu(m,e))}else{if(!et[J])return d?e:{};m=b0(e,J,I)}}y||(y=new Dr);var le=y.get(e);if(le)return le;y.set(e,m),Eh(e)?e.forEach(function(ge){m.add(pr(ge,i,o,ge,e,y))}):mh(e)&&e.forEach(function(ge,Me){m.set(Me,pr(ge,i,o,Me,e,y))});var pe=V?R?$o:Lo:R?Jt:Nt,Te=Y?r:pe(e);return lr(Te||e,function(ge,Me){Te&&(Me=ge,ge=e[Me]),an(m,Me,pr(ge,i,o,Me,e,y))}),m}function Ag(e){var i=Nt(e);return function(o){return su(o,e,i)}}function su(e,i,o){var u=o.length;if(e==null)return!u;for(e=Ze(e);u--;){var d=o[u],y=i[d],m=e[d];if(m===r&&!(d in e)||!y(m))return!1}return!0}function ou(e,i,o){if(typeof e!="function")throw new fr(p);return pn(function(){e.apply(r,o)},i)}function cn(e,i,o,u){var d=-1,y=zn,m=!0,I=e.length,R=[],V=i.length;if(!I)return R;o&&(i=it(i,rr(o))),u?(y=ro,m=!1):i.length>=a&&(y=en,m=!1,i=new fi(i));e:for(;++d<I;){var Y=e[d],J=o==null?Y:o(Y);if(Y=u||Y!==0?Y:0,m&&J===J){for(var ne=V;ne--;)if(i[ne]===J)continue e;R.push(Y)}else y(i,J,u)||R.push(Y)}return R}var Qr=Ru(Pr),au=Ru(_o,!0);function Ng(e,i){var o=!0;return Qr(e,function(u,d,y){return o=!!i(u,d,y),o}),o}function ss(e,i,o){for(var u=-1,d=e.length;++u<d;){var y=e[u],m=i(y);if(m!=null&&(I===r?m===m&&!nr(m):o(m,I)))var I=m,R=y}return R}function Tg(e,i,o,u){var d=e.length;for(o=Oe(o),o<0&&(o=-o>d?0:d+o),u=u===r||u>d?d:Oe(u),u<0&&(u+=d),u=o>u?0:Sh(u);o<u;)e[o++]=i;return e}function cu(e,i){var o=[];return Qr(e,function(u,d,y){i(u,d,y)&&o.push(u)}),o}function Ft(e,i,o,u,d){var y=-1,m=e.length;for(o||(o=m0),d||(d=[]);++y<m;){var I=e[y];i>0&&o(I)?i>1?Ft(I,i-1,o,u,d):Gr(d,I):u||(d[d.length]=I)}return d}var bo=Fu(),uu=Fu(!0);function Pr(e,i){return e&&bo(e,i,Nt)}function _o(e,i){return e&&uu(e,i,Nt)}function os(e,i){return Wr(i,function(o){return qr(e[o])})}function pi(e,i){i=Zr(i,e);for(var o=0,u=i.length;e!=null&&o<u;)e=e[Ar(i[o++])];return o&&o==u?e:r}function hu(e,i,o){var u=i(e);return xe(e)?u:Gr(u,o(e))}function zt(e){return e==null?e===r?Le:ze:hi&&hi in Ze(e)?p0(e):O0(e)}function mo(e,i){return e>i}function Rg(e,i){return e!=null&&Xe.call(e,i)}function Fg(e,i){return e!=null&&i in Ze(e)}function Ug(e,i,o){return e>=$t(i,o)&&e<yt(i,o)}function wo(e,i,o){for(var u=o?ro:zn,d=e[0].length,y=e.length,m=y,I=q(y),R=1/0,V=[];m--;){var Y=e[m];m&&i&&(Y=it(Y,rr(i))),R=$t(Y.length,R),I[m]=!o&&(i||d>=120&&Y.length>=120)?new fi(m&&Y):r}Y=e[0];var J=-1,ne=I[0];e:for(;++J<d&&V.length<R;){var le=Y[J],pe=i?i(le):le;if(le=o||le!==0?le:0,!(ne?en(ne,pe):u(V,pe,o))){for(m=y;--m;){var Te=I[m];if(!(Te?en(Te,pe):u(e[m],pe,o)))continue e}ne&&ne.push(pe),V.push(le)}}return V}function Lg(e,i,o,u){return Pr(e,function(d,y,m){i(u,o(d),y,m)}),u}function un(e,i,o){i=Zr(i,e),e=Qu(e,i);var u=e==null?e:e[Ar(vr(i))];return u==null?r:tr(u,e,o)}function lu(e){return at(e)&&zt(e)==be}function $g(e){return at(e)&&zt(e)==Ee}function Mg(e){return at(e)&&zt(e)==C}function hn(e,i,o,u,d){return e===i?!0:e==null||i==null||!at(e)&&!at(i)?e!==e&&i!==i:jg(e,i,o,u,hn,d)}function jg(e,i,o,u,d,y){var m=xe(e),I=xe(i),R=m?ve:Mt(e),V=I?ve:Mt(i);R=R==be?Re:R,V=V==be?Re:V;var Y=R==Re,J=V==Re,ne=R==V;if(ne&&ti(e)){if(!ti(i))return!1;m=!0,Y=!1}if(ne&&!Y)return y||(y=new Dr),m||Bi(e)?Hu(e,i,o,u,d,y):f0(e,i,R,o,u,d,y);if(!(o&U)){var le=Y&&Xe.call(e,"__wrapped__"),pe=J&&Xe.call(i,"__wrapped__");if(le||pe){var Te=le?e.value():e,ge=pe?i.value():i;return y||(y=new Dr),d(Te,ge,o,u,y)}}return ne?(y||(y=new Dr),d0(e,i,o,u,d,y)):!1}function qg(e){return at(e)&&Mt(e)==_e}function Eo(e,i,o,u){var d=o.length,y=d,m=!u;if(e==null)return!y;for(e=Ze(e);d--;){var I=o[d];if(m&&I[2]?I[1]!==e[I[0]]:!(I[0]in e))return!1}for(;++d<y;){I=o[d];var R=I[0],V=e[R],Y=I[1];if(m&&I[2]){if(V===r&&!(R in e))return!1}else{var J=new Dr;if(u)var ne=u(V,Y,R,e,i,J);if(!(ne===r?hn(Y,V,U|z,u,J):ne))return!1}}return!0}function fu(e){if(!nt(e)||E0(e))return!1;var i=qr(e)?qp:Ad;return i.test(vi(e))}function zg(e){return at(e)&&zt(e)==Ue}function Bg(e){return at(e)&&Mt(e)==me}function kg(e){return at(e)&&Ds(e.length)&&!!rt[zt(e)]}function du(e){return typeof e=="function"?e:e==null?Qt:typeof e=="object"?xe(e)?vu(e[0],e[1]):gu(e):Uh(e)}function Do(e){if(!dn(e))return Vp(e);var i=[];for(var o in Ze(e))Xe.call(e,o)&&o!="constructor"&&i.push(o);return i}function Hg(e){if(!nt(e))return I0(e);var i=dn(e),o=[];for(var u in e)u=="constructor"&&(i||!Xe.call(e,u))||o.push(u);return o}function So(e,i){return e<i}function pu(e,i){var o=-1,u=Yt(e)?q(e.length):[];return Qr(e,function(d,y,m){u[++o]=i(d,y,m)}),u}function gu(e){var i=jo(e);return i.length==1&&i[0][2]?Yu(i[0][0],i[0][1]):function(o){return o===e||Eo(o,e,i)}}function vu(e,i){return zo(e)&&Gu(i)?Yu(Ar(e),i):function(o){var u=Qo(o,e);return u===r&&u===i?Xo(o,e):hn(i,u,U|z)}}function as(e,i,o,u,d){e!==i&&bo(i,function(y,m){if(d||(d=new Dr),nt(y))Kg(e,i,m,o,as,u,d);else{var I=u?u(ko(e,m),y,m+"",e,i,d):r;I===r&&(I=y),vo(e,m,I)}},Jt)}function Kg(e,i,o,u,d,y,m){var I=ko(e,o),R=ko(i,o),V=m.get(R);if(V){vo(e,o,V);return}var Y=y?y(I,R,o+"",e,i,m):r,J=Y===r;if(J){var ne=xe(R),le=!ne&&ti(R),pe=!ne&&!le&&Bi(R);Y=R,ne||le||pe?xe(I)?Y=I:ct(I)?Y=Gt(I):le?(J=!1,Y=Pu(R,!0)):pe?(J=!1,Y=Cu(R,!0)):Y=[]:gn(R)||yi(R)?(Y=I,yi(I)?Y=xh(I):(!nt(I)||qr(I))&&(Y=Wu(R))):J=!1}J&&(m.set(R,Y),d(Y,R,u,y,m),m.delete(R)),vo(e,o,Y)}function yu(e,i){var o=e.length;if(o)return i+=i<0?o:0,jr(i,o)?e[i]:r}function bu(e,i,o){i.length?i=it(i,function(y){return xe(y)?function(m){return pi(m,y.length===1?y[0]:y)}:y}):i=[Qt];var u=-1;i=it(i,rr(de()));var d=pu(e,function(y,m,I){var R=it(i,function(V){return V(y)});return{criteria:R,index:++u,value:y}});return bp(d,function(y,m){return n0(y,m,o)})}function Vg(e,i){return _u(e,i,function(o,u){return Xo(e,u)})}function _u(e,i,o){for(var u=-1,d=i.length,y={};++u<d;){var m=i[u],I=pi(e,m);o(I,m)&&ln(y,Zr(m,e),I)}return y}function Wg(e){return function(i){return pi(i,e)}}function xo(e,i,o,u){var d=u?yp:Ni,y=-1,m=i.length,I=e;for(e===i&&(i=Gt(i)),o&&(I=it(e,rr(o)));++y<m;)for(var R=0,V=i[y],Y=o?o(V):V;(R=d(I,Y,R,u))>-1;)I!==e&&Qn.call(I,R,1),Qn.call(e,R,1);return e}function mu(e,i){for(var o=e?i.length:0,u=o-1;o--;){var d=i[o];if(o==u||d!==y){var y=d;jr(d)?Qn.call(e,d,1):Co(e,d)}}return e}function Io(e,i){return e+es(eu()*(i-e+1))}function Gg(e,i,o,u){for(var d=-1,y=yt(Zn((i-e)/(o||1)),0),m=q(y);y--;)m[u?y:++d]=e,e+=o;return m}function Oo(e,i){var o="";if(!e||i<1||i>W)return o;do i%2&&(o+=e),i=es(i/2),i&&(e+=e);while(i);return o}function Fe(e,i){return Ho(Ju(e,i,Qt),e+"")}function Yg(e){return iu(ki(e))}function Jg(e,i){var o=ki(e);return ys(o,di(i,0,o.length))}function ln(e,i,o,u){if(!nt(e))return e;i=Zr(i,e);for(var d=-1,y=i.length,m=y-1,I=e;I!=null&&++d<y;){var R=Ar(i[d]),V=o;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(d!=m){var Y=I[R];V=u?u(Y,R,I):r,V===r&&(V=nt(Y)?Y:jr(i[d+1])?[]:{})}an(I,R,V),I=I[R]}return e}var wu=ts?function(e,i){return ts.set(e,i),e}:Qt,Qg=Xn?function(e,i){return Xn(e,"toString",{configurable:!0,enumerable:!1,value:ea(i),writable:!0})}:Qt;function Xg(e){return ys(ki(e))}function gr(e,i,o){var u=-1,d=e.length;i<0&&(i=-i>d?0:d+i),o=o>d?d:o,o<0&&(o+=d),d=i>o?0:o-i>>>0,i>>>=0;for(var y=q(d);++u<d;)y[u]=e[u+i];return y}function Zg(e,i){var o;return Qr(e,function(u,d,y){return o=i(u,d,y),!o}),!!o}function cs(e,i,o){var u=0,d=e==null?u:e.length;if(typeof i=="number"&&i===i&&d<=te){for(;u<d;){var y=u+d>>>1,m=e[y];m!==null&&!nr(m)&&(o?m<=i:m<i)?u=y+1:d=y}return d}return Po(e,i,Qt,o)}function Po(e,i,o,u){var d=0,y=e==null?0:e.length;if(y===0)return 0;i=o(i);for(var m=i!==i,I=i===null,R=nr(i),V=i===r;d<y;){var Y=es((d+y)/2),J=o(e[Y]),ne=J!==r,le=J===null,pe=J===J,Te=nr(J);if(m)var ge=u||pe;else V?ge=pe&&(u||ne):I?ge=pe&&ne&&(u||!le):R?ge=pe&&ne&&!le&&(u||!Te):le||Te?ge=!1:ge=u?J<=i:J<i;ge?d=Y+1:y=Y}return $t(y,we)}function Eu(e,i){for(var o=-1,u=e.length,d=0,y=[];++o<u;){var m=e[o],I=i?i(m):m;if(!o||!Sr(I,R)){var R=I;y[d++]=m===0?0:m}}return y}function Du(e){return typeof e=="number"?e:nr(e)?G:+e}function ir(e){if(typeof e=="string")return e;if(xe(e))return it(e,ir)+"";if(nr(e))return tu?tu.call(e):"";var i=e+"";return i=="0"&&1/e==-X?"-0":i}function Xr(e,i,o){var u=-1,d=zn,y=e.length,m=!0,I=[],R=I;if(o)m=!1,d=ro;else if(y>=a){var V=i?null:h0(e);if(V)return kn(V);m=!1,d=en,R=new fi}else R=i?[]:I;e:for(;++u<y;){var Y=e[u],J=i?i(Y):Y;if(Y=o||Y!==0?Y:0,m&&J===J){for(var ne=R.length;ne--;)if(R[ne]===J)continue e;i&&R.push(J),I.push(Y)}else d(R,J,o)||(R!==I&&R.push(J),I.push(Y))}return I}function Co(e,i){return i=Zr(i,e),e=Qu(e,i),e==null||delete e[Ar(vr(i))]}function Su(e,i,o,u){return ln(e,i,o(pi(e,i)),u)}function us(e,i,o,u){for(var d=e.length,y=u?d:-1;(u?y--:++y<d)&&i(e[y],y,e););return o?gr(e,u?0:y,u?y+1:d):gr(e,u?y+1:0,u?d:y)}function xu(e,i){var o=e;return o instanceof qe&&(o=o.value()),io(i,function(u,d){return d.func.apply(d.thisArg,Gr([u],d.args))},o)}function Ao(e,i,o){var u=e.length;if(u<2)return u?Xr(e[0]):[];for(var d=-1,y=q(u);++d<u;)for(var m=e[d],I=-1;++I<u;)I!=d&&(y[d]=cn(y[d]||m,e[I],i,o));return Xr(Ft(y,1),i,o)}function Iu(e,i,o){for(var u=-1,d=e.length,y=i.length,m={};++u<d;){var I=u<y?i[u]:r;o(m,e[u],I)}return m}function No(e){return ct(e)?e:[]}function To(e){return typeof e=="function"?e:Qt}function Zr(e,i){return xe(e)?e:zo(e,i)?[e]:th(Qe(e))}var e0=Fe;function ei(e,i,o){var u=e.length;return o=o===r?u:o,!i&&o>=u?e:gr(e,i,o)}var Ou=zp||function(e){return Rt.clearTimeout(e)};function Pu(e,i){if(i)return e.slice();var o=e.length,u=Yc?Yc(o):new e.constructor(o);return e.copy(u),u}function Ro(e){var i=new e.constructor(e.byteLength);return new Yn(i).set(new Yn(e)),i}function t0(e,i){var o=i?Ro(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function r0(e){var i=new e.constructor(e.source,lc.exec(e));return i.lastIndex=e.lastIndex,i}function i0(e){return on?Ze(on.call(e)):{}}function Cu(e,i){var o=i?Ro(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function Au(e,i){if(e!==i){var o=e!==r,u=e===null,d=e===e,y=nr(e),m=i!==r,I=i===null,R=i===i,V=nr(i);if(!I&&!V&&!y&&e>i||y&&m&&R&&!I&&!V||u&&m&&R||!o&&R||!d)return 1;if(!u&&!y&&!V&&e<i||V&&o&&d&&!u&&!y||I&&o&&d||!m&&d||!R)return-1}return 0}function n0(e,i,o){for(var u=-1,d=e.criteria,y=i.criteria,m=d.length,I=o.length;++u<m;){var R=Au(d[u],y[u]);if(R){if(u>=I)return R;var V=o[u];return R*(V=="desc"?-1:1)}}return e.index-i.index}function Nu(e,i,o,u){for(var d=-1,y=e.length,m=o.length,I=-1,R=i.length,V=yt(y-m,0),Y=q(R+V),J=!u;++I<R;)Y[I]=i[I];for(;++d<m;)(J||d<y)&&(Y[o[d]]=e[d]);for(;V--;)Y[I++]=e[d++];return Y}function Tu(e,i,o,u){for(var d=-1,y=e.length,m=-1,I=o.length,R=-1,V=i.length,Y=yt(y-I,0),J=q(Y+V),ne=!u;++d<Y;)J[d]=e[d];for(var le=d;++R<V;)J[le+R]=i[R];for(;++m<I;)(ne||d<y)&&(J[le+o[m]]=e[d++]);return J}function Gt(e,i){var o=-1,u=e.length;for(i||(i=q(u));++o<u;)i[o]=e[o];return i}function Cr(e,i,o,u){var d=!o;o||(o={});for(var y=-1,m=i.length;++y<m;){var I=i[y],R=u?u(o[I],e[I],I,o,e):r;R===r&&(R=e[I]),d?Lr(o,I,R):an(o,I,R)}return o}function s0(e,i){return Cr(e,qo(e),i)}function o0(e,i){return Cr(e,Ku(e),i)}function hs(e,i){return function(o,u){var d=xe(o)?lp:Pg,y=i?i():{};return d(o,e,de(u,2),y)}}function ji(e){return Fe(function(i,o){var u=-1,d=o.length,y=d>1?o[d-1]:r,m=d>2?o[2]:r;for(y=e.length>3&&typeof y=="function"?(d--,y):r,m&&Bt(o[0],o[1],m)&&(y=d<3?r:y,d=1),i=Ze(i);++u<d;){var I=o[u];I&&e(i,I,u,y)}return i})}function Ru(e,i){return function(o,u){if(o==null)return o;if(!Yt(o))return e(o,u);for(var d=o.length,y=i?d:-1,m=Ze(o);(i?y--:++y<d)&&u(m[y],y,m)!==!1;);return o}}function Fu(e){return function(i,o,u){for(var d=-1,y=Ze(i),m=u(i),I=m.length;I--;){var R=m[e?I:++d];if(o(y[R],R,y)===!1)break}return i}}function a0(e,i,o){var u=i&B,d=fn(e);function y(){var m=this&&this!==Rt&&this instanceof y?d:e;return m.apply(u?o:this,arguments)}return y}function Uu(e){return function(i){i=Qe(i);var o=Ti(i)?Er(i):r,u=o?o[0]:i.charAt(0),d=o?ei(o,1).join(""):i.slice(1);return u[e]()+d}}function qi(e){return function(i){return io(Rh(Th(i).replace(Qd,"")),e,"")}}function fn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=Mi(e.prototype),u=e.apply(o,i);return nt(u)?u:o}}function c0(e,i,o){var u=fn(e);function d(){for(var y=arguments.length,m=q(y),I=y,R=zi(d);I--;)m[I]=arguments[I];var V=y<3&&m[0]!==R&&m[y-1]!==R?[]:Yr(m,R);if(y-=V.length,y<o)return qu(e,i,ls,d.placeholder,r,m,V,r,r,o-y);var Y=this&&this!==Rt&&this instanceof d?u:e;return tr(Y,this,m)}return d}function Lu(e){return function(i,o,u){var d=Ze(i);if(!Yt(i)){var y=de(o,3);i=Nt(i),o=function(I){return y(d[I],I,d)}}var m=e(i,o,u);return m>-1?d[y?i[m]:m]:r}}function $u(e){return Mr(function(i){var o=i.length,u=o,d=dr.prototype.thru;for(e&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new fr(p);if(d&&!m&&gs(y)=="wrapper")var m=new dr([],!0)}for(u=m?u:o;++u<o;){y=i[u];var I=gs(y),R=I=="wrapper"?Mo(y):r;R&&Bo(R[0])&&R[1]==(c|T|x|b)&&!R[4].length&&R[9]==1?m=m[gs(R[0])].apply(m,R[3]):m=y.length==1&&Bo(y)?m[I]():m.thru(y)}return function(){var V=arguments,Y=V[0];if(m&&V.length==1&&xe(Y))return m.plant(Y).value();for(var J=0,ne=o?i[J].apply(this,V):Y;++J<o;)ne=i[J].call(this,ne);return ne}})}function ls(e,i,o,u,d,y,m,I,R,V){var Y=i&c,J=i&B,ne=i&ee,le=i&(T|E),pe=i&H,Te=ne?r:fn(e);function ge(){for(var Me=arguments.length,ke=q(Me),sr=Me;sr--;)ke[sr]=arguments[sr];if(le)var kt=zi(ge),or=mp(ke,kt);if(u&&(ke=Nu(ke,u,d,le)),y&&(ke=Tu(ke,y,m,le)),Me-=or,le&&Me<V){var ut=Yr(ke,kt);return qu(e,i,ls,ge.placeholder,o,ke,ut,I,R,V-Me)}var xr=J?o:this,Br=ne?xr[e]:e;return Me=ke.length,I?ke=P0(ke,I):pe&&Me>1&&ke.reverse(),Y&&R<Me&&(ke.length=R),this&&this!==Rt&&this instanceof ge&&(Br=Te||fn(Br)),Br.apply(xr,ke)}return ge}function Mu(e,i){return function(o,u){return Lg(o,e,i(u),{})}}function fs(e,i){return function(o,u){var d;if(o===r&&u===r)return i;if(o!==r&&(d=o),u!==r){if(d===r)return u;typeof o=="string"||typeof u=="string"?(o=ir(o),u=ir(u)):(o=Du(o),u=Du(u)),d=e(o,u)}return d}}function Fo(e){return Mr(function(i){return i=it(i,rr(de())),Fe(function(o){var u=this;return e(i,function(d){return tr(d,u,o)})})})}function ds(e,i){i=i===r?" ":ir(i);var o=i.length;if(o<2)return o?Oo(i,e):i;var u=Oo(i,Zn(e/Ri(i)));return Ti(i)?ei(Er(u),0,e).join(""):u.slice(0,e)}function u0(e,i,o,u){var d=i&B,y=fn(e);function m(){for(var I=-1,R=arguments.length,V=-1,Y=u.length,J=q(Y+R),ne=this&&this!==Rt&&this instanceof m?y:e;++V<Y;)J[V]=u[V];for(;R--;)J[V++]=arguments[++I];return tr(ne,d?o:this,J)}return m}function ju(e){return function(i,o,u){return u&&typeof u!="number"&&Bt(i,o,u)&&(o=u=r),i=zr(i),o===r?(o=i,i=0):o=zr(o),u=u===r?i<o?1:-1:zr(u),Gg(i,o,u,e)}}function ps(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=yr(i),o=yr(o)),e(i,o)}}function qu(e,i,o,u,d,y,m,I,R,V){var Y=i&T,J=Y?m:r,ne=Y?r:m,le=Y?y:r,pe=Y?r:y;i|=Y?x:_,i&=~(Y?_:x),i&P||(i&=~(B|ee));var Te=[e,i,d,le,J,pe,ne,I,R,V],ge=o.apply(r,Te);return Bo(e)&&Xu(ge,Te),ge.placeholder=u,Zu(ge,e,i)}function Uo(e){var i=vt[e];return function(o,u){if(o=yr(o),u=u==null?0:$t(Oe(u),292),u&&Zc(o)){var d=(Qe(o)+"e").split("e"),y=i(d[0]+"e"+(+d[1]+u));return d=(Qe(y)+"e").split("e"),+(d[0]+"e"+(+d[1]-u))}return i(o)}}var h0=Li&&1/kn(new Li([,-0]))[1]==X?function(e){return new Li(e)}:ia;function zu(e){return function(i){var o=Mt(i);return o==_e?ho(i):o==me?Op(i):_p(i,e(i))}}function $r(e,i,o,u,d,y,m,I){var R=i&ee;if(!R&&typeof e!="function")throw new fr(p);var V=u?u.length:0;if(V||(i&=~(x|_),u=d=r),m=m===r?m:yt(Oe(m),0),I=I===r?I:Oe(I),V-=d?d.length:0,i&_){var Y=u,J=d;u=d=r}var ne=R?r:Mo(e),le=[e,i,o,u,d,Y,J,y,m,I];if(ne&&x0(le,ne),e=le[0],i=le[1],o=le[2],u=le[3],d=le[4],I=le[9]=le[9]===r?R?0:e.length:yt(le[9]-V,0),!I&&i&(T|E)&&(i&=~(T|E)),!i||i==B)var pe=a0(e,i,o);else i==T||i==E?pe=c0(e,i,I):(i==x||i==(B|x))&&!d.length?pe=u0(e,i,o,u):pe=ls.apply(r,le);var Te=ne?wu:Xu;return Zu(Te(pe,le),e,i)}function Bu(e,i,o,u){return e===r||Sr(e,Ui[o])&&!Xe.call(u,o)?i:e}function ku(e,i,o,u,d,y){return nt(e)&&nt(i)&&(y.set(i,e),as(e,i,r,ku,y),y.delete(i)),e}function l0(e){return gn(e)?r:e}function Hu(e,i,o,u,d,y){var m=o&U,I=e.length,R=i.length;if(I!=R&&!(m&&R>I))return!1;var V=y.get(e),Y=y.get(i);if(V&&Y)return V==i&&Y==e;var J=-1,ne=!0,le=o&z?new fi:r;for(y.set(e,i),y.set(i,e);++J<I;){var pe=e[J],Te=i[J];if(u)var ge=m?u(Te,pe,J,i,e,y):u(pe,Te,J,e,i,y);if(ge!==r){if(ge)continue;ne=!1;break}if(le){if(!no(i,function(Me,ke){if(!en(le,ke)&&(pe===Me||d(pe,Me,o,u,y)))return le.push(ke)})){ne=!1;break}}else if(!(pe===Te||d(pe,Te,o,u,y))){ne=!1;break}}return y.delete(e),y.delete(i),ne}function f0(e,i,o,u,d,y,m){switch(o){case Ne:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ee:return!(e.byteLength!=i.byteLength||!y(new Yn(e),new Yn(i)));case M:case C:case $e:return Sr(+e,+i);case S:return e.name==i.name&&e.message==i.message;case Ue:case Pe:return e==i+"";case _e:var I=ho;case me:var R=u&U;if(I||(I=kn),e.size!=i.size&&!R)return!1;var V=m.get(e);if(V)return V==i;u|=z,m.set(e,i);var Y=Hu(I(e),I(i),u,d,y,m);return m.delete(e),Y;case Ce:if(on)return on.call(e)==on.call(i)}return!1}function d0(e,i,o,u,d,y){var m=o&U,I=Lo(e),R=I.length,V=Lo(i),Y=V.length;if(R!=Y&&!m)return!1;for(var J=R;J--;){var ne=I[J];if(!(m?ne in i:Xe.call(i,ne)))return!1}var le=y.get(e),pe=y.get(i);if(le&&pe)return le==i&&pe==e;var Te=!0;y.set(e,i),y.set(i,e);for(var ge=m;++J<R;){ne=I[J];var Me=e[ne],ke=i[ne];if(u)var sr=m?u(ke,Me,ne,i,e,y):u(Me,ke,ne,e,i,y);if(!(sr===r?Me===ke||d(Me,ke,o,u,y):sr)){Te=!1;break}ge||(ge=ne=="constructor")}if(Te&&!ge){var kt=e.constructor,or=i.constructor;kt!=or&&"constructor"in e&&"constructor"in i&&!(typeof kt=="function"&&kt instanceof kt&&typeof or=="function"&&or instanceof or)&&(Te=!1)}return y.delete(e),y.delete(i),Te}function Mr(e){return Ho(Ju(e,r,sh),e+"")}function Lo(e){return hu(e,Nt,qo)}function $o(e){return hu(e,Jt,Ku)}var Mo=ts?function(e){return ts.get(e)}:ia;function gs(e){for(var i=e.name+"",o=$i[i],u=Xe.call($i,i)?o.length:0;u--;){var d=o[u],y=d.func;if(y==null||y==e)return d.name}return i}function zi(e){var i=Xe.call(g,"placeholder")?g:e;return i.placeholder}function de(){var e=g.iteratee||ta;return e=e===ta?du:e,arguments.length?e(arguments[0],arguments[1]):e}function vs(e,i){var o=e.__data__;return w0(i)?o[typeof i=="string"?"string":"hash"]:o.map}function jo(e){for(var i=Nt(e),o=i.length;o--;){var u=i[o],d=e[u];i[o]=[u,d,Gu(d)]}return i}function gi(e,i){var o=Sp(e,i);return fu(o)?o:r}function p0(e){var i=Xe.call(e,hi),o=e[hi];try{e[hi]=r;var u=!0}catch{}var d=Wn.call(e);return u&&(i?e[hi]=o:delete e[hi]),d}var qo=fo?function(e){return e==null?[]:(e=Ze(e),Wr(fo(e),function(i){return Qc.call(e,i)}))}:na,Ku=fo?function(e){for(var i=[];e;)Gr(i,qo(e)),e=Jn(e);return i}:na,Mt=zt;(po&&Mt(new po(new ArrayBuffer(1)))!=Ne||rn&&Mt(new rn)!=_e||go&&Mt(go.resolve())!=st||Li&&Mt(new Li)!=me||nn&&Mt(new nn)!=Se)&&(Mt=function(e){var i=zt(e),o=i==Re?e.constructor:r,u=o?vi(o):"";if(u)switch(u){case Jp:return Ne;case Qp:return _e;case Xp:return st;case Zp:return me;case eg:return Se}return i});function g0(e,i,o){for(var u=-1,d=o.length;++u<d;){var y=o[u],m=y.size;switch(y.type){case"drop":e+=m;break;case"dropRight":i-=m;break;case"take":i=$t(i,e+m);break;case"takeRight":e=yt(e,i-m);break}}return{start:e,end:i}}function v0(e){var i=e.match(Pt);return i?i[1].split(Ct):[]}function Vu(e,i,o){i=Zr(i,e);for(var u=-1,d=i.length,y=!1;++u<d;){var m=Ar(i[u]);if(!(y=e!=null&&o(e,m)))break;e=e[m]}return y||++u!=d?y:(d=e==null?0:e.length,!!d&&Ds(d)&&jr(m,d)&&(xe(e)||yi(e)))}function y0(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&Xe.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function Wu(e){return typeof e.constructor=="function"&&!dn(e)?Mi(Jn(e)):{}}function b0(e,i,o){var u=e.constructor;switch(i){case Ee:return Ro(e);case M:case C:return new u(+e);case Ne:return t0(e,o);case je:case Be:case Ke:case Ve:case We:case Ge:case Je:case ur:case wr:return Cu(e,o);case _e:return new u;case $e:case Pe:return new u(e);case Ue:return r0(e);case me:return new u;case Ce:return i0(e)}}function _0(e,i){var o=i.length;if(!o)return e;var u=o-1;return i[u]=(o>1?"& ":"")+i[u],i=i.join(o>2?", ":" "),e.replace(Ot,`{
/* [wrapped with `+i+`] */
`)}function m0(e){return xe(e)||yi(e)||!!(Xc&&e&&e[Xc])}function jr(e,i){var o=typeof e;return i=i!=null?i:W,!!i&&(o=="number"||o!="symbol"&&Td.test(e))&&e>-1&&e%1==0&&e<i}function Bt(e,i,o){if(!nt(o))return!1;var u=typeof i;return(u=="number"?Yt(o)&&jr(i,o.length):u=="string"&&i in o)?Sr(o[i],e):!1}function zo(e,i){if(xe(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||nr(e)?!0:Dt.test(e)||!Et.test(e)||i!=null&&e in Ze(i)}function w0(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Bo(e){var i=gs(e),o=g[i];if(typeof o!="function"||!(i in qe.prototype))return!1;if(e===o)return!0;var u=Mo(o);return!!u&&e===u[0]}function E0(e){return!!Gc&&Gc in e}var D0=Kn?qr:sa;function dn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||Ui;return e===o}function Gu(e){return e===e&&!nt(e)}function Yu(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in Ze(o))}}function S0(e){var i=ws(e,function(u){return o.size===w&&o.clear(),u}),o=i.cache;return i}function x0(e,i){var o=e[1],u=i[1],d=o|u,y=d<(B|ee|c),m=u==c&&o==T||u==c&&o==b&&e[7].length<=i[8]||u==(c|b)&&i[7].length<=i[8]&&o==T;if(!(y||m))return e;u&B&&(e[2]=i[2],d|=o&B?0:P);var I=i[3];if(I){var R=e[3];e[3]=R?Nu(R,I,i[4]):I,e[4]=R?Yr(e[3],D):i[4]}return I=i[5],I&&(R=e[5],e[5]=R?Tu(R,I,i[6]):I,e[6]=R?Yr(e[5],D):i[6]),I=i[7],I&&(e[7]=I),u&c&&(e[8]=e[8]==null?i[8]:$t(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=d,e}function I0(e){var i=[];if(e!=null)for(var o in Ze(e))i.push(o);return i}function O0(e){return Wn.call(e)}function Ju(e,i,o){return i=yt(i===r?e.length-1:i,0),function(){for(var u=arguments,d=-1,y=yt(u.length-i,0),m=q(y);++d<y;)m[d]=u[i+d];d=-1;for(var I=q(i+1);++d<i;)I[d]=u[d];return I[i]=o(m),tr(e,this,I)}}function Qu(e,i){return i.length<2?e:pi(e,gr(i,0,-1))}function P0(e,i){for(var o=e.length,u=$t(i.length,o),d=Gt(e);u--;){var y=i[u];e[u]=jr(y,o)?d[y]:r}return e}function ko(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Xu=eh(wu),pn=kp||function(e,i){return Rt.setTimeout(e,i)},Ho=eh(Qg);function Zu(e,i,o){var u=i+"";return Ho(e,_0(u,C0(v0(u),o)))}function eh(e){var i=0,o=0;return function(){var u=Wp(),d=he-(u-o);if(o=u,d>0){if(++i>=oe)return arguments[0]}else i=0;return e.apply(r,arguments)}}function ys(e,i){var o=-1,u=e.length,d=u-1;for(i=i===r?u:i;++o<i;){var y=Io(o,d),m=e[y];e[y]=e[o],e[o]=m}return e.length=i,e}var th=S0(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(St,function(o,u,d,y){i.push(d?y.replace(Id,"$1"):u||o)}),i});function Ar(e){if(typeof e=="string"||nr(e))return e;var i=e+"";return i=="0"&&1/e==-X?"-0":i}function vi(e){if(e!=null){try{return Vn.call(e)}catch{}try{return e+""}catch{}}return""}function C0(e,i){return lr(ye,function(o){var u="_."+o[0];i&o[1]&&!zn(e,u)&&e.push(u)}),e.sort()}function rh(e){if(e instanceof qe)return e.clone();var i=new dr(e.__wrapped__,e.__chain__);return i.__actions__=Gt(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function A0(e,i,o){(o?Bt(e,i,o):i===r)?i=1:i=yt(Oe(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var d=0,y=0,m=q(Zn(u/i));d<u;)m[y++]=gr(e,d,d+=i);return m}function N0(e){for(var i=-1,o=e==null?0:e.length,u=0,d=[];++i<o;){var y=e[i];y&&(d[u++]=y)}return d}function T0(){var e=arguments.length;if(!e)return[];for(var i=q(e-1),o=arguments[0],u=e;u--;)i[u-1]=arguments[u];return Gr(xe(o)?Gt(o):[o],Ft(i,1))}var R0=Fe(function(e,i){return ct(e)?cn(e,Ft(i,1,ct,!0)):[]}),F0=Fe(function(e,i){var o=vr(i);return ct(o)&&(o=r),ct(e)?cn(e,Ft(i,1,ct,!0),de(o,2)):[]}),U0=Fe(function(e,i){var o=vr(i);return ct(o)&&(o=r),ct(e)?cn(e,Ft(i,1,ct,!0),r,o):[]});function L0(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:Oe(i),gr(e,i<0?0:i,u)):[]}function $0(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:Oe(i),i=u-i,gr(e,0,i<0?0:i)):[]}function M0(e,i){return e&&e.length?us(e,de(i,3),!0,!0):[]}function j0(e,i){return e&&e.length?us(e,de(i,3),!0):[]}function q0(e,i,o,u){var d=e==null?0:e.length;return d?(o&&typeof o!="number"&&Bt(e,i,o)&&(o=0,u=d),Tg(e,i,o,u)):[]}function ih(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var d=o==null?0:Oe(o);return d<0&&(d=yt(u+d,0)),Bn(e,de(i,3),d)}function nh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var d=u-1;return o!==r&&(d=Oe(o),d=o<0?yt(u+d,0):$t(d,u-1)),Bn(e,de(i,3),d,!0)}function sh(e){var i=e==null?0:e.length;return i?Ft(e,1):[]}function z0(e){var i=e==null?0:e.length;return i?Ft(e,X):[]}function B0(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:Oe(i),Ft(e,i)):[]}function k0(e){for(var i=-1,o=e==null?0:e.length,u={};++i<o;){var d=e[i];u[d[0]]=d[1]}return u}function oh(e){return e&&e.length?e[0]:r}function H0(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var d=o==null?0:Oe(o);return d<0&&(d=yt(u+d,0)),Ni(e,i,d)}function K0(e){var i=e==null?0:e.length;return i?gr(e,0,-1):[]}var V0=Fe(function(e){var i=it(e,No);return i.length&&i[0]===e[0]?wo(i):[]}),W0=Fe(function(e){var i=vr(e),o=it(e,No);return i===vr(o)?i=r:o.pop(),o.length&&o[0]===e[0]?wo(o,de(i,2)):[]}),G0=Fe(function(e){var i=vr(e),o=it(e,No);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?wo(o,r,i):[]});function Y0(e,i){return e==null?"":Kp.call(e,i)}function vr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function J0(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var d=u;return o!==r&&(d=Oe(o),d=d<0?yt(u+d,0):$t(d,u-1)),i===i?Cp(e,i,d):Bn(e,qc,d,!0)}function Q0(e,i){return e&&e.length?yu(e,Oe(i)):r}var X0=Fe(ah);function ah(e,i){return e&&e.length&&i&&i.length?xo(e,i):e}function Z0(e,i,o){return e&&e.length&&i&&i.length?xo(e,i,de(o,2)):e}function e1(e,i,o){return e&&e.length&&i&&i.length?xo(e,i,r,o):e}var t1=Mr(function(e,i){var o=e==null?0:e.length,u=yo(e,i);return mu(e,it(i,function(d){return jr(d,o)?+d:d}).sort(Au)),u});function r1(e,i){var o=[];if(!(e&&e.length))return o;var u=-1,d=[],y=e.length;for(i=de(i,3);++u<y;){var m=e[u];i(m,u,e)&&(o.push(m),d.push(u))}return mu(e,d),o}function Ko(e){return e==null?e:Yp.call(e)}function i1(e,i,o){var u=e==null?0:e.length;return u?(o&&typeof o!="number"&&Bt(e,i,o)?(i=0,o=u):(i=i==null?0:Oe(i),o=o===r?u:Oe(o)),gr(e,i,o)):[]}function n1(e,i){return cs(e,i)}function s1(e,i,o){return Po(e,i,de(o,2))}function o1(e,i){var o=e==null?0:e.length;if(o){var u=cs(e,i);if(u<o&&Sr(e[u],i))return u}return-1}function a1(e,i){return cs(e,i,!0)}function c1(e,i,o){return Po(e,i,de(o,2),!0)}function u1(e,i){var o=e==null?0:e.length;if(o){var u=cs(e,i,!0)-1;if(Sr(e[u],i))return u}return-1}function h1(e){return e&&e.length?Eu(e):[]}function l1(e,i){return e&&e.length?Eu(e,de(i,2)):[]}function f1(e){var i=e==null?0:e.length;return i?gr(e,1,i):[]}function d1(e,i,o){return e&&e.length?(i=o||i===r?1:Oe(i),gr(e,0,i<0?0:i)):[]}function p1(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:Oe(i),i=u-i,gr(e,i<0?0:i,u)):[]}function g1(e,i){return e&&e.length?us(e,de(i,3),!1,!0):[]}function v1(e,i){return e&&e.length?us(e,de(i,3)):[]}var y1=Fe(function(e){return Xr(Ft(e,1,ct,!0))}),b1=Fe(function(e){var i=vr(e);return ct(i)&&(i=r),Xr(Ft(e,1,ct,!0),de(i,2))}),_1=Fe(function(e){var i=vr(e);return i=typeof i=="function"?i:r,Xr(Ft(e,1,ct,!0),r,i)});function m1(e){return e&&e.length?Xr(e):[]}function w1(e,i){return e&&e.length?Xr(e,de(i,2)):[]}function E1(e,i){return i=typeof i=="function"?i:r,e&&e.length?Xr(e,r,i):[]}function Vo(e){if(!(e&&e.length))return[];var i=0;return e=Wr(e,function(o){if(ct(o))return i=yt(o.length,i),!0}),co(i,function(o){return it(e,so(o))})}function ch(e,i){if(!(e&&e.length))return[];var o=Vo(e);return i==null?o:it(o,function(u){return tr(i,r,u)})}var D1=Fe(function(e,i){return ct(e)?cn(e,i):[]}),S1=Fe(function(e){return Ao(Wr(e,ct))}),x1=Fe(function(e){var i=vr(e);return ct(i)&&(i=r),Ao(Wr(e,ct),de(i,2))}),I1=Fe(function(e){var i=vr(e);return i=typeof i=="function"?i:r,Ao(Wr(e,ct),r,i)}),O1=Fe(Vo);function P1(e,i){return Iu(e||[],i||[],an)}function C1(e,i){return Iu(e||[],i||[],ln)}var A1=Fe(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,ch(e,o)});function uh(e){var i=g(e);return i.__chain__=!0,i}function N1(e,i){return i(e),e}function bs(e,i){return i(e)}var T1=Mr(function(e){var i=e.length,o=i?e[0]:0,u=this.__wrapped__,d=function(y){return yo(y,e)};return i>1||this.__actions__.length||!(u instanceof qe)||!jr(o)?this.thru(d):(u=u.slice(o,+o+(i?1:0)),u.__actions__.push({func:bs,args:[d],thisArg:r}),new dr(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function R1(){return uh(this)}function F1(){return new dr(this.value(),this.__chain__)}function U1(){this.__values__===r&&(this.__values__=Dh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function L1(){return this}function $1(e){for(var i,o=this;o instanceof is;){var u=rh(o);u.__index__=0,u.__values__=r,i?d.__wrapped__=u:i=u;var d=u;o=o.__wrapped__}return d.__wrapped__=e,i}function M1(){var e=this.__wrapped__;if(e instanceof qe){var i=e;return this.__actions__.length&&(i=new qe(this)),i=i.reverse(),i.__actions__.push({func:bs,args:[Ko],thisArg:r}),new dr(i,this.__chain__)}return this.thru(Ko)}function j1(){return xu(this.__wrapped__,this.__actions__)}var q1=hs(function(e,i,o){Xe.call(e,o)?++e[o]:Lr(e,o,1)});function z1(e,i,o){var u=xe(e)?Mc:Ng;return o&&Bt(e,i,o)&&(i=r),u(e,de(i,3))}function B1(e,i){var o=xe(e)?Wr:cu;return o(e,de(i,3))}var k1=Lu(ih),H1=Lu(nh);function K1(e,i){return Ft(_s(e,i),1)}function V1(e,i){return Ft(_s(e,i),X)}function W1(e,i,o){return o=o===r?1:Oe(o),Ft(_s(e,i),o)}function hh(e,i){var o=xe(e)?lr:Qr;return o(e,de(i,3))}function lh(e,i){var o=xe(e)?fp:au;return o(e,de(i,3))}var G1=hs(function(e,i,o){Xe.call(e,o)?e[o].push(i):Lr(e,o,[i])});function Y1(e,i,o,u){e=Yt(e)?e:ki(e),o=o&&!u?Oe(o):0;var d=e.length;return o<0&&(o=yt(d+o,0)),Ss(e)?o<=d&&e.indexOf(i,o)>-1:!!d&&Ni(e,i,o)>-1}var J1=Fe(function(e,i,o){var u=-1,d=typeof i=="function",y=Yt(e)?q(e.length):[];return Qr(e,function(m){y[++u]=d?tr(i,m,o):un(m,i,o)}),y}),Q1=hs(function(e,i,o){Lr(e,o,i)});function _s(e,i){var o=xe(e)?it:pu;return o(e,de(i,3))}function X1(e,i,o,u){return e==null?[]:(xe(i)||(i=i==null?[]:[i]),o=u?r:o,xe(o)||(o=o==null?[]:[o]),bu(e,i,o))}var Z1=hs(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function ev(e,i,o){var u=xe(e)?io:Bc,d=arguments.length<3;return u(e,de(i,4),o,d,Qr)}function tv(e,i,o){var u=xe(e)?dp:Bc,d=arguments.length<3;return u(e,de(i,4),o,d,au)}function rv(e,i){var o=xe(e)?Wr:cu;return o(e,Es(de(i,3)))}function iv(e){var i=xe(e)?iu:Yg;return i(e)}function nv(e,i,o){(o?Bt(e,i,o):i===r)?i=1:i=Oe(i);var u=xe(e)?Ig:Jg;return u(e,i)}function sv(e){var i=xe(e)?Og:Xg;return i(e)}function ov(e){if(e==null)return 0;if(Yt(e))return Ss(e)?Ri(e):e.length;var i=Mt(e);return i==_e||i==me?e.size:Do(e).length}function av(e,i,o){var u=xe(e)?no:Zg;return o&&Bt(e,i,o)&&(i=r),u(e,de(i,3))}var cv=Fe(function(e,i){if(e==null)return[];var o=i.length;return o>1&&Bt(e,i[0],i[1])?i=[]:o>2&&Bt(i[0],i[1],i[2])&&(i=[i[0]]),bu(e,Ft(i,1),[])}),ms=Bp||function(){return Rt.Date.now()};function uv(e,i){if(typeof i!="function")throw new fr(p);return e=Oe(e),function(){if(--e<1)return i.apply(this,arguments)}}function fh(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,$r(e,c,r,r,r,r,i)}function dh(e,i){var o;if(typeof i!="function")throw new fr(p);return e=Oe(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var Wo=Fe(function(e,i,o){var u=B;if(o.length){var d=Yr(o,zi(Wo));u|=x}return $r(e,u,i,o,d)}),ph=Fe(function(e,i,o){var u=B|ee;if(o.length){var d=Yr(o,zi(ph));u|=x}return $r(i,u,e,o,d)});function gh(e,i,o){i=o?r:i;var u=$r(e,T,r,r,r,r,r,i);return u.placeholder=gh.placeholder,u}function vh(e,i,o){i=o?r:i;var u=$r(e,E,r,r,r,r,r,i);return u.placeholder=vh.placeholder,u}function yh(e,i,o){var u,d,y,m,I,R,V=0,Y=!1,J=!1,ne=!0;if(typeof e!="function")throw new fr(p);i=yr(i)||0,nt(o)&&(Y=!!o.leading,J="maxWait"in o,y=J?yt(yr(o.maxWait)||0,i):y,ne="trailing"in o?!!o.trailing:ne);function le(ut){var xr=u,Br=d;return u=d=r,V=ut,m=e.apply(Br,xr),m}function pe(ut){return V=ut,I=pn(Me,i),Y?le(ut):m}function Te(ut){var xr=ut-R,Br=ut-V,Lh=i-xr;return J?$t(Lh,y-Br):Lh}function ge(ut){var xr=ut-R,Br=ut-V;return R===r||xr>=i||xr<0||J&&Br>=y}function Me(){var ut=ms();if(ge(ut))return ke(ut);I=pn(Me,Te(ut))}function ke(ut){return I=r,ne&&u?le(ut):(u=d=r,m)}function sr(){I!==r&&Ou(I),V=0,u=R=d=I=r}function kt(){return I===r?m:ke(ms())}function or(){var ut=ms(),xr=ge(ut);if(u=arguments,d=this,R=ut,xr){if(I===r)return pe(R);if(J)return Ou(I),I=pn(Me,i),le(R)}return I===r&&(I=pn(Me,i)),m}return or.cancel=sr,or.flush=kt,or}var hv=Fe(function(e,i){return ou(e,1,i)}),lv=Fe(function(e,i,o){return ou(e,yr(i)||0,o)});function fv(e){return $r(e,H)}function ws(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new fr(p);var o=function(){var u=arguments,d=i?i.apply(this,u):u[0],y=o.cache;if(y.has(d))return y.get(d);var m=e.apply(this,u);return o.cache=y.set(d,m)||y,m};return o.cache=new(ws.Cache||Ur),o}ws.Cache=Ur;function Es(e){if(typeof e!="function")throw new fr(p);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function dv(e){return dh(2,e)}var pv=e0(function(e,i){i=i.length==1&&xe(i[0])?it(i[0],rr(de())):it(Ft(i,1),rr(de()));var o=i.length;return Fe(function(u){for(var d=-1,y=$t(u.length,o);++d<y;)u[d]=i[d].call(this,u[d]);return tr(e,this,u)})}),Go=Fe(function(e,i){var o=Yr(i,zi(Go));return $r(e,x,r,i,o)}),bh=Fe(function(e,i){var o=Yr(i,zi(bh));return $r(e,_,r,i,o)}),gv=Mr(function(e,i){return $r(e,b,r,r,r,i)});function vv(e,i){if(typeof e!="function")throw new fr(p);return i=i===r?i:Oe(i),Fe(e,i)}function yv(e,i){if(typeof e!="function")throw new fr(p);return i=i==null?0:yt(Oe(i),0),Fe(function(o){var u=o[i],d=ei(o,0,i);return u&&Gr(d,u),tr(e,this,d)})}function bv(e,i,o){var u=!0,d=!0;if(typeof e!="function")throw new fr(p);return nt(o)&&(u="leading"in o?!!o.leading:u,d="trailing"in o?!!o.trailing:d),yh(e,i,{leading:u,maxWait:i,trailing:d})}function _v(e){return fh(e,1)}function mv(e,i){return Go(To(i),e)}function wv(){if(!arguments.length)return[];var e=arguments[0];return xe(e)?e:[e]}function Ev(e){return pr(e,F)}function Dv(e,i){return i=typeof i=="function"?i:r,pr(e,F,i)}function Sv(e){return pr(e,O|F)}function xv(e,i){return i=typeof i=="function"?i:r,pr(e,O|F,i)}function Iv(e,i){return i==null||su(e,i,Nt(i))}function Sr(e,i){return e===i||e!==e&&i!==i}var Ov=ps(mo),Pv=ps(function(e,i){return e>=i}),yi=lu(function(){return arguments}())?lu:function(e){return at(e)&&Xe.call(e,"callee")&&!Qc.call(e,"callee")},xe=q.isArray,Cv=Tc?rr(Tc):$g;function Yt(e){return e!=null&&Ds(e.length)&&!qr(e)}function ct(e){return at(e)&&Yt(e)}function Av(e){return e===!0||e===!1||at(e)&&zt(e)==M}var ti=Hp||sa,Nv=Rc?rr(Rc):Mg;function Tv(e){return at(e)&&e.nodeType===1&&!gn(e)}function Rv(e){if(e==null)return!0;if(Yt(e)&&(xe(e)||typeof e=="string"||typeof e.splice=="function"||ti(e)||Bi(e)||yi(e)))return!e.length;var i=Mt(e);if(i==_e||i==me)return!e.size;if(dn(e))return!Do(e).length;for(var o in e)if(Xe.call(e,o))return!1;return!0}function Fv(e,i){return hn(e,i)}function Uv(e,i,o){o=typeof o=="function"?o:r;var u=o?o(e,i):r;return u===r?hn(e,i,r,o):!!u}function Yo(e){if(!at(e))return!1;var i=zt(e);return i==S||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!gn(e)}function Lv(e){return typeof e=="number"&&Zc(e)}function qr(e){if(!nt(e))return!1;var i=zt(e);return i==re||i==ce||i==$||i==ot}function _h(e){return typeof e=="number"&&e==Oe(e)}function Ds(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=W}function nt(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function at(e){return e!=null&&typeof e=="object"}var mh=Fc?rr(Fc):qg;function $v(e,i){return e===i||Eo(e,i,jo(i))}function Mv(e,i,o){return o=typeof o=="function"?o:r,Eo(e,i,jo(i),o)}function jv(e){return wh(e)&&e!=+e}function qv(e){if(D0(e))throw new De(l);return fu(e)}function zv(e){return e===null}function Bv(e){return e==null}function wh(e){return typeof e=="number"||at(e)&&zt(e)==$e}function gn(e){if(!at(e)||zt(e)!=Re)return!1;var i=Jn(e);if(i===null)return!0;var o=Xe.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Vn.call(o)==Mp}var Jo=Uc?rr(Uc):zg;function kv(e){return _h(e)&&e>=-W&&e<=W}var Eh=Lc?rr(Lc):Bg;function Ss(e){return typeof e=="string"||!xe(e)&&at(e)&&zt(e)==Pe}function nr(e){return typeof e=="symbol"||at(e)&&zt(e)==Ce}var Bi=$c?rr($c):kg;function Hv(e){return e===r}function Kv(e){return at(e)&&Mt(e)==Se}function Vv(e){return at(e)&&zt(e)==Ae}var Wv=ps(So),Gv=ps(function(e,i){return e<=i});function Dh(e){if(!e)return[];if(Yt(e))return Ss(e)?Er(e):Gt(e);if(tn&&e[tn])return Ip(e[tn]());var i=Mt(e),o=i==_e?ho:i==me?kn:ki;return o(e)}function zr(e){if(!e)return e===0?e:0;if(e=yr(e),e===X||e===-X){var i=e<0?-1:1;return i*Q}return e===e?e:0}function Oe(e){var i=zr(e),o=i%1;return i===i?o?i-o:i:0}function Sh(e){return e?di(Oe(e),0,Z):0}function yr(e){if(typeof e=="number")return e;if(nr(e))return G;if(nt(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=nt(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=kc(e);var o=Cd.test(e);return o||Nd.test(e)?up(e.slice(2),o?2:8):Pd.test(e)?G:+e}function xh(e){return Cr(e,Jt(e))}function Yv(e){return e?di(Oe(e),-W,W):e===0?e:0}function Qe(e){return e==null?"":ir(e)}var Jv=ji(function(e,i){if(dn(i)||Yt(i)){Cr(i,Nt(i),e);return}for(var o in i)Xe.call(i,o)&&an(e,o,i[o])}),Ih=ji(function(e,i){Cr(i,Jt(i),e)}),xs=ji(function(e,i,o,u){Cr(i,Jt(i),e,u)}),Qv=ji(function(e,i,o,u){Cr(i,Nt(i),e,u)}),Xv=Mr(yo);function Zv(e,i){var o=Mi(e);return i==null?o:nu(o,i)}var ey=Fe(function(e,i){e=Ze(e);var o=-1,u=i.length,d=u>2?i[2]:r;for(d&&Bt(i[0],i[1],d)&&(u=1);++o<u;)for(var y=i[o],m=Jt(y),I=-1,R=m.length;++I<R;){var V=m[I],Y=e[V];(Y===r||Sr(Y,Ui[V])&&!Xe.call(e,V))&&(e[V]=y[V])}return e}),ty=Fe(function(e){return e.push(r,ku),tr(Oh,r,e)});function ry(e,i){return jc(e,de(i,3),Pr)}function iy(e,i){return jc(e,de(i,3),_o)}function ny(e,i){return e==null?e:bo(e,de(i,3),Jt)}function sy(e,i){return e==null?e:uu(e,de(i,3),Jt)}function oy(e,i){return e&&Pr(e,de(i,3))}function ay(e,i){return e&&_o(e,de(i,3))}function cy(e){return e==null?[]:os(e,Nt(e))}function uy(e){return e==null?[]:os(e,Jt(e))}function Qo(e,i,o){var u=e==null?r:pi(e,i);return u===r?o:u}function hy(e,i){return e!=null&&Vu(e,i,Rg)}function Xo(e,i){return e!=null&&Vu(e,i,Fg)}var ly=Mu(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Wn.call(i)),e[i]=o},ea(Qt)),fy=Mu(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Wn.call(i)),Xe.call(e,i)?e[i].push(o):e[i]=[o]},de),dy=Fe(un);function Nt(e){return Yt(e)?ru(e):Do(e)}function Jt(e){return Yt(e)?ru(e,!0):Hg(e)}function py(e,i){var o={};return i=de(i,3),Pr(e,function(u,d,y){Lr(o,i(u,d,y),u)}),o}function gy(e,i){var o={};return i=de(i,3),Pr(e,function(u,d,y){Lr(o,d,i(u,d,y))}),o}var vy=ji(function(e,i,o){as(e,i,o)}),Oh=ji(function(e,i,o,u){as(e,i,o,u)}),yy=Mr(function(e,i){var o={};if(e==null)return o;var u=!1;i=it(i,function(y){return y=Zr(y,e),u||(u=y.length>1),y}),Cr(e,$o(e),o),u&&(o=pr(o,O|L|F,l0));for(var d=i.length;d--;)Co(o,i[d]);return o});function by(e,i){return Ph(e,Es(de(i)))}var _y=Mr(function(e,i){return e==null?{}:Vg(e,i)});function Ph(e,i){if(e==null)return{};var o=it($o(e),function(u){return[u]});return i=de(i),_u(e,o,function(u,d){return i(u,d[0])})}function my(e,i,o){i=Zr(i,e);var u=-1,d=i.length;for(d||(d=1,e=r);++u<d;){var y=e==null?r:e[Ar(i[u])];y===r&&(u=d,y=o),e=qr(y)?y.call(e):y}return e}function wy(e,i,o){return e==null?e:ln(e,i,o)}function Ey(e,i,o,u){return u=typeof u=="function"?u:r,e==null?e:ln(e,i,o,u)}var Ch=zu(Nt),Ah=zu(Jt);function Dy(e,i,o){var u=xe(e),d=u||ti(e)||Bi(e);if(i=de(i,4),o==null){var y=e&&e.constructor;d?o=u?new y:[]:nt(e)?o=qr(y)?Mi(Jn(e)):{}:o={}}return(d?lr:Pr)(e,function(m,I,R){return i(o,m,I,R)}),o}function Sy(e,i){return e==null?!0:Co(e,i)}function xy(e,i,o){return e==null?e:Su(e,i,To(o))}function Iy(e,i,o,u){return u=typeof u=="function"?u:r,e==null?e:Su(e,i,To(o),u)}function ki(e){return e==null?[]:uo(e,Nt(e))}function Oy(e){return e==null?[]:uo(e,Jt(e))}function Py(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=yr(o),o=o===o?o:0),i!==r&&(i=yr(i),i=i===i?i:0),di(yr(e),i,o)}function Cy(e,i,o){return i=zr(i),o===r?(o=i,i=0):o=zr(o),e=yr(e),Ug(e,i,o)}function Ay(e,i,o){if(o&&typeof o!="boolean"&&Bt(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=zr(e),i===r?(i=e,e=0):i=zr(i)),e>i){var u=e;e=i,i=u}if(o||e%1||i%1){var d=eu();return $t(e+d*(i-e+cp("1e-"+((d+"").length-1))),i)}return Io(e,i)}var Ny=qi(function(e,i,o){return i=i.toLowerCase(),e+(o?Nh(i):i)});function Nh(e){return Zo(Qe(e).toLowerCase())}function Th(e){return e=Qe(e),e&&e.replace(Rd,wp).replace(Xd,"")}function Ty(e,i,o){e=Qe(e),i=ir(i);var u=e.length;o=o===r?u:di(Oe(o),0,u);var d=o;return o-=i.length,o>=0&&e.slice(o,d)==i}function Ry(e){return e=Qe(e),e&&_t.test(e)?e.replace(Zi,Ep):e}function Fy(e){return e=Qe(e),e&&xt.test(e)?e.replace(lt,"\\$&"):e}var Uy=qi(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),Ly=qi(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),$y=Uu("toLowerCase");function My(e,i,o){e=Qe(e),i=Oe(i);var u=i?Ri(e):0;if(!i||u>=i)return e;var d=(i-u)/2;return ds(es(d),o)+e+ds(Zn(d),o)}function jy(e,i,o){e=Qe(e),i=Oe(i);var u=i?Ri(e):0;return i&&u<i?e+ds(i-u,o):e}function qy(e,i,o){e=Qe(e),i=Oe(i);var u=i?Ri(e):0;return i&&u<i?ds(i-u,o)+e:e}function zy(e,i,o){return o||i==null?i=0:i&&(i=+i),Gp(Qe(e).replace(ft,""),i||0)}function By(e,i,o){return(o?Bt(e,i,o):i===r)?i=1:i=Oe(i),Oo(Qe(e),i)}function ky(){var e=arguments,i=Qe(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Hy=qi(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function Ky(e,i,o){return o&&typeof o!="number"&&Bt(e,i,o)&&(i=o=r),o=o===r?Z:o>>>0,o?(e=Qe(e),e&&(typeof i=="string"||i!=null&&!Jo(i))&&(i=ir(i),!i&&Ti(e))?ei(Er(e),0,o):e.split(i,o)):[]}var Vy=qi(function(e,i,o){return e+(o?" ":"")+Zo(i)});function Wy(e,i,o){return e=Qe(e),o=o==null?0:di(Oe(o),0,e.length),i=ir(i),e.slice(o,o+i.length)==i}function Gy(e,i,o){var u=g.templateSettings;o&&Bt(e,i,o)&&(i=r),e=Qe(e),i=xs({},i,u,Bu);var d=xs({},i.imports,u.imports,Bu),y=Nt(d),m=uo(d,y),I,R,V=0,Y=i.interpolate||Mn,J="__p += '",ne=lo((i.escape||Mn).source+"|"+Y.source+"|"+(Y===gt?Od:Mn).source+"|"+(i.evaluate||Mn).source+"|$","g"),le="//# sourceURL="+(Xe.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ip+"]")+`
`;e.replace(ne,function(ge,Me,ke,sr,kt,or){return ke||(ke=sr),J+=e.slice(V,or).replace(Fd,Dp),Me&&(I=!0,J+=`' +
__e(`+Me+`) +
'`),kt&&(R=!0,J+=`';
`+kt+`;
__p += '`),ke&&(J+=`' +
((__t = (`+ke+`)) == null ? '' : __t) +
'`),V=or+ge.length,ge}),J+=`';
`;var pe=Xe.call(i,"variable")&&i.variable;if(!pe)J=`with (obj) {
`+J+`
}
`;else if(xd.test(pe))throw new De(f);J=(R?J.replace(Vr,""):J).replace(ci,"$1").replace(Pi,"$1;"),J="function("+(pe||"obj")+`) {
`+(pe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(I?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+J+`return __p
}`;var Te=Fh(function(){return Ye(y,le+"return "+J).apply(r,m)});if(Te.source=J,Yo(Te))throw Te;return Te}function Yy(e){return Qe(e).toLowerCase()}function Jy(e){return Qe(e).toUpperCase()}function Qy(e,i,o){if(e=Qe(e),e&&(o||i===r))return kc(e);if(!e||!(i=ir(i)))return e;var u=Er(e),d=Er(i),y=Hc(u,d),m=Kc(u,d)+1;return ei(u,y,m).join("")}function Xy(e,i,o){if(e=Qe(e),e&&(o||i===r))return e.slice(0,Wc(e)+1);if(!e||!(i=ir(i)))return e;var u=Er(e),d=Kc(u,Er(i))+1;return ei(u,0,d).join("")}function Zy(e,i,o){if(e=Qe(e),e&&(o||i===r))return e.replace(ft,"");if(!e||!(i=ir(i)))return e;var u=Er(e),d=Hc(u,Er(i));return ei(u,d).join("")}function eb(e,i){var o=K,u=ie;if(nt(i)){var d="separator"in i?i.separator:d;o="length"in i?Oe(i.length):o,u="omission"in i?ir(i.omission):u}e=Qe(e);var y=e.length;if(Ti(e)){var m=Er(e);y=m.length}if(o>=y)return e;var I=o-Ri(u);if(I<1)return u;var R=m?ei(m,0,I).join(""):e.slice(0,I);if(d===r)return R+u;if(m&&(I+=R.length-I),Jo(d)){if(e.slice(I).search(d)){var V,Y=R;for(d.global||(d=lo(d.source,Qe(lc.exec(d))+"g")),d.lastIndex=0;V=d.exec(Y);)var J=V.index;R=R.slice(0,J===r?I:J)}}else if(e.indexOf(ir(d),I)!=I){var ne=R.lastIndexOf(d);ne>-1&&(R=R.slice(0,ne))}return R+u}function tb(e){return e=Qe(e),e&&bt.test(e)?e.replace(Ci,Ap):e}var rb=qi(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),Zo=Uu("toUpperCase");function Rh(e,i,o){return e=Qe(e),i=o?r:i,i===r?xp(e)?Rp(e):vp(e):e.match(i)||[]}var Fh=Fe(function(e,i){try{return tr(e,r,i)}catch(o){return Yo(o)?o:new De(o)}}),ib=Mr(function(e,i){return lr(i,function(o){o=Ar(o),Lr(e,o,Wo(e[o],e))}),e});function nb(e){var i=e==null?0:e.length,o=de();return e=i?it(e,function(u){if(typeof u[1]!="function")throw new fr(p);return[o(u[0]),u[1]]}):[],Fe(function(u){for(var d=-1;++d<i;){var y=e[d];if(tr(y[0],this,u))return tr(y[1],this,u)}})}function sb(e){return Ag(pr(e,O))}function ea(e){return function(){return e}}function ob(e,i){return e==null||e!==e?i:e}var ab=$u(),cb=$u(!0);function Qt(e){return e}function ta(e){return du(typeof e=="function"?e:pr(e,O))}function ub(e){return gu(pr(e,O))}function hb(e,i){return vu(e,pr(i,O))}var lb=Fe(function(e,i){return function(o){return un(o,e,i)}}),fb=Fe(function(e,i){return function(o){return un(e,o,i)}});function ra(e,i,o){var u=Nt(i),d=os(i,u);o==null&&!(nt(i)&&(d.length||!u.length))&&(o=i,i=e,e=this,d=os(i,Nt(i)));var y=!(nt(o)&&"chain"in o)||!!o.chain,m=qr(e);return lr(d,function(I){var R=i[I];e[I]=R,m&&(e.prototype[I]=function(){var V=this.__chain__;if(y||V){var Y=e(this.__wrapped__),J=Y.__actions__=Gt(this.__actions__);return J.push({func:R,args:arguments,thisArg:e}),Y.__chain__=V,Y}return R.apply(e,Gr([this.value()],arguments))})}),e}function db(){return Rt._===this&&(Rt._=jp),this}function ia(){}function pb(e){return e=Oe(e),Fe(function(i){return yu(i,e)})}var gb=Fo(it),vb=Fo(Mc),yb=Fo(no);function Uh(e){return zo(e)?so(Ar(e)):Wg(e)}function bb(e){return function(i){return e==null?r:pi(e,i)}}var _b=ju(),mb=ju(!0);function na(){return[]}function sa(){return!1}function wb(){return{}}function Eb(){return""}function Db(){return!0}function Sb(e,i){if(e=Oe(e),e<1||e>W)return[];var o=Z,u=$t(e,Z);i=de(i),e-=Z;for(var d=co(u,i);++o<e;)i(o);return d}function xb(e){return xe(e)?it(e,Ar):nr(e)?[e]:Gt(th(Qe(e)))}function Ib(e){var i=++$p;return Qe(e)+i}var Ob=fs(function(e,i){return e+i},0),Pb=Uo("ceil"),Cb=fs(function(e,i){return e/i},1),Ab=Uo("floor");function Nb(e){return e&&e.length?ss(e,Qt,mo):r}function Tb(e,i){return e&&e.length?ss(e,de(i,2),mo):r}function Rb(e){return zc(e,Qt)}function Fb(e,i){return zc(e,de(i,2))}function Ub(e){return e&&e.length?ss(e,Qt,So):r}function Lb(e,i){return e&&e.length?ss(e,de(i,2),So):r}var $b=fs(function(e,i){return e*i},1),Mb=Uo("round"),jb=fs(function(e,i){return e-i},0);function qb(e){return e&&e.length?ao(e,Qt):0}function zb(e,i){return e&&e.length?ao(e,de(i,2)):0}return g.after=uv,g.ary=fh,g.assign=Jv,g.assignIn=Ih,g.assignInWith=xs,g.assignWith=Qv,g.at=Xv,g.before=dh,g.bind=Wo,g.bindAll=ib,g.bindKey=ph,g.castArray=wv,g.chain=uh,g.chunk=A0,g.compact=N0,g.concat=T0,g.cond=nb,g.conforms=sb,g.constant=ea,g.countBy=q1,g.create=Zv,g.curry=gh,g.curryRight=vh,g.debounce=yh,g.defaults=ey,g.defaultsDeep=ty,g.defer=hv,g.delay=lv,g.difference=R0,g.differenceBy=F0,g.differenceWith=U0,g.drop=L0,g.dropRight=$0,g.dropRightWhile=M0,g.dropWhile=j0,g.fill=q0,g.filter=B1,g.flatMap=K1,g.flatMapDeep=V1,g.flatMapDepth=W1,g.flatten=sh,g.flattenDeep=z0,g.flattenDepth=B0,g.flip=fv,g.flow=ab,g.flowRight=cb,g.fromPairs=k0,g.functions=cy,g.functionsIn=uy,g.groupBy=G1,g.initial=K0,g.intersection=V0,g.intersectionBy=W0,g.intersectionWith=G0,g.invert=ly,g.invertBy=fy,g.invokeMap=J1,g.iteratee=ta,g.keyBy=Q1,g.keys=Nt,g.keysIn=Jt,g.map=_s,g.mapKeys=py,g.mapValues=gy,g.matches=ub,g.matchesProperty=hb,g.memoize=ws,g.merge=vy,g.mergeWith=Oh,g.method=lb,g.methodOf=fb,g.mixin=ra,g.negate=Es,g.nthArg=pb,g.omit=yy,g.omitBy=by,g.once=dv,g.orderBy=X1,g.over=gb,g.overArgs=pv,g.overEvery=vb,g.overSome=yb,g.partial=Go,g.partialRight=bh,g.partition=Z1,g.pick=_y,g.pickBy=Ph,g.property=Uh,g.propertyOf=bb,g.pull=X0,g.pullAll=ah,g.pullAllBy=Z0,g.pullAllWith=e1,g.pullAt=t1,g.range=_b,g.rangeRight=mb,g.rearg=gv,g.reject=rv,g.remove=r1,g.rest=vv,g.reverse=Ko,g.sampleSize=nv,g.set=wy,g.setWith=Ey,g.shuffle=sv,g.slice=i1,g.sortBy=cv,g.sortedUniq=h1,g.sortedUniqBy=l1,g.split=Ky,g.spread=yv,g.tail=f1,g.take=d1,g.takeRight=p1,g.takeRightWhile=g1,g.takeWhile=v1,g.tap=N1,g.throttle=bv,g.thru=bs,g.toArray=Dh,g.toPairs=Ch,g.toPairsIn=Ah,g.toPath=xb,g.toPlainObject=xh,g.transform=Dy,g.unary=_v,g.union=y1,g.unionBy=b1,g.unionWith=_1,g.uniq=m1,g.uniqBy=w1,g.uniqWith=E1,g.unset=Sy,g.unzip=Vo,g.unzipWith=ch,g.update=xy,g.updateWith=Iy,g.values=ki,g.valuesIn=Oy,g.without=D1,g.words=Rh,g.wrap=mv,g.xor=S1,g.xorBy=x1,g.xorWith=I1,g.zip=O1,g.zipObject=P1,g.zipObjectDeep=C1,g.zipWith=A1,g.entries=Ch,g.entriesIn=Ah,g.extend=Ih,g.extendWith=xs,ra(g,g),g.add=Ob,g.attempt=Fh,g.camelCase=Ny,g.capitalize=Nh,g.ceil=Pb,g.clamp=Py,g.clone=Ev,g.cloneDeep=Sv,g.cloneDeepWith=xv,g.cloneWith=Dv,g.conformsTo=Iv,g.deburr=Th,g.defaultTo=ob,g.divide=Cb,g.endsWith=Ty,g.eq=Sr,g.escape=Ry,g.escapeRegExp=Fy,g.every=z1,g.find=k1,g.findIndex=ih,g.findKey=ry,g.findLast=H1,g.findLastIndex=nh,g.findLastKey=iy,g.floor=Ab,g.forEach=hh,g.forEachRight=lh,g.forIn=ny,g.forInRight=sy,g.forOwn=oy,g.forOwnRight=ay,g.get=Qo,g.gt=Ov,g.gte=Pv,g.has=hy,g.hasIn=Xo,g.head=oh,g.identity=Qt,g.includes=Y1,g.indexOf=H0,g.inRange=Cy,g.invoke=dy,g.isArguments=yi,g.isArray=xe,g.isArrayBuffer=Cv,g.isArrayLike=Yt,g.isArrayLikeObject=ct,g.isBoolean=Av,g.isBuffer=ti,g.isDate=Nv,g.isElement=Tv,g.isEmpty=Rv,g.isEqual=Fv,g.isEqualWith=Uv,g.isError=Yo,g.isFinite=Lv,g.isFunction=qr,g.isInteger=_h,g.isLength=Ds,g.isMap=mh,g.isMatch=$v,g.isMatchWith=Mv,g.isNaN=jv,g.isNative=qv,g.isNil=Bv,g.isNull=zv,g.isNumber=wh,g.isObject=nt,g.isObjectLike=at,g.isPlainObject=gn,g.isRegExp=Jo,g.isSafeInteger=kv,g.isSet=Eh,g.isString=Ss,g.isSymbol=nr,g.isTypedArray=Bi,g.isUndefined=Hv,g.isWeakMap=Kv,g.isWeakSet=Vv,g.join=Y0,g.kebabCase=Uy,g.last=vr,g.lastIndexOf=J0,g.lowerCase=Ly,g.lowerFirst=$y,g.lt=Wv,g.lte=Gv,g.max=Nb,g.maxBy=Tb,g.mean=Rb,g.meanBy=Fb,g.min=Ub,g.minBy=Lb,g.stubArray=na,g.stubFalse=sa,g.stubObject=wb,g.stubString=Eb,g.stubTrue=Db,g.multiply=$b,g.nth=Q0,g.noConflict=db,g.noop=ia,g.now=ms,g.pad=My,g.padEnd=jy,g.padStart=qy,g.parseInt=zy,g.random=Ay,g.reduce=ev,g.reduceRight=tv,g.repeat=By,g.replace=ky,g.result=my,g.round=Mb,g.runInContext=A,g.sample=iv,g.size=ov,g.snakeCase=Hy,g.some=av,g.sortedIndex=n1,g.sortedIndexBy=s1,g.sortedIndexOf=o1,g.sortedLastIndex=a1,g.sortedLastIndexBy=c1,g.sortedLastIndexOf=u1,g.startCase=Vy,g.startsWith=Wy,g.subtract=jb,g.sum=qb,g.sumBy=zb,g.template=Gy,g.times=Sb,g.toFinite=zr,g.toInteger=Oe,g.toLength=Sh,g.toLower=Yy,g.toNumber=yr,g.toSafeInteger=Yv,g.toString=Qe,g.toUpper=Jy,g.trim=Qy,g.trimEnd=Xy,g.trimStart=Zy,g.truncate=eb,g.unescape=tb,g.uniqueId=Ib,g.upperCase=rb,g.upperFirst=Zo,g.each=hh,g.eachRight=lh,g.first=oh,ra(g,function(){var e={};return Pr(g,function(i,o){Xe.call(g.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),g.VERSION=s,lr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){g[e].placeholder=g}),lr(["drop","take"],function(e,i){qe.prototype[e]=function(o){o=o===r?1:yt(Oe(o),0);var u=this.__filtered__&&!i?new qe(this):this.clone();return u.__filtered__?u.__takeCount__=$t(o,u.__takeCount__):u.__views__.push({size:$t(o,Z),type:e+(u.__dir__<0?"Right":"")}),u},qe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),lr(["filter","map","takeWhile"],function(e,i){var o=i+1,u=o==N||o==ae;qe.prototype[e]=function(d){var y=this.clone();return y.__iteratees__.push({iteratee:de(d,3),type:o}),y.__filtered__=y.__filtered__||u,y}}),lr(["head","last"],function(e,i){var o="take"+(i?"Right":"");qe.prototype[e]=function(){return this[o](1).value()[0]}}),lr(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");qe.prototype[e]=function(){return this.__filtered__?new qe(this):this[o](1)}}),qe.prototype.compact=function(){return this.filter(Qt)},qe.prototype.find=function(e){return this.filter(e).head()},qe.prototype.findLast=function(e){return this.reverse().find(e)},qe.prototype.invokeMap=Fe(function(e,i){return typeof e=="function"?new qe(this):this.map(function(o){return un(o,e,i)})}),qe.prototype.reject=function(e){return this.filter(Es(de(e)))},qe.prototype.slice=function(e,i){e=Oe(e);var o=this;return o.__filtered__&&(e>0||i<0)?new qe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=Oe(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},qe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},qe.prototype.toArray=function(){return this.take(Z)},Pr(qe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),d=g[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);d&&(g.prototype[i]=function(){var m=this.__wrapped__,I=u?[1]:arguments,R=m instanceof qe,V=I[0],Y=R||xe(m),J=function(Me){var ke=d.apply(g,Gr([Me],I));return u&&ne?ke[0]:ke};Y&&o&&typeof V=="function"&&V.length!=1&&(R=Y=!1);var ne=this.__chain__,le=!!this.__actions__.length,pe=y&&!ne,Te=R&&!le;if(!y&&Y){m=Te?m:new qe(this);var ge=e.apply(m,I);return ge.__actions__.push({func:bs,args:[J],thisArg:r}),new dr(ge,ne)}return pe&&Te?e.apply(this,I):(ge=this.thru(J),pe?u?ge.value()[0]:ge.value():ge)})}),lr(["pop","push","shift","sort","splice","unshift"],function(e){var i=Hn[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);g.prototype[e]=function(){var d=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(xe(y)?y:[],d)}return this[o](function(m){return i.apply(xe(m)?m:[],d)})}}),Pr(qe.prototype,function(e,i){var o=g[i];if(o){var u=o.name+"";Xe.call($i,u)||($i[u]=[]),$i[u].push({name:i,func:o})}}),$i[ls(r,ee).name]=[{name:"wrapper",func:r}],qe.prototype.clone=tg,qe.prototype.reverse=rg,qe.prototype.value=ig,g.prototype.at=T1,g.prototype.chain=R1,g.prototype.commit=F1,g.prototype.next=U1,g.prototype.plant=$1,g.prototype.reverse=M1,g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=j1,g.prototype.first=g.prototype.head,tn&&(g.prototype[tn]=L1),g},Fi=Fp();ui?((ui.exports=Fi)._=Fi,eo._=Fi):Rt._=Fi}).call(On)})(za,za.exports);var LD=Object.defineProperty,$D=Object.defineProperties,MD=Object.getOwnPropertyDescriptors,cf=Object.getOwnPropertySymbols,jD=Object.prototype.hasOwnProperty,qD=Object.prototype.propertyIsEnumerable,uf=(n,t,r)=>t in n?LD(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ps=(n,t)=>{for(var r in t||(t={}))jD.call(t,r)&&uf(n,r,t[r]);if(cf)for(var r of cf(t))qD.call(t,r)&&uf(n,r,t[r]);return n},zD=(n,t)=>$D(n,MD(t));function _r(n,t,r){let s;const a=Ba(n);return t.rpcMap&&(s=t.rpcMap[a]),s||(s=`${UD}?chainId=eip155:${a}&projectId=${r}`),s}function Ba(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function Dd(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function BD(n,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const l=t.namespaces[a].accounts;s.push(...l)}),s}function kD(n={},t={}){const r=hf(n),s=hf(t);return za.exports.merge(r,s)}function hf(n){var t,r,s,a;const l={};if(!Gi(n))return l;for(const[p,f]of Object.entries(n)){const v=nc(p)?[p]:f.chains,w=f.methods||[],D=f.events||[],O=f.rpcMap||{},L=Pn(p);l[L]=zD(Ps(Ps({},l[L]),f),{chains:ya(v,(t=l[L])==null?void 0:t.chains),methods:ya(w,(r=l[L])==null?void 0:r.methods),events:ya(D,(s=l[L])==null?void 0:s.events),rpcMap:Ps(Ps({},O),(a=l[L])==null?void 0:a.rpcMap)})}return l}function HD(n){return n.includes(":")?n.split(":")[2]:n}function KD(n){const t={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],l=s.events||[],p=s.accounts||[],f=nc(r)?[r]:s.chains?s.chains:Dd(s.accounts);t[r]={chains:f,methods:a,events:l,accounts:p}}return t}function Sa(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const Sd={},ht=n=>Sd[n],xa=(n,t)=>{Sd[n]=t};class VD{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=ht("events"),this.client=ht("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||_r(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||_r(t,this.namespace);return typeof s>"u"?void 0:new si(new Si(s,ht("disableProviderPing")))}}class WD{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=ht("events"),this.client=ht("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){const s=Ba(t);if(!this.httpProviders[s]){const a=r||_r(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||_r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new si(new Si(s,ht("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Ba(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const l=parseInt(a,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class GD{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=ht("events"),this.client=ht("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||_r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||_r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new si(new Si(s,ht("disableProviderPing")))}}class YD{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=ht("events"),this.client=ht("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||_r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||_r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new si(new Si(s,ht("disableProviderPing")))}}class JD{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=ht("events"),this.client=ht("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);t[r]=this.createHttpProvider(r,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);return typeof s>"u"?void 0:new si(new Si(s,ht("disableProviderPing")))}}class QD{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=ht("events"),this.client=ht("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||_r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||_r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new si(new Si(s,ht("disableProviderPing")))}}class XD{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=ht("events"),this.client=ht("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||_r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||_r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new si(new Si(s,ht("disableProviderPing")))}}var ZD=Object.defineProperty,e5=Object.defineProperties,t5=Object.getOwnPropertyDescriptors,lf=Object.getOwnPropertySymbols,r5=Object.prototype.hasOwnProperty,i5=Object.prototype.propertyIsEnumerable,ff=(n,t,r)=>t in n?ZD(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Cs=(n,t)=>{for(var r in t||(t={}))r5.call(t,r)&&ff(n,r,t[r]);if(lf)for(var r of lf(t))i5.call(t,r)&&ff(n,r,t[r]);return n},Ia=(n,t)=>e5(n,t5(t));class hc{constructor(t){this.events=new mr.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:He.pino(He.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||of})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new hc(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Cs({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:pt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(l=>{this.session=l,this.namespaces||(this.namespaces=KD(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==Ed)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Di(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await uc.init({logger:this.providerOpts.logger||of,relayUrl:this.providerOpts.relayUrl||TD,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Pn(r)))];xa("client",this.client),xa("events",this.events),xa("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=BD(r,this.session),a=Dd(s),l=kD(this.namespaces,this.optionalNamespaces),p=Ia(Cs({},l[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new WD({namespace:p});break;case"solana":this.rpcProviders[r]=new GD({namespace:p});break;case"cosmos":this.rpcProviders[r]=new YD({namespace:p});break;case"polkadot":this.rpcProviders[r]=new VD({namespace:p});break;case"cip34":this.rpcProviders[r]=new JD({namespace:p});break;case"elrond":this.rpcProviders[r]=new QD({namespace:p});break;case"multiversx":this.rpcProviders[r]=new XD({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&Di(a)&&this.events.emit("accountsChanged",a.map(HD))}else if(s.name==="chainChanged"){const a=r.chainId,l=r.event.data,p=Pn(a),f=Sa(a)!==Sa(l)?`${p}:${Sa(l)}`:a;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,l=(s=this.client)==null?void 0:s.session.get(t);this.session=Ia(Cs({},l),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Ia(Cs({},pt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(ai.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(p=>Pn(p)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=Pn(Object.keys(this.namespaces)[0]),l=this.rpcProviders[a].getDefaultChain();return[a,l]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[a,l]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(l),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${af}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${af}/${t}`)}}const a5=hc;export{a5 as UniversalProvider,hc as default};
